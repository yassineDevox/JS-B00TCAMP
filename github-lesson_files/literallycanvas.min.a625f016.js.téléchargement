!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).LC=t()}}((function(){return function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[a]={exports:{}};e[a][0].call(h.exports,(function(t){return r(e[a][1][t]||t)}),h,h.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty;function r(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}e.exports=function(t,e){if(r(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),o=Object.keys(e);if(n.length!==o.length)return!1;for(var a=0;a<n.length;a++)if(!i.call(e,n[a])||!r(t[n[a]],e[n[a]]))return!1;return!0}},{}],2:[function(t,e,n){"use strict";var i=t("fbjs/lib/shallowEqual");e.exports={shouldComponentUpdate:function(t,e){return!i(this.props,t)||!i(this.state,e)}}},{"fbjs/lib/shallowEqual":1}],3:[function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var e=g();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=r?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(t("./actions")),o=d(t("./bindEvents")),a=t("./shapes"),s=t("./canvasRenderer"),c=d(t("./defaultOptions")),l=d(t("./renderSnapshotToImage")),h=d(t("./renderSnapshotToSVG")),u=d(t("./tools/Pan")),p=d(t("./tools/Eraser")),f=t("./util");function d(t){return t&&t.__esModule?t:{default:t}}function g(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return g=function(){return t},t}function m(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var S="infinite",b=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setImageSize=this.setImageSize.bind(this);var i=null,r=null;e instanceof HTMLElement?(r=e,i=n):i=e,this.opts=i||{},this.config={zoomMin:i.zoomMin||.2,zoomMax:i.zoomMax||4,zoomStep:i.zoomStep||.2},this.colors={primary:i.primaryColor||"#000",secondary:i.secondaryColor||"#fff",background:i.backgroundColor||"transparent"},this.watermarkImage=i.watermarkImage,this.watermarkScale=i.watermarkScale||1,this.backgroundCanvas=document.createElement("canvas"),this.backgroundCtx=this.backgroundCanvas.getContext("2d"),this.canvas=document.createElement("canvas"),this.canvas.style["background-color"]="transparent",this.buffer=document.createElement("canvas"),this.buffer.style["background-color"]="transparent",this.ctx=this.canvas.getContext("2d"),this.bufferCtx=this.buffer.getContext("2d"),this.backingScale=(0,f.getBackingScale)(this.ctx),this.backgroundShapes=i.backgroundShapes||[],this._shapesInProgress=[],this.shapes=[],this.undoStack=[],this.redoStack=[],this.isDragging=!1,this.position={x:0,y:0},this.scale=1,this.setTool(new this.opts.tools[0](this)),this.previousTool=null,this.width=i.imageSize.width||S,this.height=i.imageSize.height||S,this.setZoom(this.scale),this.pendingAnimationFrame=null,i.snapshot&&this.loadSnapshot(i.snapshot),this.isBound=!1,r&&this.bindToElement(r),this.respondToSizeChange=function(){}}var e,n,i;return e=t,(n=[{key:"bindToElement",value:function(t){var e=this;if(this.containerEl)console.warn("Trying to bind Literally Canvas to a DOM element more than once is unsupported.");else{this.containerEl=t,this._unsubscribeEvents=(0,o.default)(this,this.containerEl),this.containerEl.style["background-color"]=this.colors.background,this.containerEl.appendChild(this.backgroundCanvas),this.containerEl.appendChild(this.canvas),this.isBound=!0;var n=function(){e.keepPanInImageBounds(),e.repaintAllLayers()};this.respondToSizeChange=(0,f.matchElementSize)(this.containerEl,[this.backgroundCanvas,this.canvas],this.backingScale,n),this.watermarkImage&&(this.watermarkImage.onload=function(){return e.repaintLayer("background")}),null!=this.tool&&this.tool.didBecomeActive(this),n()}}},{key:"_teardown",value:function(){null!=this.tool&&this.tool.willBecomeInactive(this),"function"==typeof this._unsubscribeEvents&&this._unsubscribeEvents(),this.tool=null,this.containerEl=null,this.isBound=!1}},{key:"trigger",value:function(t,e){return this.canvas.dispatchEvent(new CustomEvent(t,{detail:e})),null}},{key:"on",value:function(t,e){var n=this,i=function(t){return e(t.detail)};return this.canvas.addEventListener(t,i),function(){n.canvas.removeEventListener(t,i)}}},{key:"getRenderScale",value:function(){return this.scale*this.backingScale}},{key:"clientCoordsToDrawingCoords",value:function(t,e){return{x:(t*this.backingScale-this.position.x)/this.getRenderScale(),y:(e*this.backingScale-this.position.y)/this.getRenderScale()}}},{key:"drawingCoordsToClientCoords",value:function(t,e){return{x:(t*this.getRenderScale()+this.position.x)/this.backingScale,y:(e*this.getRenderScale()+this.position.y)/this.backingScale}}},{key:"panTo",value:function(t,e){this.setPan(0,0);var n=this.drawingCoordsToClientCoords(t,e),i=this.containerEl.clientWidth,r=this.containerEl.clientHeight,o=i/2-n.x,a=r/2-n.y;this.setPan(o,a)}},{key:"setImageSize",value:function(t,e){this.width=t||S,this.height=e||S,this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("imageSizeChange",{width:this.width,height:this.height})}},{key:"setTool",value:function(t){this.isBound&&null!=this.tool&&this.tool.willBecomeInactive(this),this.tool=t,this.trigger("toolChange",{tool:t}),this.isBound&&this.tool.didBecomeActive(this)}},{key:"setShapesInProgress",value:function(t){this._shapesInProgress=t}},{key:"pointerDown",value:function(t,e,n){var i=this.opts.tools.find((function(t){return t==u.default})),r=this.opts.tools.find((function(t){return t==p.default}));i&&this.opts.penMode&&"touch"==n.pointerType&&(this.previousTool=this.tool,this.setTool(new i(this))),!r||n.button!=f.mouseEventButton.ERASER&&n.buttons!=f.mouseEventButtons.ERASER||(this.previousTool=this.tool,this.setTool(new r(this)));var o=this.clientCoordsToDrawingCoords(t,e);this.tool.usesSimpleAPI?(this.tool.begin(o.x,o.y,this,n),this.isDragging=!0,this.trigger("drawStart",{tool:this.tool})):(this.isDragging=!0,this.trigger("lc-pointerdown",{tool:this.tool,x:o.x,y:o.y,rawX:t,rawY:e,rawEvent:n}))}},{key:"pointerMove",value:function(t,e,n){var i=this;cancelAnimationFrame(this.pendingAnimationFrame),this.pendingAnimationFrame=(0,f.requestAnimationFrame)((function(r){var o=i.clientCoordsToDrawingCoords(t,e);(null!=i.tool?i.tool.usesSimpleAPI:void 0)?i.isDragging&&(i.tool.continue(o.x,o.y,i,n,r),i.trigger("drawContinue",{tool:i.tool})):i.isDragging?i.trigger("lc-pointerdrag",{tool:i.tool,x:o.x,y:o.y,rawX:t,rawY:e,rawEvent:n}):i.trigger("lc-pointermove",{tool:i.tool,x:o.x,y:o.y,rawX:t,rawY:e,rawEvent:n})}))}},{key:"pointerUp",value:function(t,e,n){var i=this.clientCoordsToDrawingCoords(t,e);this.tool.usesSimpleAPI?this.isDragging&&(this.tool.end(i.x,i.y,this,n),this.isDragging=!1,this.trigger("drawEnd",{tool:this.tool})):(this.isDragging=!1,this.trigger("lc-pointerup",{tool:this.tool,x:i.x,y:i.y,rawX:t,rawY:e,rawEvent:n})),this.previousTool&&(this.setTool(this.previousTool),this.previousTool=null)}},{key:"setColor",value:function(t,e){if(this.colors[t]=e,this.isBound){switch(t){case"background":this.containerEl.style.backgroundColor=this.colors.background,this.repaintLayer("background");break;case"primary":case"secondary":this.repaintLayer("main")}this.trigger("".concat(t,"ColorChange"),this.colors[t]),"background"===t&&this.trigger("drawingChange")}}},{key:"getColor",value:function(t){return this.colors[t]}},{key:"saveShape",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==e&&(e=!0),n||(n=this.shapes.length?this.shapes[this.shapes.length-1].id:null),this.execute(new r.AddShapeAction(this,t,n)),e&&this.trigger("shapeSave",{shape:t,previousShapeId:n}),this.trigger("drawingChange")}},{key:"pan",value:function(t,e){this.setPan(this.position.x-t,this.position.y-e)}},{key:"keepPanInImageBounds",value:function(){var t=this.getRenderScale(),e=this.position,n=e.x,i=e.y;this.width!==S&&(n=this.canvas.width>this.width*t?(this.canvas.width-this.width*t)/2:Math.max(Math.min(0,n),this.canvas.width-this.width*t)),this.height!==S&&(i=this.canvas.height>this.height*t?(this.canvas.height-this.height*t)/2:Math.max(Math.min(0,i),this.canvas.height-this.height*t)),this.position={x:n,y:i}}},{key:"setPan",value:function(t,e){this.position={x:t,y:e},this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("pan",{x:this.position.x,y:this.position.y})}},{key:"zoom",value:function(t){var e=this.scale+t;e=Math.max(e,this.config.zoomMin),e=Math.min(e,this.config.zoomMax),e=Math.round(100*e)/100,this.setZoom(e)}},{key:"setZoom",value:function(t){var e=this.clientCoordsToDrawingCoords(this.canvas.width/2,this.canvas.height/2),n=this.scale;this.scale=t,this.position.x=this.canvas.width/2*this.backingScale-e.x*this.getRenderScale(),this.position.y=this.canvas.height/2*this.backingScale-e.y*this.getRenderScale(),this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("zoom",{oldScale:n,newScale:this.scale})}},{key:"setWatermarkImage",value:function(t){var e=this;this.watermarkImage=t,(0,f.addImageOnload)(t,(function(){return e.repaintLayer("background")})),t.width&&this.repaintLayer("background")}},{key:"repaintAllLayers",value:function(){for(var t=0,e=["background","main"];t<e.length;t++){var n=e[t];this.repaintLayer(n)}return null}},{key:"repaintLayer",value:function(t,e){var n=this;if(!this.isLoading&&(null==e&&(e="main"===t),this.isBound)){switch(t){case"background":this.backgroundCtx.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);var i=function(){return n.repaintLayer("background")};this.watermarkImage&&this._renderWatermark(this.backgroundCtx,!0,i),this.draw(this.backgroundShapes,this.backgroundCtx,i);break;case"main":i=function(){return n.repaintLayer("main",!0)},e&&(this.buffer.width=this.canvas.width,this.buffer.height=this.canvas.height,this.bufferCtx.clearRect(0,0,this.buffer.width,this.buffer.height),this.draw(this.shapes,this.bufferCtx,i)),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width>0&&this.canvas.height>0&&(this.bufferCtx.strokeStyle="transparent",this.ctx.fillStyle="#ccc",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.clipped((function(){n.ctx.clearRect(0,0,n.canvas.width,n.canvas.height),n.ctx.drawImage(n.buffer,0,0)}),this.ctx),this.clipped((function(){n.transformed((function(){n._shapesInProgress.map((function(t){return(0,s.renderShapeToContext)(n.ctx,t,{bufferCtx:n.bufferCtx,shouldOnlyDrawLatest:!0})}))}),n.ctx,n.bufferCtx)}),this.ctx,this.bufferCtx))}this.trigger("repaint",{layerKey:t})}}},{key:"_renderWatermark",value:function(t,e,n){null==e&&(e=!0),this.watermarkImage.width?(t.save(),t.translate(t.canvas.width/2,t.canvas.height/2),t.scale(this.watermarkScale,this.watermarkScale),e&&t.scale(this.backingScale,this.backingScale),t.drawImage(this.watermarkImage,-this.watermarkImage.width/2,-this.watermarkImage.height/2),t.restore()):this.watermarkImage.onload=n}},{key:"drawShapeInProgress",value:function(t){var e=this;this.repaintLayer("main",!1),this.clipped((function(){e.transformed((function(){(0,s.renderShapeToContext)(e.ctx,t,{bufferCtx:e.bufferCtx,shouldOnlyDrawLatest:!0})}),e.ctx,e.bufferCtx)}),this.ctx,this.bufferCtx)}},{key:"draw",value:function(t,e,n){var i=this;if(t.length){var r=function(){t.map((function(t){return(0,s.renderShapeToContext)(e,t,{retryCallback:n})}))};this.clipped((function(){return i.transformed(r,e)}),e)}}},{key:"clipped",value:function(t){for(var e=this.width===S?0:this.position.x,n=this.height===S?0:this.position.y,i=this.getRenderScale(),r=this.width===S?this.canvas.width:this.width*i,o=this.height===S?this.canvas.height:this.height*i,a=arguments.length,s=new Array(a>1?a-1:0),c=1;c<a;c++)s[c-1]=arguments[c];for(var l=0,h=s;l<h.length;l++){var u=h[l];u.save(),u.beginPath(),u.rect(e,n,r,o),u.clip()}t();for(var p=0,f=s;p<f.length;p++)(u=f[p]).restore()}},{key:"transformed",value:function(t){for(var e=this.getRenderScale(),n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o=0,a=i;o<a.length;o++){var s=a[o];s.save(),s.translate(Math.floor(this.position.x),Math.floor(this.position.y)),s.scale(e,e)}t();for(var c=0,l=i;c<l.length;c++)(s=l[c]).restore()}},{key:"clear",value:function(t){null==t&&(t=!0);var e=this.shapes;this.setShapesInProgress([]),this.execute(new r.ClearAction(this,e,[])),this.repaintLayer("main"),t&&this.trigger("clear",null),this.trigger("drawingChange",{})}},{key:"execute",value:function(t){this.undoStack.push(t),t.do(),this.redoStack=[]}},{key:"undo",value:function(){if(this.undoStack.length){var t=this.undoStack.pop();t.undo(),this.redoStack.push(t),this.trigger("undo",{action:t}),this.trigger("drawingChange",{})}}},{key:"redo",value:function(){if(this.redoStack.length){var t=this.redoStack.pop();this.undoStack.push(t),t.do(),this.trigger("redo",{action:t}),this.trigger("drawingChange",{})}}},{key:"canUndo",value:function(){return!!this.undoStack.length}},{key:"canRedo",value:function(){return!!this.redoStack.length}},{key:"getPixel",value:function(t,e,n){n||(n=this.ctx);var i=n.getImageData(t,e,1,1).data;return i[3]?i:null}},{key:"getContentBounds",value:function(){return(0,f.getBoundingRect)(this.shapes.concat(this.backgroundShapes).map((function(t){return t.getBoundingRect()})),this.width===S?0:this.width,this.height===S?0:this.height)}},{key:"getDefaultImageRect",value:function(t,e){var n=this;return null==t&&(t={width:0,height:0}),null==e&&(e={top:0,right:0,bottom:0,left:0}),(0,f.getDefaultImageRect)(this.shapes.concat(this.backgroundShapes).map((function(t){return t.getBoundingRect(n.ctx)})),t,e)}},{key:"getImage",value:function(t){return null==t&&(t={}),null==t.includeWatermark&&(t.includeWatermark=!0),null==t.scaleDownRetina&&(t.scaleDownRetina=!0),null==t.scale&&(t.scale=1),t.scaleDownRetina||(t.scale*=this.backingScale),t.includeWatermark&&(t.watermarkImage=this.watermarkImage,t.watermarkScale=this.watermarkScale,t.scaleDownRetina||(t.watermarkScale*=this.backingScale)),(0,l.default)(this.getSnapshot(),t)}},{key:"canvasForExport",value:function(){return this.repaintAllLayers(),(0,f.combineCanvases)(this.backgroundCanvas,this.canvas)}},{key:"canvasWithBackground",value:function(t){return(0,f.combineCanvases)(t,this.canvasForExport())}},{key:"getSnapshot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==t&&(t=["shapes","imageSize","colors","position","scale","backgroundShapes"]);for(var e={},n=0,i=["colors","position","scale"];n<i.length;n++){var r=i[n];t.indexOf(r)>=0&&(e[r]=this[r])}return t.indexOf("shapes")>=0&&(e.shapes=this.shapes.map((function(t){return(0,a.shapeToJSON)(t)}))),t.indexOf("backgroundShapes")>=0&&(e.backgroundShapes=this.backgroundShapes.map((function(t){return(0,a.shapeToJSON)(t)}))),t.indexOf("imageSize")>=0&&(e.imageSize={width:this.width,height:this.height}),e}},{key:"getSnapshotJSON",value:function(){return console.warn("lc.getSnapshotJSON() is deprecated. use JSON.stringify(lc.getSnapshot()) instead."),JSON.stringify(this.getSnapshot())}},{key:"getSVGString",value:function(t){return null==t&&(t={}),(0,h.default)(this.getSnapshot(),t)}},{key:"loadSnapshot",value:function(t){if(t){if(this.isLoading=!0,t.colors)for(var e=0,n=["primary","secondary","background"];e<n.length;e++){var i=n[e];this.setColor(i,t.colors[i])}if(t.shapes){this.shapes=[],this.undostack=[];var o,s=m(t.shapes);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=(0,a.JSONToShape)(c);l&&this.execute(new r.AddShapeAction(this,l))}}catch(t){s.e(t)}finally{s.f()}}t.backgroundShapes&&(this.backgroundShapes=t.backgroundShapes.map((function(t){return(0,a.JSONToShape)(t)}))),t.imageSize&&(this.width=t.imageSize.width,this.height=t.imageSize.height),t.position&&(this.position=t.position),t.scale&&(this.scale=t.scale),this.isLoading=!1,this.repaintAllLayers(),this.trigger("snapshotLoad"),this.trigger("drawingChange",{})}}},{key:"loadSnapshotJSON",value:function(t){console.warn("lc.loadSnapshotJSON() is deprecated. use lc.loadSnapshot(JSON.parse(snapshot)) instead."),this.loadSnapshot(JSON.parse(t))}}])&&v(e.prototype,n),i&&v(e,i),t}();b.defaultOptions=c.default;var x=b;n.default=x},{"./actions":5,"./bindEvents":6,"./canvasRenderer":7,"./defaultOptions":8,"./renderSnapshotToImage":12,"./renderSnapshotToSVG":13,"./shapes":14,"./tools/Eraser":17,"./tools/Pan":20,"./util":25}],4:[function(t,e,n){"use strict";function i(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=s(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,t("./fontmetrics.js");var l=function(t,e,n){if(!e.length)return["",""];for(var i=0,r=0,o=0,a=!1;;){var s=(i+=1)>=e.length,c=!s&&e[i].match(/\s/),l=c||s,h=e.substring(0,i),u=!n||t.measureTextWidth(h).width<=n;if(u&&(o=i),l&&a&&(a=!1,u&&(r=i)),a=!c,s||!u){if(u)return[e,""];if(r>0){for(var p=r+1;p<e.length&&e[p].match(/\s/);)p+=1;return[e.substring(0,r),e.substring(p)]}return[e.substring(0,o),e.substring(o)]}}},h=function(){function t(e,n,r,s,c){var h=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=n,this.font=r,this.forcedWidth=s,this.forcedHeight=c;var u=function(t){var e,n=t.split(" "),i=0,r=a(n);try{for(r.s();!(e=r.n()).done;){var o=e.value,s=parseInt(o.replace("px",""),10);isNaN(s)||(i=s)}}catch(t){r.e(t)}finally{r.f()}if(!i)throw"Font size not found";return{fontSize:i,fontFamily:t.substring(n[0].length+1).replace("bold ","").replace("italic ","").replace("underline ","")}}(this.font),p=u.fontFamily,f=u.fontSize;e.font=this.font,e.textBaseline="baseline",this.emDashWidth=e.measureTextWidth("â€”",f,p).width,this.caratWidth=e.measureTextWidth("|",f,p).width,this.lines=function(t,e,n){var i,r=[],s=a(e.split(/\r\n|\r|\n/g));try{for(s.s();!(i=s.n()).done;){var c=i.value,h=o(l(t,c,n),2),u=h[0],p=h[1];if(u)for(;u;){r.push(u);var f=o(l(t,p,n),2);u=f[0],p=f[1]}else r.push(c)}}catch(t){s.e(t)}finally{s.f()}return r}(e,this.text,this.forcedWidth),this.metricses=this.lines.map((function(t){return e.measureText2(t||"X",f,h.font)})),this.metrics={ascent:Math.max.apply(Math,i(this.metricses.map((function(t){return t.ascent})))),descent:Math.max.apply(Math,i(this.metricses.map((function(t){return t.descent})))),fontsize:Math.max.apply(Math,i(this.metricses.map((function(t){return t.fontsize})))),leading:Math.max.apply(Math,i(this.metricses.map((function(t){return t.leading})))),width:Math.max.apply(Math,i(this.metricses.map((function(t){return t.width})))),height:Math.max.apply(Math,i(this.metricses.map((function(t){return t.height})))),bounds:{minx:Math.min.apply(Math,i(this.metricses.map((function(t){return t.bounds.minx})))),miny:Math.min.apply(Math,i(this.metricses.map((function(t){return t.bounds.miny})))),maxx:Math.max.apply(Math,i(this.metricses.map((function(t){return t.bounds.maxx})))),maxy:Math.max.apply(Math,i(this.metricses.map((function(t){return t.bounds.maxy}))))}},this.boundingBoxWidth=Math.ceil(this.metrics.width)}var e,n,s;return e=t,(n=[{key:"draw",value:function(t,e,n){t.textBaseline="top",t.font=this.font;var i,r=0,o=a(this.lines);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.fillText(s,e,n+r++*this.metrics.leading)}}catch(t){o.e(t)}finally{o.f()}}},{key:"getWidth",value:function(t){return null==t&&(t=!1),this.forcedWidth?this.forcedWidth:t?this.metrics.bounds.maxx+this.caratWidth:this.metrics.bounds.maxx}},{key:"getHeight",value:function(){return this.forcedHeight||this.metrics.leading*this.lines.length}}])&&r(e.prototype,n),s&&r(e,s),t}();n.default=h},{"./fontmetrics.js":9}],5:[function(t,e,n){"use strict";function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}Object.defineProperty(n,"__esModule",{value:!0}),n.RotateAction=n.AddShapeAction=n.MoveResizeAction=n.MoveAction=n.ClearAction=void 0;var c=function(){function t(e,n,i){o(this,t),this.lc=e,this.oldShapes=n,this.newShapes=i}return s(t,[{key:"do",value:function(){this.lc.shapes=this.newShapes,this.lc.repaintLayer("main")}},{key:"undo",value:function(){this.lc.shapes=this.oldShapes,this.lc.repaintLayer("main")}}]),t}();n.ClearAction=c;var l=function(){function t(e,n,i,r){o(this,t),this.lc=e,this.selectedShape=n,this.previousPosition=i,this.newPosition=r}return s(t,[{key:"do",value:function(){this.selectedShape.setUpperLeft({x:this.newPosition.x,y:this.newPosition.y}),this.lc.repaintLayer("main")}},{key:"undo",value:function(){this.selectedShape.setUpperLeft({x:this.previousPosition.x,y:this.previousPosition.y}),this.lc.repaintLayer("main")}}]),t}();n.MoveAction=l;var h=function(){function t(e,n,i,r,a,s){o(this,t),this.lc=e,this.shape=n,this.oldPosition=i,this.oldScale=r,this.newPosition=a,this.newScale=s}return s(t,[{key:"do",value:function(){var t=this.shape;if(null!==t)if(t.setUpperLeft({x:this.newPosition.x,y:this.newPosition.y}),t.scale&&(t.scale=this.newScale),"SelectShape"!==this.lc.tool.name){var e=new window.LC.tools.SelectShape(this.lc);this.lc.setTool(e),e.setCurrentShape(this.lc,t)}else this.lc.tool.setCurrentShape(this.lc,t);return this.lc.repaintLayer("main")}},{key:"undo",value:function(){var t=this.shape;if(null!==t)if(t.setUpperLeft({x:this.oldPosition.x,y:this.oldPosition.y}),t.scale&&(t.scale=this.oldScale),"SelectShape"!==this.lc.tool.name){var e=new window.LC.tools.SelectShape(this.lc);this.lc.setTool(e),e.setCurrentShape(this.lc,t)}else this.lc.tool.setCurrentShape(this.lc,t);return this.lc.repaintLayer("main")}}]),t}();n.MoveResizeAction=h;var u=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,t),this.lc=e,this.shape=n,this.previousShapeId=i}return s(t,[{key:"do",value:function(){if(this.lc.shapes.length&&this.lc.shapes[this.lc.shapes.length-1].id!==this.previousShapeId&&null!==this.previousShapeId){var t,e=[],n=!1,r=i(this.lc.shapes);try{for(r.s();!(t=r.n()).done;){var o=t.value;e.push(o),o.id===this.previousShapeId&&(e.push(this.shape),n=!0)}}catch(t){r.e(t)}finally{r.f()}n||e.push(this.shape),this.lc.shapes=e}else this.lc.shapes.push(this.shape);this.lc.repaintLayer("main")}},{key:"undo",value:function(){if(this.lc.shapes[this.lc.shapes.length-1].id===this.shape.id)this.lc.shapes.pop();else{var t,e=[],n=i(this.lc.shapes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.id!==this.shape.id&&e.push(r)}}catch(t){n.e(t)}finally{n.f()}this.lc.shapes=e}this.lc.repaintLayer("main")}}]),t}();n.AddShapeAction=u;var p=function(){function t(e,n,i){o(this,t),this.lc=e,this.shape=n,this.rotateAngle=i}return s(t,[{key:"do",value:function(){var t=this.shape;if(null!==t&&t.rotate&&this.rotateAngle){if(t.rotate(this.rotateAngle),"SelectShape"!==this.lc.tool.name){var e=new window.LC.tools.SelectShape(this.lc);this.lc.setTool(e),e.setCurrentShape(this.lc,t)}this.lc.tool.setCurrentShape(this.lc,t)}return this.lc.repaintLayer("main")}},{key:"undo",value:function(){var t=this.shape;if(null!==t&&t.rotate&&this.rotateAngle)if(t.rotate(-this.rotateAngle),"SelectShape"!==this.lc.tool.name){var e=new window.LC.tools.SelectShape(this.lc);this.lc.setTool(e),e.setCurrentShape(this.lc,t)}else this.lc.tool.setCurrentShape(this.lc,t);return this.lc.repaintLayer("main")}}]),t}();n.RotateAction=p},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(t,e){var n,i=document.getElementsByTagName("body")[0];function r(t,e){var n=e.x,i=e.y,r=t.getBoundingClientRect();return{x:n-r.x,y:i-r.y}}window.WheelEvent&&e.addEventListener("wheel",(function(i){i.preventDefault(),i.ctrlKey?function(i){var r=i.deltaY>0?-.2:.2,o=t.scale,a=(l=r+t.scale,l=Math.max(l,t.config.zoomMin),l=Math.min(l,t.config.zoomMax),Math.round(100*l)/100),s=function(t,e){var n=t.getBoundingClientRect();return{x:e.clientX-n.x,y:e.clientY-n.y}}(e,i),c=a-o;var l;t.position.x+=-s.x*t.backingScale*c,t.position.y+=-s.y*t.backingScale*c,t.scale=a,t.keepPanInImageBounds(),window.cancelAnimationFrame(n),n=window.requestAnimationFrame((function(){t.repaintAllLayers(),t.trigger("zoom",{oldScale:o,newScale:t.scale})}))}(i):function(e){var i=e.deltaY>0?-50:50,r=!1;t.height*t.getRenderScale()>t.canvas.height&&(t.position.y+=i*t.backingScale,r=!0);r&&(t.keepPanInImageBounds(),window.cancelAnimationFrame(n),n=window.requestAnimationFrame((function(){t.repaintAllLayers(),t.trigger("pan",{x:t.position.x,y:t.position.y})})))}(i)}),{passive:!1});var o=function(n){n.preventDefault();var i=r(e,n);t.pointerMove(i.x,i.y,n)},a=function n(i){i.preventDefault();var a=r(e,i);e.onselectstart=function(){return!0},t.pointerUp(a.x,a.y,i),document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",n),document.removeEventListener("pointercancel",n)};e.addEventListener("pointerdown",(function(n){if("pen"==n.pointerType?i.classList.add("pen"):i.classList.remove("pen"),"canvas"===n.target.tagName.toLowerCase()){n.preventDefault(),e.onselectstart=function(){return!1};var s=r(e,n);t.pointerDown(s.x,s.y,n),document.addEventListener("pointermove",o),document.addEventListener("pointerup",a),document.addEventListener("pointercancel",a)}}));e.addEventListener("touchmove",(function(t){return t.preventDefault()}),!1),e.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation()}};n.default=i},{}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.renderShapeToContext=n.renderShapeToCanvas=n.defineCanvasRenderer=void 0;var i,r=(i=t("./lineEndCapShapes"))&&i.__esModule?i:{default:i};var o={},a=function(t,e,n){return o[t]={drawFunc:e,drawLatestFunc:n}};n.defineCanvasRenderer=a;var s=function(){},c=function(t,e,n){null==n&&(n={}),null==n.shouldIgnoreUnsupportedShapes&&(n.shouldIgnoreUnsupportedShapes=!1),null==n.retryCallback&&(n.retryCallback=s),null==n.shouldOnlyDrawLatest&&(n.shouldOnlyDrawLatest=!1),null==n.bufferCtx&&(n.bufferCtx=null);var i=n.bufferCtx;if(o[e.className])n.shouldOnlyDrawLatest&&o[e.className].drawLatestFunc?o[e.className].drawLatestFunc(t,i,e,n.retryCallback):o[e.className].drawFunc(t,e,n.retryCallback);else{if(!n.shouldIgnoreUnsupportedShapes)throw"Can't render shape of type ".concat(e.className," to canvas");console.warn("Can't render shape of type ".concat(e.className," to canvas"))}};n.renderShapeToContext=c;var l;function h(t,e,n){if(e.image.width){var i,r,o=e.scale||1,a=e.image.width*o,s=e.image.height*o;if(0===e.rotateAngle||180===e.rotateAngle?(i=e.x,r=e.y):(i=e.x+e.image.height*o/2-e.image.width*o/2,r=e.y+e.image.width*o/2-e.image.height*o/2),!(e.rotateAngle>0))return t.drawImage(e.image,e.x,e.y,a,s);t.save(),t.translate(i,r),t.translate(a/2,s/2),t.rotate(e.rotateAngle*Math.PI/180),t.drawImage(e.image,-a/2,-s/2,a,s),t.restore()}else n&&(e.image.onload=n)}n.renderShapeToCanvas=function(t,e,n){return c(t.getContext("2d"),e,n)},a("SelectionBox",(l=function(t,e,n){var i=e.x,r=e.y;0!==n&&(t.fillStyle="#fff",t.fillRect(i,r,n,n),t.strokeStyle="#000",t.strokeRect(i,r,n,n))},function(t,e){l(t,e.getTopLeftHandleRect(),e.handleSize),l(t,e.getTopRightHandleRect(),e.handleSize),l(t,e.getBottomLeftHandleRect(),e.handleSize),l(t,e.getBottomRightHandleRect(),e.handleSize),e.backgroundColor&&(t.fillStyle=e.backgroundColor,t.fillRect(e._br.x-e.margin,e._br.y-e.margin,e._br.width+2*e.margin,e._br.height+2*e.margin)),t.lineWidth=1,t.strokeStyle=e.backgroundColor||"#000",t.setLineDash([2,4]),t.strokeRect(e._br.x-e.margin,e._br.y-e.margin,e._br.width+2*e.margin,e._br.height+2*e.margin),t.setLineDash([])})),a("Image",h),a("ImageWithRotate",h),a("Line",(function(t,e){if(e.x1!==e.x2||e.y1!==e.y2){var n=e.x1,i=e.x2,o=e.y1,a=e.y2;e.strokeWidth%2!=0&&(n+=.5,i+=.5,o+=.5,a+=.5),t.lineWidth=e.strokeWidth,t.strokeStyle=e.color,t.lineCap=e.capStyle,e.dash&&t.setLineDash(e.dash),t.beginPath(),t.moveTo(n,o),t.lineTo(i,a),t.stroke(),e.dash&&t.setLineDash([]);var s=Math.max(2.2*e.strokeWidth,5);e.endCapShapes[0]&&r.default[e.endCapShapes[0]].drawToCanvas(t,n,o,Math.atan2(o-a,n-i),s,e.color),e.endCapShapes[1]&&r.default[e.endCapShapes[1]].drawToCanvas(t,i,a,Math.atan2(a-o,i-n),s,e.color)}}));var u=function(t,e,n,i){if(null==n&&(n=!1),null==i&&(i="round"),e.length&&(t.lineCap=i||"round",t.strokeStyle=e[0].color,t.lineWidth=e[0].size,1!==e.length)){var r=e[0],o=e[1];t.moveTo(r.x,r.y),t.beginPath();for(var a=1,s=e.length;a<s;a++)p(t,r,o),r=e[a],o=e[a+1];n&&t.closePath()}},p=function(t,e,n){var i=e.x,r=e.y,o=n.x,a=n.y;e.size%2!=0&&(i+=.5,r+=.5,o+=.5,a+=.5);var s=f(i,o),c=f(r,a);t.quadraticCurveTo(i,r,s,c)},f=function(t,e,n){return void 0===n&&(n=.5),t+(e-t)*(n=Math.max(Math.min(1,n),0))},d=function(t,e){u(t,e.points),t.stroke()},g=function(t,e,n){u(e,n.points,!1,"round"),e.stroke()};a("LinePath",d,g);a("ErasedLinePath",(function(t,e){t.save(),t.globalCompositeOperation="destination-out",d(t,e),t.restore()}),(function(t,e,n){t.save(),t.globalCompositeOperation="destination-out",e.save(),e.globalCompositeOperation="destination-out",g(0,e,n),t.restore(),e.restore()})),a("Text",(function(t,e){e.renderer||e._makeRenderer(t),t.fillStyle=e.color,e.renderer.draw(t,e.x,e.y)}))},{"./lineEndCapShapes":10}],8:[function(t,e,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r={imageURLPrefix:"lib/img",primaryColor:"hsla(0, 0%, 0%, 1)",secondaryColor:"hsla(0, 0%, 100%, 1)",backgroundColor:"transparent",strokeWidths:[1,2,5,10,20,30],defaultStrokeWidth:5,toolbarPosition:"top",keyboardShortcuts:!1,imageSize:{width:"infinite",height:"infinite"},backgroundShapes:[],watermarkImage:null,watermarkScale:1,zoomMin:.2,zoomMax:4,zoomStep:.2,snapshot:null,penMode:!0,previousTool:null,panTool:4,onInit:function(){},tools:[((i=t("./tools/Pencil"))&&i.__esModule?i:{default:i}).default]};n.default=r},{"./tools/Pencil":21}],9:[function(t,e,n){"use strict";!function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function e(e){return String(e).replace(/[&<>"'`=/]/g,(function(e){return t[e]}))}if(!document.defaultView.getComputedStyle)throw"ERROR: 'document.defaultView.getComputedStyle' not found. This library only works in browsers that can report computed CSS values.";CanvasRenderingContext2D.prototype.measureTextWidth=CanvasRenderingContext2D.prototype.measureText;CanvasRenderingContext2D.prototype.measureText2=function(t,n,i){var r=this.measureTextWidth(t),o=!/\S/.test(t);r.fontsize=n;var a=document.createElement("div");a.style.position="absolute",a.style.opacity=0,a.style.font=i,a.innerHTML=e(t)+"<br/>"+e(t),document.body.appendChild(a),r.leading=1.2*n;var s,c,l=(s=a,c="height",document.defaultView.getComputedStyle(s,null).getPropertyValue(c));if((l=l.replace("px",""))>=2*n&&(r.leading=l/2|0),document.body.removeChild(a),o)r.ascent=0,r.descent=0,r.bounds={minx:0,maxx:r.width,miny:0,maxy:0},r.height=0;else{var h=document.createElement("canvas"),u=100;h.width=r.width+u,h.height=3*n,h.style.opacity=1,h.style.font=i;var p=h.getContext("2d");p.font=i;var f=h.width,d=h.height,g=d/2;p.fillStyle="white",p.fillRect(-1,-1,f+2,d+2),p.fillStyle="black",p.fillText(t,50,g);for(var m=p.getImageData(0,0,f,d).data,y=0,v=4*f,S=m.length;++y<S&&255===m[y];);var b=y/v|0;for(y=S-1;--y>0&&255===m[y];);var x=y/v|0;for(y=0;y<S&&255===m[y];)(y+=v)>=S&&(y=y-S+4);var w=y%v/4|0,k=1;for(y=S-3;y>=0&&255===m[y];)(y-=v)<0&&(y=S-3-4*k++);var C=y%v/4+1|0;r.ascent=g-b,r.descent=x-g,r.bounds={minx:w-50,maxx:C-50,miny:0,maxy:x-b},r.height=x-b+1}return r}}()},{}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(t,e,n,i,r){return[{x:t+Math.cos(n+Math.PI/2)*i/2,y:e+Math.sin(n+Math.PI/2)*i/2},{x:t+Math.cos(n)*r,y:e+Math.sin(n)*r},{x:t+Math.cos(n-Math.PI/2)*i/2,y:e+Math.sin(n-Math.PI/2)*i/2}]},r={arrow:{drawToCanvas:function(t,e,n,r,o,a,s){null==s&&(s=0),s=s||o,t.fillStyle=a,t.lineWidth=0,t.strokeStyle="transparent",t.beginPath();var c=i(e,n,r,o,s);t.moveTo(c[0].x,c[0].y),t.lineTo(c[1].x,c[1].y),t.lineTo(c[2].x,c[2].y),t.fill()},svg:function(t,e,n,r,o,a){null==a&&(a=0);var s=i(t,e,n,r,a=a||r);return"<polygon fill='".concat(o,"' stroke='none' points='").concat(s.map((function(t){return"".concat(t.x,",").concat(t.y)})),"' />")}}};n.default=r},{}],11:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n._=n.localize=void 0;var i={};n.localize=function(t){return i=t};n._=function(t){return i[t]||t}},{}],12:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("./util"),r=t("./shapes"),o="infinite",a=function(t,e){null==e&&(e={}),null==e.scale&&(e.scale=1);var n=t.shapes.map((function(t){return(0,r.JSONToShape)(t)})),a=t.backgroundShapes.map((function(t){return(0,r.JSONToShape)(t)}));null==e.margin&&(e.margin={top:0,right:0,bottom:0,left:0});var s,c,l,h=t.imageSize||{width:o,height:o},u=t.colors||{background:"transparent"},p=n.concat(a),f=document.createElement("canvas"),d=f.getContext("2d");return e.rect?(e.rect.x-=e.margin.left,e.rect.y-=e.margin.top,e.rect.width+=e.margin.left+e.margin.right,e.rect.height+=e.margin.top+e.margin.bottom):e.rect=(0,i.getDefaultImageRect)(p.map((function(t){return t.getBoundingRect(d)})),h,e.margin),f.width=e.rect.width*e.scale,f.height=e.rect.height*e.scale,d.fillStyle=u.background,d.fillRect(0,0,f.width,f.height),e.rect.width&&e.rect.height?(e.watermarkImage&&(s=d,c=e.watermarkImage,l=e.watermarkScale,c.width&&(s.save(),s.translate(s.canvas.width/2,s.canvas.height/2),s.scale(l,l),s.drawImage(c,-c.width/2,-c.height/2),s.restore())),(0,i.combineCanvases)(f,(0,i.renderShapes)(a,e.rect,e.scale),(0,i.renderShapes)(n,e.rect,e.scale))):null};n.default=a},{"./shapes":14,"./util":25}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("./util"),r=t("./shapes"),o="infinite",a=function(t,e){null==e&&(e={});var n=t.shapes.map((function(t){return(0,r.JSONToShape)(t)})),a=t.backgroundShapes.map((function(t){return(0,r.JSONToShape)(t)}));null==e.margin&&(e.margin={top:0,right:0,bottom:0,left:0});var s=t.imageSize||{width:o,height:o},c=t.colors||{background:"transparent"},l=n.concat(a),h=document.createElement("canvas").getContext("2d");return e.rect?(e.rect.x-=e.margin.left,e.rect.y-=e.margin.top,e.rect.width+=e.margin.left+e.margin.right,e.rect.height+=e.margin.top+e.margin.bottom):e.rect=(0,i.getDefaultImageRect)(l.map((function(t){return t.getBoundingRect(h)})),s,e.margin),(0,i.renderShapesToSVG)(a.concat(n),e.rect,c.background)};n.default=a},{"./shapes":14,"./util":25}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shapeToJSON=n.JSONToShape=n.createShape=n.defineShape=void 0;var i,r=t("./util"),o=(i=t("./TextRenderer"))&&i.__esModule?i:{default:i},a=t("./canvasRenderer"),s=t("./svgRenderer");function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=h(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function h(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var p={},f=function(t,e){var n=function(t,n,i,r,o,a,s,c,l,h,u,p,f,d,g,m){return e.constructor.call(this,t,n,i,r,o,a,s,c,l,h,u,p,f,d,g,m),this};if(n.prototype.className=t,n.fromJSON=e.fromJSON,e.draw){var i=e.draw,r=e.draw||function(t,e,n){this.draw(t,e,n)};delete e.draw,e.drawLatest&&delete e.drawLatest,(0,a.defineCanvasRenderer)(t,(function(t,e,n){return i.call(e,t,n)}),(function(t,e,n,i){return r.call(n,t,e,i)}))}if(e.toSVG){var o=e.toSVG;delete e.toSVG,(0,s.defineSVGRenderer)(t,(function(t){return o.call(t)}))}for(var c in n.prototype.draw=function(t,e){(0,a.renderShapeToContext)(t,this,{retryCallback:e})},n.prototype.drawLatest=function(t,e,n){(0,a.renderShapeToContext)(t,this,{retryCallback:n,bufferCtx:e,shouldOnlyDrawLatest:!0})},n.prototype.toSVG=function(){(0,s.renderShapeToSVG)(this)},e)"fromJSON"!==c&&(n.prototype[c]=e[c]);return p[t]=n,n};n.defineShape=f;var d=function(t,e,n,i,o,a,s,c,l,h,u,f,d,g,m,y,v){var S=new p[t](e,n,i,o,a,s,c,l,h,u,f,d,g,m,y,v);return S.id=(0,r.getGUID)(),S};n.createShape=d;var g=function(t){var e=t.className,n=t.data,i=t.id;if(e in p){var r=p[e].fromJSON(n);return r?(i&&(r.id=i),r):(console.log("Unreadable shape:",e,n),null)}return console.log("Unknown shape:",e,n),null};n.JSONToShape=g;var m=function(t){return{className:t.className,data:t.toJSON(),id:t.id}};n.shapeToJSON=m;var y={constructor:function(t){null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.scale=t.scale||1,this.image=t.image||null,this.rotateAngle=t.rotateAngle||0,this.crossOrigin=t.image&&t.image.crossOrigin||null},getBoundingRect:function(){return 0===this.rotateAngle||180===this.rotateAngle?{x:this.x,y:this.y,width:this.image.width*this.scale,height:this.image.height*this.scale}:{x:this.x,y:this.y,width:this.image.height*this.scale,height:this.image.width*this.scale}},toJSON:function(){var t={x:this.x,y:this.y,imageSrc:this.image.src,imageObject:this.image,scale:this.scale,rotateAngle:this.rotateAngle};return this.crossOrigin&&(t.crossOrigin=this.crossOrigin),t},fromJSON:function(t){var e=null;return(null!=t.imageObject?t.imageObject.width:void 0)?e=t.imageObject:((e=new Image).src=t.imageSrc,t.crossOrigin&&(e.crossOrigin=t.crossOrigin)),d("Image",{x:t.x,y:t.y,image:e,scale:t.scale,rotateAngle:t.rotateAngle})},move:function(t){null==t&&(t={}),this.x=this.x-t.xDiff,this.y=this.y-t.yDiff},setUpperLeft:function(t){null==t&&(t={}),this.x=t.x,this.y=t.y},rotate:function(t){var e=this.rotateAngle;for(this.rotateAngle+=t;this.rotateAngle>=360;)this.rotateAngle-=360;for(;this.rotateAngle<0;)this.rotateAngle+=360;this.image&&(0===e||180===e?0===this.rotateAngle&&180===this.rotateAngle||(this.x=this.x+this.image.width*this.scale/2-this.image.height*this.scale/2,this.y=this.y+this.image.height*this.scale/2-this.image.width*this.scale/2):0!==this.rotateAngle&&180!==this.rotateAngle||(this.x=this.x+this.image.height*this.scale/2-this.image.width*this.scale/2,this.y=this.y+this.image.width*this.scale/2-this.image.height*this.scale/2))}};f("Image",y),f("ImageWithRotate",y),f("Rectangle",{constructor:function(t){null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.strokeWidth=t.strokeWidth||1,this.strokeColor=t.strokeColor||"black",this.fillColor=t.fillColor||"transparent"},getBoundingRect:function(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function(t){return d("Rectangle",t)},move:function(t){null==t&&(t={}),this.x=this.x-t.xDiff,this.y=this.y-t.yDiff},setUpperLeft:function(t){null==t&&(t={}),this.x=t.x,this.y=t.y}}),f("Ellipse",{constructor:function(t){null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.strokeWidth=t.strokeWidth||1,this.strokeColor=t.strokeColor||"black",this.fillColor=t.fillColor||"transparent"},getBoundingRect:function(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function(t){return d("Ellipse",t)},move:function(t){null==t&&(t={}),this.x=this.x-t.xDiff,this.y=this.y-t.yDiff},setUpperLeft:function(t){null==t&&(t={}),this.x=t.x,this.y=t.y}}),f("Line",{constructor:function(t){null==t&&(t={}),this.x1=t.x1||0,this.y1=t.y1||0,this.x2=t.x2||0,this.y2=t.y2||0,this.strokeWidth=t.strokeWidth||1,this.color=t.color||"black",this.capStyle=t.capStyle||"round",this.endCapShapes=t.endCapShapes||[null,null],this.dash=t.dash||null},getBoundingRect:function(){return{x:Math.min(this.x1,this.x2)-this.strokeWidth/2,y:Math.min(this.y1,this.y2)-this.strokeWidth/2,width:Math.abs(this.x2-this.x1)+this.strokeWidth/2,height:Math.abs(this.y2-this.y1)+this.strokeWidth/2}},toJSON:function(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,strokeWidth:this.strokeWidth,color:this.color,capStyle:this.capStyle,dash:this.dash,endCapShapes:this.endCapShapes}},fromJSON:function(t){return d("Line",t)},move:function(t){null==t&&(t={}),this.x1=this.x1-t.xDiff,this.y1=this.y1-t.yDiff,this.x2=this.x2-t.xDiff,this.y2=this.y2-t.yDiff},setUpperLeft:function(t){null==t&&(t={});var e=this.getBoundingRect(),n=e.x-t.x,i=e.y-t.y;this.move({xDiff:n,yDiff:i})}});var v=function(t,e){var n=null;return e.points?n=e.points.map((function(t){return g(t)})):e.pointCoordinatePairs&&(n=e.pointCoordinatePairs.map((function(t){var n=c(t,2),i=n[0],r=n[1];return g({className:"Point",data:{x:i,y:r,size:e.pointSize,color:e.pointColor,smooth:e.smooth}})}))),n[0]?d(t,{points:n,order:e.order,tailSize:e.tailSize,smooth:e.smooth}):null},S={constructor:function(t){var e=this;null==t&&(t={});var n=t.points||[];this.order=t.order||3,this.tailSize=t.tailSize||3,this.smooth=!("smooth"in t)||t.smooth,this.segmentSize=Math.pow(2,this.order),this.sampleSize=this.tailSize+1,this.points=[],n.map((function(t){return e.addPoint(t)}))},getBoundingRect:function(){return(0,r.getBoundingRect)(this.points.map((function(t){return{x:t.x-t.size/2,y:t.y-t.size/2,width:t.size,height:t.size}})))},toJSON:function(){return function(t){if(!t.length)return!1;var e,n=t[0].size,i=t[0].color,r=l(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(o.size===n&&o.color===i||console.log(n,i,o.size,o.color),o.size!==n||o.color!==i)return!1}}catch(t){r.e(t)}finally{r.f()}return!0}(this.points)?{order:this.order,tailSize:this.tailSize,smooth:this.smooth,pointCoordinatePairs:this.points.map((function(t){return[t.x,t.y]})),pointSize:this.points[0].size,pointColor:this.points[0].color}:{order:this.order,tailSize:this.tailSize,smooth:this.smooth,points:this.points.map((function(t){return m(t)}))}},fromJSON:function(t){return v("LinePath",t)},addPoint:function(t){this.points.push(t)},move:function(t){null==t&&(t={});var e,n=l(this.points);try{for(n.s();!(e=n.n()).done;){e.value.move(t)}}catch(t){n.e(t)}finally{n.f()}},setUpperLeft:function(t){null==t&&(t={});var e=this.getBoundingRect(),n=e.x-t.x,i=e.y-t.y;this.move({xDiff:n,yDiff:i})}};f("LinePath",S);f("ErasedLinePath",{constructor:S.constructor,toJSON:S.toJSON,addPoint:S.addPoint,getBoundingRect:S.getBoundingRect,fromJSON:function(t){return v("ErasedLinePath",t)}}),f("Point",{constructor:function(t){null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.size=t.size||0,this.color=t.color||""},getBoundingRect:function(){return{x:this.x-this.size/2,y:this.y-this.size/2,width:this.size,height:this.size}},toJSON:function(){return{x:this.x,y:this.y,size:this.size,color:this.color}},fromJSON:function(t){return d("Point",t)},move:function(t){null==t&&(t={}),this.x=this.x-t.xDiff,this.y=this.y-t.yDiff},setUpperLeft:function(t){null==t&&(t={}),this.x=t.x,this.y=t.y}}),f("Polygon",{constructor:function(t){var e=this;null==t&&(t={}),this.points=t.points,this.fillColor=t.fillColor||"white",this.strokeColor=t.strokeColor||"black",this.strokeWidth=t.strokeWidth,this.dash=t.dash||null,null==t.isClosed&&(t.isClosed=!0),this.isClosed=t.isClosed,this.points.forEach((function(t){t.color=e.strokeColor,t.size=e.strokeWidth}))},addPoint:function(t,e){this.points.push(d("Point",{x:t,y:e}))},getBoundingRect:function(){return(0,r.getBoundingRect)(this.points.map((function(t){return t.getBoundingRect()})))},toJSON:function(){return{strokeWidth:this.strokeWidth,fillColor:this.fillColor,strokeColor:this.strokeColor,dash:this.dash,isClosed:this.isClosed,pointCoordinatePairs:this.points.map((function(t){return[t.x,t.y]}))}},fromJSON:function(t){return t.points=t.pointCoordinatePairs.map((function(){var e=arguments.length<=0?void 0:arguments[0],n=c(e,2),i=n[0],r=n[1];return d("Point",{x:i,y:r,size:t.strokeWidth,color:t.strokeColor})})),d("Polygon",t)},move:function(t){null==t&&(t={}),this.points.map((function(e){return e.move(t)}))},setUpperLeft:function(t){null==t&&(t={});var e=this.getBoundingRect(),n=e.x-t.x,i=e.y-t.y;this.move({xDiff:n,yDiff:i})}}),f("Text",{constructor:function(t){null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.v=t.v||0,this.text=t.text||"",this.color=t.color||"black",this.font=t.font||"18px sans-serif",this.forcedWidth=t.forcedWidth||null,this.forcedHeight=t.forcedHeight||null},_makeRenderer:function(t){t.lineHeight=1.2,this.renderer=new o.default(t,this.text,this.font,this.forcedWidth,this.forcedHeight),this.v<1&&(console.log("repairing baseline"),this.v=1,this.x-=this.renderer.metrics.bounds.minx,this.y-=this.renderer.metrics.leading-this.renderer.metrics.descent)},setText:function(t){this.text=t,this.renderer=null},setFont:function(t){this.font=t,this.renderer=null},setPosition:function(t,e){this.x=t,this.y=e},setSize:function(t,e){this.forcedWidth=Math.max(t,0),this.forcedHeight=Math.max(e,0),this.renderer=null},enforceMaxBoundingRect:function(t){var e=this.getBoundingRect(t.ctx),n=-t.position.x/t.scale,i=(t.position.y,t.scale,t.canvas.offsetWidth/t.scale);t.canvas.offsetHeight,t.scale;if(e.x+e.width>n+i){var r=e.x-n;this.forcedWidth=i-r-10,this.renderer=null}},getBoundingRect:function(t,e){if(null==e&&(e=!1),!this.renderer){if(!t)throw"Must pass ctx if text hasn't been rendered yet";this._makeRenderer(t)}return{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.ceil(this.renderer.getWidth(!0)),height:Math.ceil(this.renderer.getHeight())}},toJSON:function(){return{x:this.x,y:this.y,text:this.text,color:this.color,font:this.font,forcedWidth:this.forcedWidth,forcedHeight:this.forcedHeight,v:this.v}},fromJSON:function(t){return d("Text",t)},move:function(t){null==t&&(t={}),this.x=this.x-t.xDiff,this.y=this.y-t.yDiff},setUpperLeft:function(t){null==t&&(t={}),this.x=t.x,this.y=t.y}}),f("SelectionBox",{constructor:function(t){null==t&&(t={}),this.shape=t.shape,null!=t.handleSize?this.handleSize=t.handleSize:this.handleSize=10,this.margin=4,this.backgroundColor=t.backgroundColor||null,this._br=this.shape.getBoundingRect(t.ctx)},toJSON:function(){return{shape:m(this.shape),backgroundColor:this.backgroundColor}},fromJSON:function(t){var e=t.shape,n=(t.handleSize,t.margin,t.backgroundColor);return d("SelectionBox",{shape:g(e),backgroundColor:n})},getTopLeftHandleRect:function(){return{x:this._br.x-this.handleSize-this.margin,y:this._br.y-this.handleSize-this.margin,width:this.handleSize,height:this.handleSize}},getBottomLeftHandleRect:function(){return{x:this._br.x-this.handleSize-this.margin,y:this._br.y+this._br.height+this.margin,width:this.handleSize,height:this.handleSize}},getTopRightHandleRect:function(){return{x:this._br.x+this._br.width+this.margin,y:this._br.y-this.handleSize-this.margin,width:this.handleSize,height:this.handleSize}},getBottomRightHandleRect:function(){return{x:this._br.x+this._br.width+this.margin,y:this._br.y+this._br.height+this.margin,width:this.handleSize,height:this.handleSize}},getBoundingRect:function(){return{x:this._br.x-this.margin,y:this._br.y-this.margin,width:this._br.width+2*this.margin,height:this._br.height+2*this.margin}}})},{"./TextRenderer":4,"./canvasRenderer":7,"./svgRenderer":15,"./util":25}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.renderShapeToSVG=n.defineSVGRenderer=void 0;var i,r=(i=t("./lineEndCapShapes"))&&i.__esModule?i:{default:i};var o={},a=function(t,e){return o[t]=e};n.defineSVGRenderer=a;n.renderShapeToSVG=function(t,e){if(null==e&&(e={}),null==e.shouldIgnoreUnsupportedShapes&&(e.shouldIgnoreUnsupportedShapes=!1),o[t.className])return o[t.className](t);if(e.shouldIgnoreUnsupportedShapes)return console.warn("Can't render shape of type ".concat(t.className," to SVG")),"";throw"Can't render shape of type ".concat(t.className," to SVG")};var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};a("Rectangle",(function(t){var e=t.x,n=t.y,i=t.x+t.width,r=t.y+t.height,o=Math.min(e,i),a=Math.min(n,r),s=Math.max(e,i)-o,c=Math.max(n,r)-a;return t.strokeWidth%2!=0&&(o+=.5,a+=.5),"<rect x='".concat(o,"' y='").concat(a,"' width='").concat(s,"' height='").concat(c,"' stroke='").concat(t.strokeColor,"' fill='").concat(t.fillColor,"' stroke-width='").concat(t.strokeWidth,"' />")})),a("SelectionBox",(function(){})),a("Ellipse",(function(t){var e=Math.floor(t.width/2),n=Math.floor(t.height/2),i=t.x+e,r=t.y+n;return"<ellipse cx='".concat(i,"' cy='").concat(r,"' rx='").concat(Math.abs(e),"' ry='").concat(Math.abs(n),"' stroke='").concat(t.strokeColor,"' fill='").concat(t.fillColor,"' stroke-width='").concat(t.strokeWidth,"' />")})),a("Image",(function(t){return"<image x='".concat(t.x,"' y='").concat(t.y,"' width='").concat(t.image.naturalWidth*t.scale,"' height='").concat(t.image.naturalHeight*t.scale,"' xlink:href='").concat(t.image.src,"' />")})),a("Line",(function(t){var e=t.dash?"stroke-dasharray='".concat(t.dash.join(", "),"'"):"",n="",i=Math.max(2.2*t.strokeWidth,5),o=t.x1,a=t.x2,s=t.y1,c=t.y2;return t.strokeWidth%2!=0&&(o+=.5,a+=.5,s+=.5,c+=.5),t.endCapShapes[0]&&(n+=r.default[t.endCapShapes[0]].svg(o,s,Math.atan2(s-c,o-a),i,t.color)),t.endCapShapes[1]&&(n+=r.default[t.endCapShapes[1]].svg(a,c,Math.atan2(c-s,a-o),i,t.color)),"<g> <line x1='".concat(o,"' y1='").concat(s,"' x2='").concat(a,"' y2='").concat(c,"' ").concat(e," stroke-linecap='").concat(t.capStyle,"' stroke='").concat(t.color,"' stroke-width='").concat(t.strokeWidth,"' /> ").concat(n," </g>")})),a("LinePath",(function(t){return"<polyline fill='none' points='".concat(t.points.map((function(t){var e=t.strokeWidth%2==0?0:.5;return"".concat(t.x+e,",").concat(t.y+e)})).join(" "),"' stroke='").concat(t.points[0].color,"' stroke-linecap='round' stroke-width='").concat(t.points[0].size,"' />")})),a("ErasedLinePath",(function(){})),a("Polygon",(function(t){return t.isClosed?"<polygon fill='".concat(t.fillColor,"' points='").concat(t.points.map((function(t){var e=t.strokeWidth%2==0?0:.5;return"".concat(t.x+e,",").concat(t.y+e)})).join(" "),"' stroke='").concat(t.strokeColor,"' stroke-width='").concat(t.strokeWidth,"' />"):"<polyline fill='".concat(t.fillColor,"' points='").concat(t.points.map((function(t){var e=t.strokeWidth%2==0?0:.5;return"".concat(t.x+e,",").concat(t.y+e)})).join(" "),"' stroke='none' /> <polyline fill='none' points='").concat(t.points.map((function(t){var e=t.strokeWidth%2==0?0:.5;return"".concat(t.x+e,",").concat(t.y+e)})).join(" "),"' stroke='").concat(t.strokeColor,"' stroke-width='").concat(t.strokeWidth,"' />")})),a("Text",(function(t){var e=t.forcedWidth?"width='".concat(t.forcedWidth,"px'"):"",n=t.forcedHeight?"height='".concat(t.forcedHeight,"px'"):"",i=t.text.split(/\r\n|\r|\n/g);return t.renderer&&(i=t.renderer.lines),"<text x='".concat(t.x,"' y='").concat(t.y,"' ").concat(e," ").concat(n," fill='").concat(t.color,"' style='font: ").concat(t.font,";'> ").concat(i.map((function(e,n){var i=0===n?0:"1.2em";return"<tspan x='".concat(t.x,"' dy='").concat(i,"' alignment-baseline='text-before-edge'> ").concat(String(e).replace(/[&<>"'`=/]/g,(function(t){return s[t]}))," </tspan>")})).join("")," </text>")}))},{"./lineEndCapShapes":10}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=(i=t("./Text"))&&i.__esModule?i:{default:i};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=h(t);if(e){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}HTMLTextAreaElement.prototype.insertAtCaret=function(t){if(t=t||"",document.selection)this.focus(),document.selection.createRange().text=t;else if(this.selectionStart||0===this.selectionStart){var e=this.selectionStart,n=this.selectionEnd;this.value=this.value.substring(0,e)+t+this.value.substring(n,this.value.length),this.selectionStart=e+t.length,this.selectionEnd=e+t.length}else this.value+=t};var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,t);var e,n,i,r=c(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).fieldOptions=o.fieldOptions,t}return e=o,(n=[{key:"insertTemplateText",value:function(t){if(this.inputEl){this.inputEl.insertAtCaret(t);var e=new Event("input");this.inputEl.dispatchEvent(e)}}}])&&a(e.prototype,n),i&&a(e,i),o}(r.default);u.prototype.optionsStyle="font-with-fields",u.fieldOptions=[];var p=u;n.default=p},{"./Text":23}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("../actions");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=h(t);if(e){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,t);var e,n,r,l=c(h);function h(){return o(this,h),l.apply(this,arguments)}return e=h,(n=[{key:"didBecomeActive",value:function(t){var e,n=[];return this.unsubscribe=function(){var t,e,i,r;for(r=[],e=0,i=n.length;e<i;e++)t=n[e],r.push(t());return r},n.push(t.on("lc-pointerdown",(e=this,function(n){var i,r,o;return r=n.rawX,o=n.rawY,i={x:(-t.position.x/t.backingScale+r)/t.scale,y:(-t.position.y/t.backingScale+o)/t.scale},e.oldPosition=i,e.pointerStart={x:r,y:o}}))),n.push(t.on("lc-pointerdrag",function(e){return function(n){var i,r,o;r=n.rawX,o=n.rawY,i={x:(-t.position.x/t.backingScale+r)/t.scale,y:(-t.position.y/t.backingScale+o)/t.scale},e.pointerStart=e.oldPosition,e.oldPosition=i,e._eraseLine(t,e.oldPosition.x,e.oldPosition.y,e.pointerStart.x,e.pointerStart.y)}}(this)))}},{key:"willBecomeInactive",value:function(t){return this.unsubscribe()}},{key:"_eraseLine",value:function(t,e,n,r,o){var a=this,s=[];if(t.shapes.forEach((function(t){if(t.points)for(var i=0;i<t.points.length-1;i++)if(a._checkPathsIntersect(e,n,r,o,t.points[i].x,t.points[i].y,t.points[i+1].x,t.points[i+1].y)){s.push(t.id);break}(t.x1||t.y1||t.x2||t.y2)&&a._checkPathsIntersect(e,n,r,o,t.x1,t.y1,t.x2,t.y2)&&s.push(t.id)})),s.length){for(var c=0;c<s.length;c++){for(var l=[],h=0;h<t.shapes.length;h++)t.shapes[h].id!==s[c]&&l.push(t.shapes[h]);t.execute(new i.ClearAction(t,t.shapes,l)),t.trigger("drawingChange",{})}t.setShapesInProgress([]),t.repaintAllLayers("main")}}},{key:"_checkPathsIntersect",value:function(t,e,n,i,r,o,a,s){var c,l,h;return 0!=(c=(n-t)*(s-o)-(a-r)*(i-e))&&(l=((e-i)*(a-t)+(n-t)*(s-e))/c,0<(h=((s-o)*(a-t)+(r-a)*(s-e))/c)&&h<1&&0<l&&l<1)}}])&&a(e.prototype,n),r&&a(e,r),h}(t("./base").Tool);u.prototype.name="Eraser",u.prototype.iconName="eraser",u.prototype.usesSimpleAPI=!1,u.prototype.optionsStyle=null;var p=u;n.default=p},{"../actions":5,"./base":24}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=(i=t("./Pencil"))&&i.__esModule?i:{default:i},o=t("../shapes");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=p(t);if(e){var r=p(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(a,t);var e,n,i,r=h(a);function a(){return s(this,a),r.apply(this,arguments)}return e=a,(n=[{key:"makePoint",value:function(t,e,n){return(0,o.createShape)("Point",{x:t,y:e,size:this.strokeWidth,color:"#000"})}},{key:"makeShape",value:function(){return(0,o.createShape)("ErasedLinePath")}}])&&c(e.prototype,n),i&&c(e,i),a}(r.default);f.prototype.name="EraserOld",f.prototype.iconName="eraser";var d=f;n.default=d},{"../shapes":14,"./Pencil":21}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("./base"),r=t("../shapes");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=u(t);if(e){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,t);var e,n,i,o=l(h);function h(){return a(this,h),o.apply(this,arguments)}return e=h,(n=[{key:"begin",value:function(t,e,n){return this.currentShape=(0,r.createShape)("Line",{x1:t,y1:e,x2:t,y2:e,strokeWidth:this.strokeWidth,dash:function(){switch(!1){case!this.isDashed:return[2*this.strokeWidth,4*this.strokeWidth];default:return null}}.call(this),endCapShapes:this.hasEndArrow?[null,"arrow"]:null,color:n.getColor("primary")})}},{key:"continue",value:function(t,e,n){return this.currentShape.x2=t,this.currentShape.y2=e,n.drawShapeInProgress(this.currentShape)}},{key:"end",value:function(t,e,n){return n.saveShape(this.currentShape)}}])&&s(e.prototype,n),i&&s(e,i),h}(i.ToolWithStroke);p.prototype.name="Line",p.prototype.iconName="line",p.prototype.optionsStyle="line-options-and-stroke-width";var f=p;n.default=f},{"../shapes":14,"./base":24}],20:[function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=l(t);if(e){var r=l(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,t);var e,n,i,c=s(l);function l(){return r(this,l),c.apply(this,arguments)}return e=l,(n=[{key:"didBecomeActive",value:function(t){var e,n=[];return this.unsubscribe=function(){var t,e,i,r;for(r=[],e=0,i=n.length;e<i;e++)t=n[e],r.push(t());return r},n.push(t.on("lc-pointerdown",(e=this,function(n){var i,r;return i=n.rawX,r=n.rawY,e.oldPosition=t.position,e.pointerStart={x:i,y:r}}))),n.push(t.on("lc-pointerdrag",function(e){return function(n){var i,r,o;return r=n.rawX,o=n.rawY,i={x:(r-e.pointerStart.x)*t.backingScale,y:(o-e.pointerStart.y)*t.backingScale},t.setPan(e.oldPosition.x+i.x,e.oldPosition.y+i.y)}}(this)))}},{key:"willBecomeInactive",value:function(t){return this.unsubscribe()}}])&&o(e.prototype,n),i&&o(e,i),l}(t("./base").Tool);h.prototype.name="Pan",h.prototype.iconName="pan",h.prototype.usesSimpleAPI=!1;var u=h;n.default=u},{"./base":24}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("./base"),r=t("../shapes");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=u(t);if(e){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,t);var e,n,i,o=l(h);function h(){return a(this,h),o.apply(this,arguments)}return e=h,(n=[{key:"begin",value:function(t,e,n,i){this.color=n.getColor("primary"),this.currentShape=this.makeShape(),this.currentShape.addPoint(this.makePoint(t,e,n)),this.lastEventTime=0}},{key:"continue",value:function(t,e,n,i,r){r-this.lastEventTime>this.eventTimeThreshold&&(this.lastEventTime=r,this.currentShape.addPoint(this.makePoint(t,e,n)),n.drawShapeInProgress(this.currentShape))}},{key:"end",value:function(t,e,n,i){this.currentShape.points.length>2&&(this.currentShape.addPoint(this.makePoint(t,e,n)),n.saveShape(this.currentShape)),this.currentShape=void 0}},{key:"makePoint",value:function(t,e,n){return(0,r.createShape)("Point",{x:t,y:e,size:this.strokeWidth,color:this.color})}},{key:"makeShape",value:function(){return(0,r.createShape)("LinePath")}}])&&s(e.prototype,n),i&&s(e,i),h}(i.ToolWithStroke);p.prototype.name="Pencil",p.prototype.iconName="pencil",p.prototype.eventTimeThreshold=25;var f=p;n.default=f},{"../shapes":14,"./base":24}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("../actions"),r=t("./base"),o=t("../shapes");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=f(t);if(e){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return!(t.x<e.x)&&(!(t.y<e.y)&&(!(t.x>e.x+e.width)&&!(t.y>e.y+e.height)))}function g(t,e){t.scale=e<=0?0:e}function m(t,e,n,i,r){(function(t,e,n){if("bottomright"===n){if(t.x>e.x+e.width)return!1;if(t.y>e.y+e.height)return!1}if("bottomleft"===n){if(t.x<e.x)return!1;if(t.y>e.y+e.height)return!1}if("topright"===n){if(t.x>e.x+e.width)return!1;if(t.y<e.y)return!1}if("topleft"===n){if(t.x<e.x)return!1;if(t.y<e.y)return!1}return!0})({x:n,y:i},e,r)&&(t.x=n,t.y=i)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(c,t);var e,n,r,a=u(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=a.call(this)).selectCanvas=document.createElement("canvas"),e.selectCanvas.style["background-color"]="transparent",e.selectCtx=e.selectCanvas.getContext("2d"),e.shiftKeyDown=!1,e.selectedShape=null,e}return e=c,(n=[{key:"_selectKeyDownListener",value:function(t){16===t.keyCode&&(this.shiftKeyDown=!0)}},{key:"_selectKeyUpListener",value:function(t){16===t.keyCode&&(this.shiftKeyDown=!1)}},{key:"_getSelectionShape",value:function(t,e){return null==e&&(e=null),this.selectedShape&&this._isShapeAnImage(this.selectedShape)?(0,o.createShape)("SelectionBox",{shape:this.selectedShape,ctx:this.selectCtx,backgroundColor:e,handleSize:15}):(0,o.createShape)("SelectionBox",{shape:this.selectedShape,ctx:this.selectCtx,backgroundColor:e,handleSize:0})}},{key:"_setShapesInProgress",value:function(t){switch(this.currentShapeState){case"selected":t.setShapesInProgress([this._getSelectionShape(t.ctx),this.selectedShape]);break;case"editing":t.setShapesInProgress([this._getSelectionShape(t.ctx),"#fff"]);break;default:t.setShapesInProgress([this.selectedShape])}}},{key:"_setCurrentShape",value:function(t,e,n){this.selectedShape=e,this.currentShapeState="selected",t.trigger("shapeSelected",{selectedShape:this.selectedShape}),this._setShapesInProgress(t),t.repaintLayer("main");var i=this.selectedShape.getBoundingRect();this.dragOffset={x:n.x-i.x,y:n.y-i.y},document.addEventListener("keydown",this._selectKeyDownListener),document.addEventListener("keyup",this._selectKeyUpListener),t.trigger("shapeChange")}},{key:"_isShapeAnImage",value:function(t){return"ImageWithRotate"===t.className||"Image"===t.className}},{key:"setCurrentShape",value:function(t,e){this.initialShapeBoundingRect=e.getBoundingRect(t.ctx),this.initialShapeScale=e.scale,this._setCurrentShape(t,e,{x:this.initialShapeBoundingRect.x,y:this.initialShapeBoundingRect.y})}},{key:"rotateShape",value:function(t,e){this.selectedShape&&this._isShapeAnImage(this.selectedShape)&&t.execute(new i.RotateAction(t,this.selectedShape,e))}},{key:"_clearCurrentShape",value:function(t){this.selectedShape=null,this.initialShapeBoundingRect=null,this.currentShapeState=null,t.setShapesInProgress([]),t.repaintLayer("main"),document.removeEventListener("keydown",this._selectKeyDownListener),document.removeEventListener("keyup",this._selectKeyUpListener),t.trigger("shapeChange")}},{key:"_getDragAction",value:function(t,e){var n="none",i=this.selectedShape.getBoundingRect(t),r=this._getSelectionShape(this.selectCtx);return d(e,i)&&(n="move"),d(e,r.getBottomRightHandleRect())&&(n="resizeBottomRight"),d(e,r.getTopLeftHandleRect())&&(n="resizeTopLeft"),d(e,r.getBottomLeftHandleRect())&&(n="resizeBottomLeft"),d(e,r.getTopRightHandleRect())&&(n="resizeTopRight"),n}},{key:"didBecomeActive",value:function(t){var e,n,r,a,c,l,h,u,p,f,d,y=this;a=[],c=[],f=function(t){"Delete"===t.code&&l()},document.addEventListener("keyup",f),this.unsubscribe=function(){c.map((function(t){return t()}))},c.push(t.on("pan",(function(e){return y._drawSelectCanvas(t)})),t.on("zoom",(function(e){return y._drawSelectCanvas(t)})),(function(){return document.removeEventListener("keyup",f)})),this._selectShapeUnsubscribe=function(){var t,e,n,i;for(i=[],e=0,n=a.length;e<n;e++)t=a[e],i.push(t());return i},d=this,l=function(){if(d.selectedShape){var e,n=[],r=s(t.shapes);try{for(r.s();!(e=r.n()).done;){var o=e.value;o.id!==d.selectedShape.id&&n.push(o)}}catch(t){r.e(t)}finally{r.f()}t.shapes.length!=n.length&&(t.execute(new i.ClearAction(t,t.shapes,n)),d._clearCurrentShape(t),t.trigger("drawingChange",{}),t.setShapesInProgress([]),t.repaintLayer("main"),d._drawSelectCanvas(t))}},e=function(e){return function(n){var i,r,o={x:n.x,y:n.y};r=e.selectedShape?e._getDragAction(t,o):"none",e.didDrag=!1,null!==(i=e._getPixel(o,t,e.selectCtx))&&"none"===r&&(e.selectedShape?e.selectedShape.id!==t.shapes[i].id&&(e._clearCurrentShape(t),e._setCurrentShape(t,t.shapes[i],o)):e._setCurrentShape(t,t.shapes[i],o)),e.selectedShape&&("selected"!==e.currentShapeState&&"editing"!==e.currentShapeState||(e.dragAction=e._getDragAction(t,o),e.initialShapeBoundingRect=e.selectedShape.getBoundingRect(t.ctx),e.initialShapeScale=e.selectedShape.scale,e.dragOffset={x:o.x-e.initialShapeBoundingRect.x,y:o.y-e.initialShapeBoundingRect.y},"none"===e.dragAction&&e._clearCurrentShape(t)))}}(this),n=function(e){return function(n){if(f=n.x,d=n.y,null!=e.selectedShape){e.didDrag=!0;var i=e.initialShapeBoundingRect,r=i.x+i.width,a=i.y+i.height;if(e._isShapeAnImage(e.selectedShape)){var s,c,l,h,u,p;switch(0===e.selectedShape.rotateAngle||180===e.selectedShape.rotateAngle?(c=e.selectedShape.image.width,s=e.selectedShape.image.height):(c=e.selectedShape.image.height,s=e.selectedShape.image.width),e.dragAction){case"place":e.selectedShape.x=f,e.selectedShape.y=d,e.didDrag=!0;break;case"move":(f-=e.dragOffset.x)<0&&(f=0),(d-=e.dragOffset.y)<0&&(d=0),d+i.height>t.height&&(d=t.height-i.height),f+i.width>t.width&&(f=t.width-i.width),e.selectedShape.setUpperLeft({x:f,y:d}),e.didDrag=!0;break;case"resizeBottomRight":c>s?(l=f-(e.dragOffset.x-i.width)-i.x,g(e.selectedShape,l/c)):(h=d-(e.dragOffset.y-i.height)-i.y,g(e.selectedShape,h/s));break;case"resizeTopLeft":c>s?(l=r-f+e.dragOffset.x,g(e.selectedShape,l/c),h=s*(l/c)):(h=a-d+e.dragOffset.y,g(e.selectedShape,h/s),l=c*(h/s)),u=r-l,p=a-h,m(e.selectedShape,i,u,p,"bottomright"),e.didDrag=!0;break;case"resizeBottomLeft":c>s?(l=r-f+e.dragOffset.x,g(e.selectedShape,l/c),u=f-e.dragOffset.x,p=e.selectedShape.y):(h=d-(e.dragOffset.y-i.height)-i.y,g(e.selectedShape,h/s),u=r-(l=c*(h/s)),p=e.selectedShape.y),m(e.selectedShape,i,u,p,"topright"),e.didDrag=!0;break;case"resizeTopRight":c>s?(l=f-(e.dragOffset.x-i.width)-i.x,g(e.selectedShape,l/c),p=a-(h=s*(l/c)),u=e.selectedShape.x):(h=a-d+e.dragOffset.y,g(e.selectedShape,h/s),p=a-h,u=e.selectedShape.x),m(e.selectedShape,i,u,p,"bottomleft"),e.didDrag=!0}e._setShapesInProgress(t),t.repaintLayer("main")}else{var f,d;(f-=e.dragOffset.x)<0&&(f=0),(d-=e.dragOffset.y)<0&&(d=0),d+i.height>t.height&&(d=t.height-i.height),f+i.width>t.width&&(f=t.width-i.width),e.selectedShape.setUpperLeft({x:f,y:d}),t.setShapesInProgress([e.selectedShape,(0,o.createShape)("SelectionBox",{shape:e.selectedShape,handleSize:0})]),t.repaintLayer("main")}}}}(this),r=function(e){return function(n){if(n.x,n.y,e.didDrag){var r=e.selectedShape;e.didDrag=!1,t.trigger("shapeMoved",{shape:r}),e.currentShapeState="selected";var o=r.getBoundingRect(t.ctx);return o.x===e.initialShapeBoundingRect.x&&o.y===e.initialShapeBoundingRect.y&&r.scale===e.initialShapeScale||t.execute(new i.MoveResizeAction(t,r,{x:e.initialShapeBoundingRect.x,y:e.initialShapeBoundingRect.y},e.initialShapeScale,{x:o.x,y:o.y},r.scale)),t.trigger("drawingChange",{}),e._setShapesInProgress(t),t.repaintLayer("main"),e._drawSelectCanvas(t)}}}(this),h=function(e){return function(n){return e.rotateShape(t,90),t.trigger("drawingChange")}}(this),u=function(e){return function(n){return e.rotateShape(t,-90),t.trigger("drawingChange")}}(this),p=function(e){return function(n){return e._clearCurrentShape(t),t.repaintLayer("main")}}(this),a.push(t.on("lc-pointerdown",e)),a.push(t.on("lc-pointerdrag",n)),a.push(t.on("lc-pointerup",r)),a.push(t.on("snapshotLoad",p)),a.push(t.on("rotate-right",h)),a.push(t.on("rotate-left",u)),this._drawSelectCanvas(t)}},{key:"willBecomeInactive",value:function(t){this._clearCurrentShape(t),this._selectShapeUnsubscribe(),this.unsubscribe(),t.repaintLayer("main")}},{key:"_drawSelectCanvas",value:function(t){var e,n;return this.selectCanvas.width=t.canvas.width,this.selectCanvas.height=t.canvas.height,this.selectCtx.clearRect(0,0,this.selectCanvas.width,this.selectCanvas.height),e=t.shapes.map((n=this,function(t,e){return(0,o.createShape)("SelectionBox",{shape:t,handleSize:0,backgroundColor:"#"+n._intToHex(e)})})),t.draw(e,this.selectCtx)}},{key:"_intToHex",value:function(t){return("000000"+t.toString(16)).slice(-6)}},{key:"_getPixel",value:function(t,e,n){var i=e.drawingCoordsToClientCoords(t.x,t.y),r=e.getPixel(i.x*e.backingScale,i.y*e.backingScale,this.selectCtx);return null!=r&&r[3]?parseInt(this._rgbToHex(r[0],r[1],r[2]),16):null}},{key:"_componentToHex",value:function(t){return("0"+t.toString(16)).slice(-2)}},{key:"_rgbToHex",value:function(t,e,n){return""+this._componentToHex(t)+this._componentToHex(e)+this._componentToHex(n)}}])&&l(e.prototype,n),r&&l(e,r),c}(r.Tool);y.prototype.name="SelectShape",y.prototype.iconName="select",y.prototype.usesSimpleAPI=!1,y.prototype.optionsStyle="rotate";var v=y;n.default=v},{"../actions":5,"../shapes":14,"./base":24}],23:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("./base"),r=t("../shapes"),o=t("../actions");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=u(t);if(e){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t,e){return!(t.x<e.x)&&(!(t.y<e.y)&&(!(t.x>e.x+e.width)&&!(t.y>e.y+e.height)))},f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,t);var e,n,i,a=l(h);function h(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(t=a.call(this)).text="",t.font="bold 18px sans-serif",t.currentShape=null,t.currentShapeState=null,t.initialShapeBoundingRect=null,t.dragAction=null,t.didDrag=!1,t.textSelectedCallback=null,t}return e=h,(n=[{key:"triggerDeletePressed",value:function(){this.deleteSelf()}},{key:"didBecomeActive",value:function(t){var e,n,i,r,a,s;return n=[],a=function(t){"Delete"===t.code&&r()},document.addEventListener("keyup",a),n.push((function(){return document.removeEventListener("keyup",a)})),this.unsubscribe=function(){var t,e,i,r;for(r=[],e=0,i=n.length;e<i;e++)t=n[e],r.push(t());return r},s=this,r=function(){if("editing"!==s.currentShapeState){var e=t.shapes.slice(0,t.shapes.length),n=t.shapes.findIndex((function(t){return t.id===s.currentShape.id}));return n>-1&&e.splice(n,1),t.execute(new o.ClearAction(t,t.shapes,e)),s._clearCurrentShape(t),t.repaintLayer("main"),t.trigger("drawingChange")}},e=function(e){return function(){return e._ensureNotEditing(t),e._clearCurrentShape(t),t.repaintLayer("main")}}(this),i=function(e){return function(){return e._updateInputEl(t)}}(this),n.push(t.on("drawingChange",e)),n.push(t.on("zoom",i)),n.push(t.on("imageSizeChange",i)),n.push(t.on("enf-force-save",function(e){return function(){return e._ensureNotEditing(t),e.commit(t),t.repaintLayer("main")}}(this))),n.push(t.on("snapshotLoad",function(e){return function(){return e._ensureNotEditing(t),e._clearCurrentShape(t),t.repaintLayer("main")}}(this))),n.push(t.on("primaryColorChange",function(e){return function(n){if(e.currentShape)return e.currentShape.color=n,e._updateInputEl(t),t.repaintLayer("main")}}(this))),n.push(t.on("setFont",function(e){return function(n){if(e.currentShape)return e.font=n,e.currentShape.setFont(n),e._setShapesInProgress(t),e._updateInputEl(t),t.repaintLayer("main")}}(this)))}},{key:"willBecomeInactive",value:function(t){return this.currentShape&&(this._ensureNotEditing(t),this.commit(t)),this.unsubscribe()}},{key:"setText",value:function(t){return this.text=t}},{key:"_findShape",value:function(t,e,n){var i=[];return n.shapes.forEach((function(n,r){if("Text"===n.className){var o=n.renderer.metrics.leading*n.renderer.lines.length;p({x:t,y:e},{x:n.x,y:n.y,width:n.renderer.metrics.width,height:o})&&i.push(n)}})),i.length>0?1===i.length?i[0]:i[i.length-1]:null}},{key:"_ensureNotEditing",value:function(t){if("editing"===this.currentShapeState)return this._exitEditingState(t)}},{key:"_clearCurrentShape",value:function(t){this.currentShape=null,this.selectedShape=null,this.initialShapeBoundingRect=null,this.currentShapeState=null,t.setShapesInProgress([])}},{key:"commit",value:function(t){this._ensureNotEditing(t),-1===t.shapes.indexOf(this.currentShape)?this.currentShape&&this.currentShape.text&&t.saveShape(this.currentShape):t.trigger("drawingChange"),this._clearCurrentShape(t),t.repaintLayer("main")}},{key:"_getSelectionShape",value:function(t,e){return null==e&&(e=null),(0,r.createShape)("SelectionBox",{shape:this.currentShape,ctx:t,backgroundColor:e})}},{key:"_setShapesInProgress",value:function(t){switch(this.currentShapeState){case"selected":return t.setShapesInProgress([this._getSelectionShape(t.ctx),this.currentShape]);case"editing":return t.setShapesInProgress([this._getSelectionShape(t.ctx,"#fff")]);default:return t.setShapesInProgress([this.currentShape])}}},{key:"onTextSelected",value:function(t){this.textSelectedCallback=t}},{key:"textSelected",value:function(){this.textSelectedCallback(this.currentShape)}},{key:"begin",value:function(t,e,n){var i,o,a;this.dragAction="none",this.didDrag=!1,"selected"===this.currentShapeState||"editing"===this.currentShapeState?(i=this.currentShape.getBoundingRect(n.ctx),(a=this._getSelectionShape(n.ctx)).getBoundingRect(),p(o={x:t,y:e},i)&&(this.dragAction="move"),p(o,a.getBottomRightHandleRect())&&(this.dragAction="resizeBottomRight"),p(o,a.getTopLeftHandleRect())&&(this.dragAction="resizeTopLeft"),p(o,a.getBottomLeftHandleRect())&&(this.dragAction="resizeBottomLeft"),p(o,a.getTopRightHandleRect())&&(this.dragAction="resizeTopRight"),"none"===this.dragAction&&"editing"===this.currentShapeState&&(this.dragAction="stop-editing",this._exitEditingState(n))):(this.selectedShape=this._findShape(t,e,n),null!==this.selectedShape&&"Text"===this.selectedShape.className?(this.currentShape=this.selectedShape,this.currentShapeState="selected",this.dragAction="move",this.textSelected()):(this.color=n.getColor("primary"),this.currentShape=(0,r.createShape)("Text",{x:t,y:e,text:this.text,color:this.color,font:this.font,v:1,forcedWidth:n.width*n.scale<=n.ctx.canvas.clientWidth?n.width-t-20:n.width-t-(n.width-n.ctx.canvas.clientWidth/n.scale-n.position.x/n.scale/n.backingScale*-1)-20}),this.dragAction="place",this.currentShapeState="selected")),"none"!==this.dragAction?(this.initialShapeBoundingRect=this.currentShape.getBoundingRect(n.ctx),this.dragOffset={x:t-this.initialShapeBoundingRect.x,y:e-this.initialShapeBoundingRect.y},this._setShapesInProgress(n),n.repaintLayer("main")):this.commit(n)}},{key:"continue",value:function(t,e,n){if("none"!==this.dragAction){var i=this.initialShapeBoundingRect,r=i.x+i.width,o=i.y+i.height;switch(this.dragAction){case"place":this.currentShape.x=t,this.currentShape.y=e,this.didDrag=!0;break;case"move":"editing"!==this.currentShapeState&&((t-=this.dragOffset.x)<0&&(t=0),(e-=this.dragOffset.y)<0&&(e=0),e+i.height>n.height&&(e=n.height-i.height),t+i.width>n.width&&(t=n.width-i.width),this.currentShape.x=t,this.currentShape.y=e,this.didDrag=!0);break;case"resizeBottomRight":this.currentShape.setSize(t-(this.dragOffset.x-this.initialShapeBoundingRect.width)-i.x,e-(this.dragOffset.y-this.initialShapeBoundingRect.height)-i.y);break;case"resizeTopLeft":this.currentShape.setSize(r-t+this.dragOffset.x,o-e+this.dragOffset.y),this.currentShape.setPosition(t-this.dragOffset.x,e-this.dragOffset.y);break;case"resizeBottomLeft":this.currentShape.setSize(r-t+this.dragOffset.x,e-(this.dragOffset.y-this.initialShapeBoundingRect.height)-i.y),this.currentShape.setPosition(t-this.dragOffset.x,this.currentShape.y);break;case"resizeTopRight":this.currentShape.setSize(t-(this.dragOffset.x-this.initialShapeBoundingRect.width)-i.x,o-e+this.dragOffset.y),this.currentShape.setPosition(this.currentShape.x,e-this.dragOffset.y)}this._setShapesInProgress(n),n.repaintLayer("main"),this._updateInputEl(n)}}},{key:"end",value:function(t,e,n){this.currentShape&&(this.currentShape.setSize(this.currentShape.forcedWidth,0),"selected"===this.currentShapeState&&("place"===this.dragAction||"move"===this.dragAction&&!this.didDrag)&&this._enterEditingState(n),this._setShapesInProgress(n),n.repaintLayer("main"),this._updateInputEl(n))}},{key:"_enterEditingState",value:function(t){if(this.currentShapeState="editing",this.inputEl)throw"State error";this.inputEl=document.createElement("textarea"),this.inputEl.className="text-tool-input",this.inputEl.style.position="absolute",this.inputEl.style.transformOrigin="0px 0px",this.inputEl.style.backgroundColor="transparent",this.inputEl.style.border="1px solid transparent",this.inputEl.style.outline="none",this.inputEl.style.margin="0",this.inputEl.style.padding="2px 3px",this.inputEl.style.zIndex="1000",this.inputEl.style.overflow="hidden",this.inputEl.style.resize="none",this.inputEl.value=this.currentShape.text,this.inputEl.addEventListener("mousedown",(function(t){t.stopPropagation()})),this.inputEl.addEventListener("mousemove",(function(t){t.stopPropagation()})),this.inputEl.addEventListener("touchstart",(function(t){t.stopPropagation()})),this.inputEl.addEventListener("touchmove",(function(t){t.stopPropagation()}));var e=function(e){return function(n){return e.currentShape.setText(n.target.value),e.currentShape.enforceMaxBoundingRect(t),e._setShapesInProgress(t),t.repaintLayer("main"),e._updateInputEl(t),n.stopPropagation()}}(this);this.inputEl.addEventListener("keydown",function(e){return function(){return e._updateInputEl(t,!0)}}(this)),this.inputEl.addEventListener("input",e),this._updateInputEl(t),t.containerEl.appendChild(this.inputEl),this.inputEl.focus(),this._setShapesInProgress(t)}},{key:"_exitEditingState",value:function(t){this.currentShapeState="selected",t.containerEl.removeChild(this.inputEl),this.inputEl=null,this._setShapesInProgress(t),t.repaintLayer("main")}},{key:"_updateInputEl",value:function(t,e){if(null==e&&(e=!1),this.inputEl){var n=this.currentShape.getBoundingRect(t.ctx,!0);this.inputEl.style.font=this.currentShape.font,this.inputEl.style.color=this.currentShape.color,this.inputEl.style.left=t.position.x/t.backingScale+n.x*t.scale-4+"px",this.inputEl.style.top=t.position.y/t.backingScale+n.y*t.scale-4+"px",e&&!this.currentShape.forcedWidth?this.inputEl.style.width=n.width+10+this.currentShape.renderer.emDashWidth+"px":this.inputEl.style.width=n.width+12+"px",this.inputEl.style.height=e?n.height+10+this.currentShape.renderer.metrics.leading+"px":n.height+10+"px";var i="scale("+t.scale+")";this.inputEl.style.transform=i,this.inputEl.style.webkitTransform=i,this.inputEl.style.MozTransform=i,this.inputEl.style.msTransform=i,this.inputEl.style.OTransform=i}}}])&&s(e.prototype,n),i&&s(e,i),h}(i.Tool);f.prototype.name="Text",f.prototype.iconName="text",f.prototype.optionsStyle="custom-font";var d=f;n.default=d},{"../actions":5,"../shapes":14,"./base":24}],24:[function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=s(t);if(e){var r=s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return a(this,n)}}function a(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}Object.defineProperty(n,"__esModule",{value:!0}),n.ToolWithStroke=n.Tool=void 0;var u=function(){function t(){c(this,t)}return h(t,[{key:"begin",value:function(t,e,n,i){}},{key:"continue",value:function(t,e,n,i){}},{key:"end",value:function(t,e,n,i){}},{key:"didBecomeActive",value:function(t){}},{key:"willBecomeInactive",value:function(t){}}]),t}();n.Tool=u,u.prototype.name=null,u.prototype.iconName=null,u.prototype.usesSimpleAPI=!0,u.prototype.optionsStyle=null;var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(n,t);var e=o(n);function n(t){var i;return c(this,n),(i=e.call(this)).strokeWidth=t.opts.defaultStrokeWidth,i}return h(n,[{key:"didBecomeActive",value:function(t){var e=this,n=[];this.unsubscribe=function(){n.map((function(t){return t()}))},n.push(t.on("setStrokeWidth",(function(n){e.strokeWidth=n,t.trigger("toolDidUpdateOptions")})))}},{key:"willBecomeInactive",value:function(t){this.unsubscribe()}}]),n}(u);n.ToolWithStroke=p,p.prototype.optionsStyle="stroke-width"},{}],25:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.addImageOnload=function(t,e){var n=t.onload;return t.onload=function(){"function"==typeof n&&n(),e()},t},n.last=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?Array.prototype.slice.call(t,Math.max(t.length-e,0)):t[t.length-1]},n.classSet=function(t){var e=[];for(var n in t)t[n]&&e.push(n);return e.join(" ")},n.matchElementSize=function(t,e,n,i){null==i&&(i=function(){});var r=function(){var r,a=o(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.style.width="".concat(t.offsetWidth,"px"),s.style.height="".concat(t.offsetHeight,"px"),null!=s.width&&(s.setAttribute("width",s.offsetWidth*n),s.setAttribute("height",s.offsetHeight*n))}}catch(t){a.e(t)}finally{a.f()}i()};return t.addEventListener("resize",r),window.addEventListener("resize",r),window.addEventListener("orientationchange",r),r(),r},n.combineCanvases=function(){for(var t=document.createElement("canvas"),e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.width=n[0].width,t.height=n[0].height;for(var r=0,o=n;r<o.length;r++){var a=o[r];t.width=Math.max(a.width,t.width),t.height=Math.max(a.height,t.height)}for(var s=t.getContext("2d"),c=0,l=n;c<l.length;c++)a=l[c],s.drawImage(a,0,0);return t},n.renderShapes=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null==n&&(n=1);(r=r||document.createElement("canvas")).width=e.width*n,r.height=e.height*n;var a=r.getContext("2d");a.translate(-e.x*n,-e.y*n),a.scale(n,n);var s,c=o(t);try{for(c.s();!(s=c.n()).done;){var l=s.value;(0,i.renderShapeToContext)(a,l)}}catch(t){c.e(t)}finally{c.f()}return r},n.renderShapesToSVG=function(t,e,n){var i=e.x,o=e.y,a=e.width,s=e.height;return"<svg xmlns='http://www.w3.org/2000/svg' width='".concat(a,"' height='").concat(s,"' viewBox='0 0 ").concat(a," ").concat(s,"'> <rect width='").concat(a,"' height='").concat(s,"' x='0' y='0' fill='").concat(n,"' /> <g transform='translate(").concat(-i,", ").concat(-o,")'> ").concat(t.map((function(t){return(0,r.renderShapeToSVG)(t)})).join("")," </g> </svg>").replace(/(\r\n|\n|\r)/gm,"")},n.getBoundingRect=s,n.getDefaultImageRect=function(t,e,n){null==e&&(e={width:0,height:0});null==n&&(n={top:0,right:0,bottom:0,left:0});var i=e,r=i.width,o=i.height,a=s(t,"infinite"===r?0:r,"infinite"===o?0:o);return a.x-=n.left,a.y-=n.top,a.width+=n.left+n.right,a.height+=n.top+n.bottom,a},n.getBackingScale=function(t){if(!window.devicePixelRatio||window.devicePixelRatio<2)return 2;return window.devicePixelRatio},n.getGUID=function(){
/**
  * Fast UUID generator, RFC4122 version 4 compliant.
  * @author Jeff Ward (jcward.com).
  * @license MIT license
  * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
  **/
var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return c[255&t]+c[t>>8&255]+c[t>>16&255]+c[t>>24&255]+"-"+c[255&e]+c[e>>8&255]+"-"+c[e>>16&15|64]+c[e>>24&255]+"-"+c[63&n|128]+c[n>>8&255]+"-"+c[n>>16&255]+c[n>>24&255]+c[255&i]+c[i>>8&255]+c[i>>16&255]+c[i>>24&255]},n.requestAnimationFrame=function(t){if(window.requestAnimationFrame)return window.requestAnimationFrame(t);if(window.webkitRequestAnimationFrame)return window.webkitRequestAnimationFrame(t);if(window.mozRequestAnimationFrame)return window.mozRequestAnimationFrame(t);return setTimeout(t,0)},n.cancelAnimationFrame=function(t){window.cancelAnimationFrame&&window.cancelAnimationFrame(t);window.webkitCancelRequestAnimationFrame&&window.webkitCancelRequestAnimationFrame(t);window.webkitCancelAnimationFrame&&window.webkitCancelAnimationFrame(t);window.mozCancelAnimationFrame&&window.mozCancelAnimationFrame(t);clearTimeout(t)},n.mouseEventButtons=n.mouseEventButton=void 0;var i=t("./canvasRenderer"),r=t("./svgRenderer");function o(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s(t,e,n){if(!t.length)return{x:0,y:0,width:e,height:n};var i,r=t[0].x,a=t[0].y,s=t[0].x+t[0].width,c=t[0].y+t[0].height,l=o(t);try{for(l.s();!(i=l.n()).done;){var h=i.value;r=Math.floor(Math.min(h.x,r)),a=Math.floor(Math.min(h.y,a)),s=Math.ceil(Math.max(s,h.x+h.width)),c=Math.ceil(Math.max(c,h.y+h.height))}}catch(t){l.e(t)}finally{l.f()}return{x:r=e?0:r,y:a=n?0:a,width:(s=e||s)-r,height:(c=n||c)-a}}for(var c=[],l=0;l<256;l++)c[l]=(l<16?"0":"")+l.toString(16);var h=Object.freeze({ERASER:5});n.mouseEventButton=h;var u=Object.freeze({ERASER:32});n.mouseEventButtons=u},{"./canvasRenderer":7,"./svgRenderer":15}],26:[function(t,e,n){var i,r,o,a,s,c,l,h,u,p,f,d,g,m,y,v,S,b,x,w,k,C,O,R,I,T,P,_,E,M,L,A,B,N;({default:c}=t("./core/LiterallyCanvas")),({default:y}=t("./core/defaultOptions")),({defineCanvasRenderer:S,renderShapeToCanvas:R,renderShapeToContext:I}=t("./core/canvasRenderer")),({defineSVGRenderer:x,renderShapeToSVG:T}=t("./core/svgRenderer")),({defineShape:w,createShape:m,JSONToShape:a,shapeToJSON:A}=t("./core/shapes")),({renderShapes:P,renderShapesToSVG:_}=t("./core/util")),({default:E}=t("./core/renderSnapshotToImage")),({default:M}=t("./core/renderSnapshotToSVG")),N=t("./core/util"),({localize:C}=t("./core/localization")),l=t("./reactGUI/LiterallyCanvas"),t("./reactGUI/initDOM"),t("./optionsStyles/font"),t("./optionsStyles/stroke-width"),t("./optionsStyles/line-options-and-stroke-width"),t("./optionsStyles/polygon-and-stroke-width"),t("./optionsStyles/stroke-or-fill"),t("./optionsStyles/null"),t("./optionsStyles/custom-font"),t("./optionsStyles/custom-font-with-fields-options"),t("./optionsStyles/image-options"),({defineOptionsStyle:b}=t("./optionsStyles/optionsStyles")),g={snapshotToShapes:function(t){var e,n,i,r,o;for(r=[],e=0,n=(i=t.shapes).length;e<n;e++)o=i[e],r.push(shapes.JSONToShape(o));return r},snapshotJSONToShapes:function(t){return g.snapshotToShapes(JSON.parse(t))}},({default:u}=t("./core/tools/Pencil")),({default:f}=t("./core/tools/Text")),({default:o}=t("./core/tools/EraserOld")),({default:s}=t("./core/tools/Line")),({default:h}=t("./core/tools/Pan")),({default:r}=t("./core/tools/Eraser")),({default:p}=t("./core/tools/SelectShape")),({default:i}=t("./core/tools/CustomTextWithFields")),B={Pencil:u,EraserOld:o,Line:s,Text:f,Pan:h,Eraser:r,SelectShape:p,Tool:(d=t("./core/tools/base")).Tool,ToolWithStroke:d.ToolWithStroke,CustomTextWithFields:i},v=y.tools,y.imageURLPrefix,L=function(t){return t,y.imageURLPrefix=t},k=function(e,n={}){var i,r,o,a,s;for(a in y)a in n||(n[a]=y[a]);for(r=0,o=(s=e.children).length;r<o;r++)i=s[r],e.removeChild(i);return t("./reactGUI/initDOM")(e,n)},O=function(t){return t.fn.literallycanvas=function(t={}){return this.each(((e,n)=>n.literallycanvas=k(n,t))),this}},"undefined"!=typeof window&&(window.LC={init:k},window.$&&O(window.$)),e.exports={init:k,registerJQueryPlugin:O,util:N,tools:B,setDefaultImageURLPrefix:L,defaultTools:v,defineOptionsStyle:b,LiterallyCanvasReactComponent:l,defineShape:w,createShape:m,JSONToShape:a,shapeToJSON:A,defineCanvasRenderer:S,renderShapeToContext:I,renderShapeToCanvas:R,renderShapesToCanvas:P,defineSVGRenderer:x,renderShapeToSVG:T,renderShapesToSVG:_,snapshotToShapes:g.snapshotToShapes,snapshotJSONToShapes:g.snapshotJSONToShapes,renderSnapshotToImage:E,renderSnapshotToSVG:M,localize:C}},{"./core/LiterallyCanvas":3,"./core/canvasRenderer":7,"./core/defaultOptions":8,"./core/localization":11,"./core/renderSnapshotToImage":12,"./core/renderSnapshotToSVG":13,"./core/shapes":14,"./core/svgRenderer":15,"./core/tools/CustomTextWithFields":16,"./core/tools/Eraser":17,"./core/tools/EraserOld":18,"./core/tools/Line":19,"./core/tools/Pan":20,"./core/tools/Pencil":21,"./core/tools/SelectShape":22,"./core/tools/Text":23,"./core/tools/base":24,"./core/util":25,"./optionsStyles/custom-font":28,"./optionsStyles/custom-font-with-fields-options":27,"./optionsStyles/font":29,"./optionsStyles/image-options":30,"./optionsStyles/line-options-and-stroke-width":31,"./optionsStyles/null":32,"./optionsStyles/optionsStyles":33,"./optionsStyles/polygon-and-stroke-width":34,"./optionsStyles/stroke-or-fill":35,"./optionsStyles/stroke-width":36,"./reactGUI/LiterallyCanvas":39,"./reactGUI/initDOM":51}],27:[function(t,e,n){"use strict";s(t("../reactGUI/React-shim"));var i=s(t("../reactGUI/ReactDOMFactories-shim")),r=s(t("../reactGUI/createReactClass-shim")),o=t("./optionsStyles"),a=(t("../reactGUI/createSetStateOnEventMixin"),t("../core/util"),t("../core/localization"));function s(t){return t&&t.__esModule?t:{default:t}}for(var c=[["Arial",'Arial,"Helvetica Neue",Helvetica,sans-serif'],["Arial Black",'"Arial Black","Arial Bold",Gadget,sans-serif'],["Arial Narrow",'"Arial Narrow",Arial,sans-serif'],["Gill Sans",'"Gill Sans","Gill Sans MT",Calibri,sans-serif'],["Helvetica",'"Helvetica Neue",Helvetica,Arial,sans-serif'],["Impact",'Impact,Haettenschweiler,"Franklin Gothic Bold",Charcoal,"Helvetica Inserat","Bitstream Vera Sans Bold","Arial Black",sans-serif'],["Tahoma","Tahoma,Verdana,Segoe,sans-serif"],["Trebuchet MS",'"Trebuchet MS","Lucida Grande","Lucida Sans Unicode","Lucida Sans",Tahoma,sans-serif'],["Verdana","Verdana,Geneva,sans-serif"]].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),l=[["Baskerville",'Baskerville,"Baskerville Old Face","Hoefler Text",Garamond,"Times New Roman",serif'],["Garamond",'Garamond,Baskerville,"Baskerville Old Face","Hoefler Text","Times New Roman",serif'],["Georgia",'Georgia,Times,"Times New Roman",serif'],["Hoefler Text",'"Hoefler Text","Baskerville Old Face",Garamond,"Times New Roman",serif'],["Lucida Bright",'"Lucida Bright",Georgia,serif'],["Palatino",'Palatino,"Palatino Linotype","Palatino LT STD","Book Antiqua",Georgia,serif'],["Times New Roman",'TimesNewRoman,"Times New Roman",Times,Baskerville,Georgia,serif']].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),h=[["Consolas/Monaco",'Consolas,monaco,"Lucida Console",monospace'],["Courier New",'"Courier New",Courier,"Lucida Sans Typewriter","Lucida Typewriter",monospace'],["Lucida Sans Typewriter",'"Lucida Sans Typewriter","Lucida Console",monaco,"Bitstream Vera Sans Mono",monospace']].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),u=[["Copperplate",'Copperplate,"Copperplate Gothic Light",fantasy'],["Papyrus","Papyrus,fantasy"],["Script",'"Brush Script MT",cursive']].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),p=[[(0,a._)("Sans Serif"),c],[(0,a._)("Serif"),l],[(0,a._)("Monospace"),h],[(0,a._)("Other"),u]],f={},d={},g=0,m=c.length;g<m;g++){var y=c[g],v=y.name,S=y.value;f[v]=S,d[S]=v}for(var b=0,x=l.length;b<x;b++){var w=l[b];v=w.name,S=w.value;f[v]=S,d[S]=v}for(var k=0,C=h.length;k<C;k++){var O=h[k];v=O.name,S=O.value;f[v]=S,d[S]=v}for(var R=0,I=u.length;R<I;R++){var T=u[R];v=T.name,S=T.value;f[v]=S,d[S]=v}var P=(0,r.default)({displayName:"FontOptions",getInitialState:function(){var t=this.extractDefaultTemplateOptions();return this.props.tool&&this.props.tool.onTextSelected&&this.props.tool.onTextSelected(this.textSelected),{tool:this.props.tool||null,isItalic:!1,isBold:!1,fontName:"Helvetica",fontSizeIndex:4,templateOptions:this.props.tool.fieldOptions,templateOption:t}},extractDefaultTemplateOptions:function(){var t=Object.keys(this.props.tool.fieldOptions)[0],e=this.props.tool.fieldOptions[t];return t+"."+Object.keys(e)[0]},textSelected:function(t){var e=t.font.match(/italic/);e&&e[0]&&this.setState({isItalic:!0});var n=t.font.match(/bold/);n&&n[0]&&this.setState({isBold:!0});var i=t.font.match(/([^ ]*"[^"]*".*)*$/),r=d[i[0]];r&&this.setState({fontName:r});var o=t.font.match(/([0-9]+)px+/),a=this.getFontSizes().indexOf(parseInt(o[1]));-1!==a&&this.setState({fontSizeIndex:a})},getFontSizes:function(){return[9,10,12,14,18,24,36,48,64,72,96,144,288]},updateTool:function(t){var e,n,i;for(i in null==t&&(t={}),this.state)i in t||(t[i]=this.state[i]);return e=this.getFontSizes()[t.fontSizeIndex],n=[],t.isItalic&&n.push("italic"),t.isBold&&n.push("bold"),n.push(e+"px"),n.push(f[t.fontName]),this.props.lc.tool.font=n.join(" "),this.props.lc.trigger("setFont",n.join(" "))},handleTemplateOptionChange:function(t){var e;return e={templateOption:t.target.value},this.setState(e),this.updateTool(e)},handleTemplateOptionInsert:function(){var t=this.state.templateOption.split(".");this.state.tool.insertTemplateText("{"+this.state.templateOptions[t[0]][t[1]].key+"}")},handleFontSize:function(t){var e;return e={fontSizeIndex:t.target.value},this.setState(e),this.updateTool(e)},handleFontFamily:function(t){var e;return e={fontName:t.target.selectedOptions[0].innerHTML},this.setState(e),this.updateTool(e)},handleItalic:function(t){var e;return e={isItalic:!this.state.isItalic},this.setState(e),this.updateTool(e)},handleBold:function(t){var e;return e={isBold:!this.state.isBold},this.setState(e),this.updateTool(e)},componentDidMount:function(){return this.updateTool()},render:function(){var t,e,n,r,o,s,c,l,h,u;return this.props.lc,t=(s=i.default).div,e=s.input,c=s.select,o=s.option,s.br,n=s.label,l=s.span,r=s.optgroup,h=s.button,t({className:"lc-font-settings"},c({value:this.state.fontName,style:{width:"150px"},onChange:this.handleFontFamily},p.map((function(t){var e,n;return n=t[0],e=t[1],r({key:n,label:n},e.map((function(t,e){return o({value:t.name,key:e},t.name)})))}))),c({value:this.state.fontSizeIndex,onChange:this.handleFontSize},this.getFontSizes().map((function(t,e){return o({value:e,key:e},t)}))),l({},e({type:"checkbox",id:"italic",checked:this.state.isItalic,onChange:this.handleItalic}),n({htmlFor:"italic"},(0,a._)("italic"))),l({},e({type:"checkbox",id:"bold",checked:this.state.isBold,onChange:this.handleBold}),n({htmlFor:"bold"},(0,a._)("bold"))),c({value:this.state.templateOption,onChange:this.handleTemplateOptionChange},Object.keys(this.state.templateOptions).map((u=this,function(t){return r({key:t,label:t},Object.keys(u.state.templateOptions[t]).map((function(e){var n=u.state.templateOptions[t][e];return o({value:t+"."+e,key:t+"."+e},n.displayName)})))}))),h({onClick:this.handleTemplateOptionInsert,className:"btn btn-default",style:{padding:"0px 5px",height:"30px",margin:"0px 5px"}},"Insert"))}});(0,o.defineOptionsStyle)("font-with-fields",P),e.exports={}},{"../core/localization":11,"../core/util":25,"../reactGUI/React-shim":42,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49,"./optionsStyles":33}],28:[function(t,e,n){"use strict";s(t("../reactGUI/React-shim"));var i=s(t("../reactGUI/ReactDOMFactories-shim")),r=s(t("../reactGUI/createReactClass-shim")),o=t("./optionsStyles"),a=(t("../reactGUI/createSetStateOnEventMixin"),t("../core/util"),t("../core/localization"));function s(t){return t&&t.__esModule?t:{default:t}}for(var c=[["Arial",'Arial,"Helvetica Neue",Helvetica,sans-serif'],["Arial Black",'"Arial Black","Arial Bold",Gadget,sans-serif'],["Arial Narrow",'"Arial Narrow",Arial,sans-serif'],["Gill Sans",'"Gill Sans","Gill Sans MT",Calibri,sans-serif'],["Helvetica",'"Helvetica Neue",Helvetica,Arial,sans-serif'],["Impact",'Impact,Haettenschweiler,"Franklin Gothic Bold",Charcoal,"Helvetica Inserat","Bitstream Vera Sans Bold","Arial Black",sans-serif'],["Tahoma","Tahoma,Verdana,Segoe,sans-serif"],["Trebuchet MS",'"Trebuchet MS","Lucida Grande","Lucida Sans Unicode","Lucida Sans",Tahoma,sans-serif'],["Verdana","Verdana,Geneva,sans-serif"]].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),l=[["Baskerville",'Baskerville,"Baskerville Old Face","Hoefler Text",Garamond,"Times New Roman",serif'],["Garamond",'Garamond,Baskerville,"Baskerville Old Face","Hoefler Text","Times New Roman",serif'],["Georgia",'Georgia,Times,"Times New Roman",serif'],["Hoefler Text",'"Hoefler Text","Baskerville Old Face",Garamond,"Times New Roman",serif'],["Lucida Bright",'"Lucida Bright",Georgia,serif'],["Palatino",'Palatino,"Palatino Linotype","Palatino LT STD","Book Antiqua",Georgia,serif'],["Times New Roman",'TimesNewRoman,"Times New Roman",Times,Baskerville,Georgia,serif']].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),h=[["Consolas/Monaco",'Consolas,monaco,"Lucida Console",monospace'],["Courier New",'"Courier New",Courier,"Lucida Sans Typewriter","Lucida Typewriter",monospace'],["Lucida Sans Typewriter",'"Lucida Sans Typewriter","Lucida Console",monaco,"Bitstream Vera Sans Mono",monospace']].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),u=[["Copperplate",'Copperplate,"Copperplate Gothic Light",fantasy'],["Papyrus","Papyrus,fantasy"],["Script",'"Brush Script MT",cursive']].map((function(t){var e,n;return e=t[0],n=t[1],{name:(0,a._)(e),value:n}})),p=[[(0,a._)("Sans Serif"),c],[(0,a._)("Serif"),l],[(0,a._)("Monospace"),h],[(0,a._)("Other"),u]],f={},d={},g=0,m=c.length;g<m;g++){var y=c[g],v=y.name,S=y.value;f[v]=S,d[S]=v}for(var b=0,x=l.length;b<x;b++){var w=l[b];v=w.name,S=w.value;f[v]=S,d[S]=v}for(var k=0,C=h.length;k<C;k++){var O=h[k];v=O.name,S=O.value;f[v]=S,d[S]=v}for(var R=0,I=u.length;R<I;R++){var T=u[R];v=T.name,S=T.value;f[v]=S,d[S]=v}var P=(0,r.default)({displayName:"FontOptions",getInitialState:function(){return this.props.tool&&this.props.tool.onTextSelected&&this.props.tool.onTextSelected(this.textSelected),{tool:this.props.tool||null,isItalic:!1,isBold:!1,fontName:"Helvetica",fontSizeIndex:2}},textSelected:function(t){var e=t.font.match(/italic/);e&&e[0]&&this.setState({isItalic:!0});var n=t.font.match(/bold/);n&&n[0]&&this.setState({isBold:!0});var i=t.font.match(/([^ ]*"[^"]*".*)*$/),r=d[i[0]];r&&this.setState({fontName:r});var o=t.font.match(/([0-9]+)px+/),a=this.getFontSizes().indexOf(parseInt(o[1]));-1!==a&&this.setState({fontSizeIndex:a})},getFontSizes:function(){return[9,10,12,14,18,24,36,48,64,72,96,144,288]},updateTool:function(t){var e,n,i;for(i in null==t&&(t={}),this.state)i in t||(t[i]=this.state[i]);return e=this.getFontSizes()[t.fontSizeIndex],n=[],t.isItalic&&n.push("italic"),t.isBold&&n.push("bold"),n.push(e+"px"),n.push(f[t.fontName]),this.props.lc.tool.font=n.join(" "),this.props.lc.trigger("setFont",n.join(" "))},handleFontSize:function(t){var e;return e={fontSizeIndex:t.target.value},this.setState(e),this.updateTool(e)},handleFontFamily:function(t){var e;return e={fontName:t.target.selectedOptions[0].innerHTML},this.setState(e),this.updateTool(e)},handleItalic:function(t){var e;return e={isItalic:!this.state.isItalic},this.setState(e),this.updateTool(e)},handleBold:function(t){var e;return e={isBold:!this.state.isBold},this.setState(e),this.updateTool(e)},componentDidMount:function(){return this.updateTool()},render:function(){var t,e,n,r,o,s,c,l;return this.props.lc,t=(s=i.default).div,e=s.input,c=s.select,o=s.option,s.br,n=s.label,l=s.span,r=s.optgroup,t({className:"lc-font-settings"},c({value:this.state.fontName,onChange:this.handleFontFamily,className:"hidden-xs"},p.map((function(t){var e,n;return n=t[0],e=t[1],r({key:n,label:n},e.map((function(t,e){return o({value:t.name,key:e},t.name)})))}))),c({value:this.state.fontSizeIndex,onChange:this.handleFontSize,className:"hidden-xs"},this.getFontSizes().map((function(t,e){return o({value:e,key:e},t)}))),l({},e({type:"checkbox",id:"italic",className:"hidden-xs",checked:this.state.isItalic,onChange:this.handleItalic}),n({htmlFor:"italic",className:"hidden-xs"},(0,a._)("italic"))),l({},e({type:"checkbox",id:"bold",className:"hidden-xs",checked:this.state.isBold,onChange:this.handleBold}),n({htmlFor:"bold",className:"hidden-xs"},(0,a._)("bold"))))}});(0,o.defineOptionsStyle)("custom-font",P),e.exports={}},{"../core/localization":11,"../core/util":25,"../reactGUI/React-shim":42,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49,"./optionsStyles":33}],29:[function(t,e,n){var i,r,o,a,s,c,l,h,u,p,f,d,g,m,y,v,S,b,x,w;for(r=t("../reactGUI/ReactDOMFactories-shim"),u=t("../reactGUI/createReactClass-shim"),({defineOptionsStyle:p}=t("./optionsStyles")),({_:h}=t("../core/localization")),c=[["Arial",'Arial,"Helvetica Neue",Helvetica,sans-serif'],["Arial Black",'"Arial Black","Arial Bold",Gadget,sans-serif'],["Arial Narrow",'"Arial Narrow",Arial,sans-serif'],["Gill Sans",'"Gill Sans","Gill Sans MT",Calibri,sans-serif'],["Helvetica",'"Helvetica Neue",Helvetica,Arial,sans-serif'],["Impact",'Impact,Haettenschweiler,"Franklin Gothic Bold",Charcoal,"Helvetica Inserat","Bitstream Vera Sans Bold","Arial Black",sans-serif'],["Tahoma","Tahoma,Verdana,Segoe,sans-serif"],["Trebuchet MS",'"Trebuchet MS","Lucida Grande","Lucida Sans Unicode","Lucida Sans",Tahoma,sans-serif'],["Verdana","Verdana,Geneva,sans-serif"]].map((function([t,e]){return{name:h(t),value:e}})),l=[["Baskerville",'Baskerville,"Baskerville Old Face","Hoefler Text",Garamond,"Times New Roman",serif'],["Garamond",'Garamond,Baskerville,"Baskerville Old Face","Hoefler Text","Times New Roman",serif'],["Georgia",'Georgia,Times,"Times New Roman",serif'],["Hoefler Text",'"Hoefler Text","Baskerville Old Face",Garamond,"Times New Roman",serif'],["Lucida Bright",'"Lucida Bright",Georgia,serif'],["Palatino",'Palatino,"Palatino Linotype","Palatino LT STD","Book Antiqua",Georgia,serif'],["Times New Roman",'TimesNewRoman,"Times New Roman",Times,Baskerville,Georgia,serif']].map((function([t,e]){return{name:h(t),value:e}})),a=[["Consolas/Monaco",'Consolas,monaco,"Lucida Console",monospace'],["Courier New",'"Courier New",Courier,"Lucida Sans Typewriter","Lucida Typewriter",monospace'],["Lucida Sans Typewriter",'"Lucida Sans Typewriter","Lucida Console",monaco,"Bitstream Vera Sans Mono",monospace']].map((function([t,e]){return{name:h(t),value:e}})),s=[["Copperplate",'Copperplate,"Copperplate Gothic Light",fantasy'],["Papyrus","Papyrus,fantasy"],["Script",'"Brush Script MT",cursive']].map((function([t,e]){return{name:h(t),value:e}})),i=[[h("Sans Serif"),c],[h("Serif"),l],[h("Monospace"),a],[h("Other"),s]],o={},f=0,m=c.length;f<m;f++)({name:x,value:w}=c[f]),o[x]=w;for(d=0,y=l.length;d<y;d++)({name:x,value:w}=l[d]),o[x]=w;for(g=0,v=a.length;g<v;g++)({name:x,value:w}=a[g]),o[x]=w;for(b=0,S=s.length;b<S;b++)({name:x,value:w}=s[b]),o[x]=w;p("font",u({displayName:"FontOptions",getInitialState:function(){return{isItalic:!1,isBold:!1,fontName:"Helvetica",fontSizeIndex:4}},getFontSizes:function(){return[9,10,12,14,18,24,36,48,64,72,96,144,288]},updateTool:function(t={}){var e,n,i;for(i in this.state)i in t||(t[i]=this.state[i]);return e=this.getFontSizes()[t.fontSizeIndex],n=[],t.isItalic&&n.push("italic"),t.isBold&&n.push("bold"),n.push(`${e}px`),n.push(o[t.fontName]),this.props.lc.tool.font=n.join(" "),this.props.lc.trigger("setFont",n.join(" "))},handleFontSize:function(t){var e;return e={fontSizeIndex:t.target.value},this.setState(e),this.updateTool(e)},handleFontFamily:function(t){var e;return e={fontName:t.target.selectedOptions[0].innerHTML},this.setState(e),this.updateTool(e)},handleItalic:function(t){var e;return e={isItalic:!this.state.isItalic},this.setState(e),this.updateTool(e)},handleBold:function(t){var e;return e={isBold:!this.state.isBold},this.setState(e),this.updateTool(e)},componentDidMount:function(){return this.updateTool()},render:function(){var t,e,n,o,a,s,c,l;return this.props.lc,({div:e,input:n,select:c,option:s,br:t,label:o,span:l,optgroup:a}=r),e({className:"lc-font-settings"},c({value:this.state.fontSizeIndex,onChange:this.handleFontSize},this.getFontSizes().map(((t,e)=>s({value:e,key:e},`${t}px`)))),c({value:this.state.fontName,onChange:this.handleFontFamily},i.map((([t,e])=>a({key:t,label:t},e.map((function(t,e){return s({value:t.name,key:e},t.name)})))))),l({},o({htmlFor:"italic"},h("italic")),n({type:"checkbox",id:"italic",checked:this.state.isItalic,onChange:this.handleItalic})),l({},o({htmlFor:"bold"},h("bold")),n({type:"checkbox",id:"bold",checked:this.state.isBold,onChange:this.handleBold})))}})),e.exports={}},{"../core/localization":11,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./optionsStyles":33}],30:[function(t,e,n){"use strict";s(t("../reactGUI/React-shim"));var i=s(t("../reactGUI/ReactDOMFactories-shim")),r=s(t("../reactGUI/createReactClass-shim")),o=t("./optionsStyles"),a=(t("../reactGUI/createSetStateOnEventMixin"),t("../core/util"));function s(t){return t&&t.__esModule?t:{default:t}}var c,l=(0,r.default)({displayName:"RotateOptions",getState:function(t){return null===t&&(t=this.props.tool),{tool:t}},getInitialState:function(){return this.getState()},componentWillReceiveProps:function(t){return this.setState(this.getState(t.tool))},mixins:[(c="shapeChange",{componentDidMount:function(){return this.unsubscribe=this.props.lc.on(c,(t=this,function(){t.setState(t.getState()),t.render()}));var t},componentWillUnmount:function(){return this.unsubscribe()}})],render:function(){var t,e;e=i.default,t=e.div;var n;return!this.props.tool.selectedShape||this.props.tool.selectedShape&&"ImageWithRotate"!==this.props.tool.selectedShape.className&&"Image"!==this.props.tool.selectedShape.className?null:t({},["fa-rotate-left","fa-rotate-right"].map((n=this,function(e){var i;return i=(0,a.classSet)({fa:!0,"square-toolbar-button":!0,"fa-rotate-left":"fa-rotate-left"===e,"fa-rotate-right":"fa-rotate-right"===e}),t({key:e},t({className:i,title:"fa-rotate-left"===e?"Rotate Left":"Rotate Right",onClick:function(){var t="fa-rotate-left"===e?"rotate-left":"rotate-right";return n.props.lc.trigger(t)}}))})))}});(0,o.defineOptionsStyle)("rotate",l),e.exports={}},{"../core/util":25,"../reactGUI/React-shim":42,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49,"./optionsStyles":33}],31:[function(t,e,n){var i,r,o,a,s,c,l;r=t("../reactGUI/React-shim"),i=t("../reactGUI/ReactDOMFactories-shim"),s=t("../reactGUI/createReactClass-shim"),({defineOptionsStyle:l}=t("./optionsStyles")),o=r.createFactory(t("../reactGUI/StrokeWidthPicker")),c=t("../reactGUI/createSetStateOnEventMixin"),({classSet:a}=t("../core/util")),l("line-options-and-stroke-width",s({displayName:"LineOptionsAndStrokeWidth",getState:function(){return{strokeWidth:this.props.tool.strokeWidth,isDashed:this.props.tool.isDashed,hasEndArrow:this.props.tool.hasEndArrow}},getInitialState:function(){return this.getState()},mixins:[c("toolChange")],render:function(){var t,e,n,r,s,c,l,h,u;return({div:n,ul:u,li:s,img:r}=i),l=()=>(this.props.tool.isDashed=!this.props.tool.isDashed,this.setState(this.getState())),h=()=>(this.props.tool.hasEndArrow=!this.props.tool.hasEndArrow,this.setState(this.getState())),e=a({"square-toolbar-button":!0,selected:this.state.isDashed,"hidden-xs":!0}),t=a({"square-toolbar-button":!0,selected:this.state.hasEndArrow,"hidden-xs":!0}),n({},n({className:e,onClick:l,style:c={float:"left",margin:1}},r({src:`${this.props.imageURLPrefix}/dashed-line.png`})),n({className:t,onClick:h,style:c},r({src:`${this.props.imageURLPrefix}/line-with-arrow.png`})),o({tool:this.props.tool,lc:this.props.lc}))}})),e.exports={}},{"../core/util":25,"../reactGUI/React-shim":42,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/StrokeWidthPicker":45,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49,"./optionsStyles":33}],32:[function(t,e,n){var i,r,o;i=t("../reactGUI/ReactDOMFactories-shim"),r=t("../reactGUI/createReactClass-shim"),({defineOptionsStyle:o}=t("./optionsStyles")),o("null",r({displayName:"NoOptions",render:function(){return i.div()}})),e.exports={}},{"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./optionsStyles":33}],33:[function(t,e,n){var i,r,o;i=t("../reactGUI/React-shim"),o={},r=function(t,e){return o[t]=i.createFactory(e)},e.exports={optionsStyles:o,defineOptionsStyle:r}},{"../reactGUI/React-shim":42}],34:[function(t,e,n){var i,r,o,a,s;r=t("../reactGUI/React-shim"),i=t("../reactGUI/ReactDOMFactories-shim"),a=t("../reactGUI/createReactClass-shim"),({defineOptionsStyle:s}=t("./optionsStyles")),o=r.createFactory(t("../reactGUI/StrokeWidthPicker")),s("polygon-and-stroke-width",a({displayName:"PolygonAndStrokeWidth",getState:function(){return{strokeWidth:this.props.tool.strokeWidth,inProgress:!1}},getInitialState:function(){return this.getState()},mixins:[t("../reactGUI/createSetStateOnEventMixin")("toolChange")],componentDidMount:function(){var t,e,n;return n=[],this.unsubscribe=()=>{var t,e,i,r;for(r=[],e=0,i=n.length;e<i;e++)t=n[e],r.push(t());return r},e=()=>{if(!this.state.inProgress)return this.setState({inProgress:!0})},t=()=>this.setState({inProgress:!1}),n.push(this.props.lc.on("lc-polygon-started",e)),n.push(this.props.lc.on("lc-polygon-stopped",t))},componentWillUnmount:function(){return this.unsubscribe()},render:function(){var t,e,n,r,a,s,c;return n=this.props.lc,({div:t,img:e}=i),s=()=>n.trigger("lc-polygon-finishopen"),a=()=>n.trigger("lc-polygon-finishclosed"),r=()=>n.trigger("lc-polygon-cancel"),c={},this.state.inProgress||(c={display:"none"}),t({},t({className:"polygon-toolbar horz-toolbar",style:c},t({className:"square-toolbar-button",onClick:s},e({src:`${this.props.imageURLPrefix}/polygon-open.png`})),t({className:"square-toolbar-button",onClick:a},e({src:`${this.props.imageURLPrefix}/polygon-closed.png`})),t({className:"square-toolbar-button",onClick:r},e({src:`${this.props.imageURLPrefix}/polygon-cancel.png`}))),t({},o({tool:this.props.tool,lc:this.props.lc})))}})),e.exports={}},{"../reactGUI/React-shim":42,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/StrokeWidthPicker":45,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49,"./optionsStyles":33}],35:[function(t,e,n){"use strict";var i=t("../reactGUI/createReactClass-shim"),r=t("../reactGUI/React-shim"),o=t("./optionsStyles").defineOptionsStyle,a=t("../reactGUI/createSetStateOnEventMixin"),s=t("../core/localization")._;o("stroke-or-fill",i({displayName:"StrokeOrFillPicker",getState:function(){return{strokeOrFill:"stroke"}},getInitialState:function(){return this.getState()},mixins:[a("toolChange")],onChange:function(t){"stroke-or-fill-stroke"==t.target.id?this.props.lc.tool.strokeOrFill="stroke":this.props.lc.tool.strokeOrFill="fill",this.setState(this.getState())},render:function(){var t=this.props.lc;return r.createElement("form",null,r.createElement("span",null," ",s("Color to change:")," "),r.createElement("span",null,r.createElement("input",{type:"radio",name:"stroke-or-fill",value:"stroke",id:"stroke-or-fill-stroke",onChange:this.onChange,checked:"stroke"==t.tool.strokeOrFill}),r.createElement("label",{htmlFor:"stroke-or-fill-stroke",className:"label"}," ",s("stroke"))),r.createElement("span",null,r.createElement("input",{type:"radio",name:"stroke-or-fill",value:"fill",id:"stroke-or-fill-fill",onChange:this.onChange,checked:"fill"==t.tool.strokeOrFill}),r.createElement("label",{htmlFor:"stroke-or-fill-fill",className:"label"}," ",s("fill"))))}})),e.exports={}},{"../core/localization":11,"../reactGUI/React-shim":42,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49,"./optionsStyles":33}],36:[function(t,e,n){var i;({defineOptionsStyle:i}=t("./optionsStyles")),i("stroke-width",t("../reactGUI/StrokeWidthPicker")),e.exports={}},{"../reactGUI/StrokeWidthPicker":45,"./optionsStyles":33}],37:[function(t,e,n){var i,r,o,a,s,c;r=t("../reactGUI/ReactDOMFactories-shim"),s=t("../reactGUI/createReactClass-shim"),c=t("./createSetStateOnEventMixin"),({_:o}=t("../core/localization")),({classSet:a}=t("../core/util")),i=s({displayName:"ClearButton",getState:function(){return{isEnabled:this.props.lc.canUndo()}},getInitialState:function(){return this.getState()},mixins:[c("drawingChange")],render:function(){var t,e;return({div:t}=r),({lc:e}=this.props),t({className:a({"lc-clear":!0,"toolbar-button":!0,"fat-button":!0,disabled:!this.state.isEnabled}),onClick:e.canUndo()?()=>e.clear():function(){}},o("Clear"))}}),e.exports=i},{"../core/localization":11,"../core/util":25,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./createSetStateOnEventMixin":49}],38:[function(t,e,n){var i,r,o,a,s,c,l,h,u,p,f,d;s=t("./React-shim"),o=t("../reactGUI/ReactDOMFactories-shim"),u=t("../reactGUI/createReactClass-shim"),a=t("react-addons-pure-render-mixin"),({classSet:h,requestAnimationFrame:d,cancelAnimationFrame:l}=t("../core/util")),({_:c}=t("../core/localization")),f=function(t){var e,n,i,r;return"transparent"===t?{hue:0,sat:0,light:0,alpha:0}:"hsla"!==(null!=t?t.substring(0,4):void 0)?null:(n=t.indexOf("("),r=t.indexOf(")"),i=t.substring(n+1,r-n+4),e=function(){var e,n,r,o;for(o=[],e=0,n=(r=i.split(",")).length;e<n;e++)t=r[e],o.push(t.trim());return o}(),{hue:parseInt(e[0],10),sat:parseInt(e[1].substring(0,e[1].length-1),10),light:parseInt(e[2].substring(0,e[2].length-1),10),alpha:parseFloat(e[3])})},p=function({hue:t,sat:e,light:n,alpha:i}){return`hsla(${t}, ${e}%, ${n}%, ${i})`},i=s.createFactory(u({displayName:"ColorGrid",mixins:[a],render:function(){var t;return({div:t}=o),t({},this.props.rows.map(((e,n)=>t({className:"color-row",key:n,style:{width:20*e.length}},e.map(((e,n)=>{var i,r,o,a,s,c,l,u;return({hue:s,sat:l,light:c,alpha:i}=e),o=p(e),a=`hsl(${s}, ${l}%, ${c}%)`,r=h({"color-cell":!0,selected:this.props.selectedColor===o}),t({className:r,onTouchStart:u=t=>(this.props.onChange(e,o),t.stopPropagation(),t.preventDefault()),onTouchMove:u,onClick:u,style:{backgroundColor:a},key:n})}))))))}})),r=u({displayName:"ColorWell",mixins:[a],getInitialState:function(){var t,e;return t=this.props.lc.colors[this.props.colorName],null==(e=f(t))&&(e={}),null==e.alpha&&(e.alpha=1),null==e.sat&&(e.sat=100),null==e.hue&&(e.hue=0),null==e.light&&(e.light=50),{colorString:t,alpha:e.alpha,sat:0===e.sat?100:e.sat,isPickerVisible:!1,hsla:e}},componentDidMount:function(){return this.unsubscribe=this.props.lc.on(`${this.props.colorName}ColorChange`,(()=>{var t;return t=this.props.lc.colors[this.props.colorName],this.setState({colorString:t}),this.setHSLAFromColorString(t)}))},componentWillUnmount:function(){return this.unsubscribe()},setHSLAFromColorString:function(t){var e;return(e=f(t))?this.setState({hsla:e,alpha:e.alpha,sat:e.sat}):this.setState({hsla:null,alpha:1,sat:100})},closePicker:function(){return this.setState({isPickerVisible:!1})},togglePicker:function(){var t,e;return e=(t=!this.state.isPickerVisible)&&0===this.state.sat,this.setHSLAFromColorString(this.state.colorString),this.setState({isPickerVisible:t,sat:e?100:this.state.sat})},setColor:function(t){return this.setState({colorString:t}),this.setHSLAFromColorString(t),this.props.lc.setColor(this.props.colorName,t)},setAlpha:function(t){var e;if(this.setState({alpha:t}),this.state.hsla)return(e=this.state.hsla).alpha=t,this.setState({hsla:e}),this.setColor(p(e))},setSat:function(t){var e;if(this.setState({sat:t}),isNaN(t))throw"SAT";if(this.state.hsla)return(e=this.state.hsla).sat=t,this.setState({hsla:e}),this.setColor(p(e))},render:function(){var t,e,n;return({div:e,label:n,br:t}=o),e({className:h({"color-well":!0,open:this.state.isPickerVisible}),onMouseLeave:this.closePicker,style:{float:"left",textAlign:"center"}},n({float:"left"},this.props.label),t({}),e({className:h({"color-well-color-container":!0,selected:this.state.isPickerVisible}),style:{backgroundColor:"white"},onClick:this.togglePicker},e({className:"color-well-checker color-well-checker-top-left"}),e({className:"color-well-checker color-well-checker-bottom-right",style:{left:"50%",top:"50%"}}),e({className:"color-well-color",style:{backgroundColor:this.state.colorString}}," ")),this.renderPicker())},renderPicker:function(){var t,e,n,r,a,s,l,h,u,p,f,d;if(({div:t,label:s,input:r}=o),!this.state.isPickerVisible)return null;for(f=e=>t({className:"color-row label",key:e,style:{lineHeight:"20px",height:16}},e),p=()=>{var e;return e=`${this.props.lc.opts.imageURLPrefix}/checkerboard-8x8.png`,t({className:"color-row",key:"color",style:{position:"relative",backgroundImage:`url(${e})`,backgroundRepeat:"repeat",height:24}},t({style:{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:this.state.colorString}}))},(d=[]).push(function(){var t,e;for(e=[],n=t=0;t<=100;n=t+=10)e.push({hue:0,sat:0,light:n,alpha:this.state.alpha});return e}.call(this)),a=0,l=(u=[0,30,60,90,120,150,180,210,240,270,300,330]).length;a<l;a++)e=u[a],d.push(function(){var t,i;for(i=[],n=t=10;t<=90;n=t+=8)i.push({hue:e,sat:this.state.sat,light:n,alpha:this.state.alpha});return i}.call(this));return h=(t,e)=>this.setColor(e),t({className:"color-picker-popup"},p(),f(c("alpha")),r({type:"range",min:0,max:1,step:.01,value:this.state.alpha,onChange:t=>this.setAlpha(parseFloat(t.target.value))}),f(c("saturation")),r({type:"range",min:0,max:100,value:this.state.sat,max:100,onChange:t=>this.setSat(parseInt(t.target.value,10))}),i({rows:d,selectedColor:this.state.colorString,onChange:h}))}}),e.exports=r},{"../core/localization":11,"../core/util":25,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./React-shim":42,"react-addons-pure-render-mixin":2}],39:[function(t,e,n){"use strict";var i=t("../reactGUI/React-shim"),r=t("../reactGUI/createReactClass-shim"),o=t("../reactGUI/ReactDOM-shim").findDOMNode,a=t("../core/util").classSet,s=t("./Picker"),c=t("./Options"),l=t("./createToolButton"),h=t("../core/LiterallyCanvas").default,u=t("../core/defaultOptions").default;t("../optionsStyles/font"),t("../optionsStyles/stroke-width"),t("../optionsStyles/line-options-and-stroke-width"),t("../optionsStyles/polygon-and-stroke-width"),t("../optionsStyles/null");var p=r({displayName:"CanvasContainer",shouldComponentUpdate:function(){return!1},render:function(){return i.createElement("div",{key:"literallycanvas",className:"lc-drawing with-gui"})}}),f=r({displayName:"LiterallyCanvas",getDefaultProps:function(){return u},bindToModel:function(){var t=o(this.canvas);this.props;this.lc.bindToElement(t),"function"==typeof this.lc.opts.onInit&&this.lc.opts.onInit(this.lc)},componentWillMount:function(){var t=this;this.lc||(this.props.lc?this.lc=this.props.lc:this.lc=new h(this.props),this.toolButtonComponents=this.lc.opts.tools.map((function(e){return l(new e(t.lc))})))},componentDidMount:function(){this.lc.isBound||this.bindToModel()},componentWillUnmount:function(){this.lc&&this.lc._teardown()},render:function(){var t=this,e=this.lc,n=this.toolButtonComponents,r=(this.props,this.lc.opts),o=r.imageURLPrefix,l=r.toolbarPosition,h=(r.imageSize,{lc:e,toolButtonComponents:n,imageURLPrefix:o}),u=a({"toolbar-at-top":"top"===l,"toolbar-at-bottom":"bottom"===l,"toolbar-hidden":"hidden"===l});return i.createElement("div",{className:"literally ".concat(u)},i.createElement(p,{ref:function(e){return t.canvas=e}}),i.createElement(s,h),i.createElement(c,{lc:e,imageURLPrefix:o}))}});e.exports=f},{"../core/LiterallyCanvas":3,"../core/defaultOptions":8,"../core/util":25,"../optionsStyles/font":29,"../optionsStyles/line-options-and-stroke-width":31,"../optionsStyles/null":32,"../optionsStyles/polygon-and-stroke-width":34,"../optionsStyles/stroke-width":36,"../reactGUI/React-shim":42,"../reactGUI/ReactDOM-shim":43,"../reactGUI/createReactClass-shim":48,"./Options":40,"./Picker":41,"./createToolButton":50}],40:[function(t,e,n){var i,r,o,a,s;i=t("../reactGUI/ReactDOMFactories-shim"),o=t("../reactGUI/createReactClass-shim"),a=t("./createSetStateOnEventMixin"),({optionsStyles:s}=t("../optionsStyles/optionsStyles")),r=o({displayName:"Options",getState:function(){var t;return{style:null!=(t=this.props.lc.tool)?t.optionsStyle:void 0,tool:this.props.lc.tool}},getInitialState:function(){return this.getState()},mixins:[a("toolChange")],renderBody:function(){var t;return t=""+this.state.style,s[t]&&s[t]({lc:this.props.lc,tool:this.state.tool,imageURLPrefix:this.props.imageURLPrefix})},render:function(){var t;return({div:t}=i),t({className:"lc-options horz-toolbar"},this.renderBody())}}),e.exports=r},{"../optionsStyles/optionsStyles":33,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./createSetStateOnEventMixin":49}],41:[function(t,e,n){var i,r,o,a,s,c,l,h,u,p;c=t("./React-shim"),a=t("../reactGUI/ReactDOMFactories-shim"),p=t("../reactGUI/createReactClass-shim"),i=c.createFactory(t("./ClearButton")),l=c.createFactory(t("./UndoRedoButtons")),h=c.createFactory(t("./ZoomButtons")),({_:u}=t("../core/localization")),o=c.createFactory(t("./ColorWell")),r=c.createFactory(p({displayName:"ColorPickers",render:function(){var t,e;return({lc:e}=this.props),({div:t}=a),t({className:"lc-color-pickers"},o({lc:e,colorName:"primary",label:u("stroke")}),o({lc:e,colorName:"secondary",label:u("fill")}),o({lc:e,colorName:"background",label:u("bg")}))}})),s=p({displayName:"Picker",getInitialState:function(){return{selectedToolIndex:0}},renderBody:function(){var t,e,n,o;return({div:t}=a),({toolButtonComponents:o,lc:n,imageURLPrefix:e}=this.props),t({className:"lc-picker-contents"},o.map(((t,i)=>t({lc:n,imageURLPrefix:e,key:i,isSelected:i===this.state.selectedToolIndex,onSelect:t=>(n.setTool(t),this.setState({selectedToolIndex:i}))}))),o.length%2!=0?t({className:"toolbar-button thin-button disabled"}):void 0,t({style:{position:"absolute",bottom:0,left:0,right:0}},r({lc:this.props.lc}),l({lc:n,imageURLPrefix:e}),h({lc:n,imageURLPrefix:e}),i({lc:n})))},render:function(){var t;return({div:t}=a),t({className:"lc-picker"},this.renderBody())}}),e.exports=s},{"../core/localization":11,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./ClearButton":37,"./ColorWell":38,"./React-shim":42,"./UndoRedoButtons":46,"./ZoomButtons":47}],42:[function(t,e,n){var i;try{i=t("react")}catch(t){i=window.React}if(null==i)throw"Can't find React";e.exports=i},{react:"react"}],43:[function(t,e,n){var i;try{i=t("react-dom")}catch(t){i=window.ReactDOM}if(null==i)try{i=t("react")}catch(t){i=window.React}if(null==i)throw"Can't find ReactDOM";e.exports=i},{react:"react","react-dom":"react-dom"}],44:[function(t,e,n){var i;try{i=t("react-dom-factories")}catch(t){i=window.ReactDOMFactories}if(null==i)try{i=t("react").DOM}catch(t){i=window.React.DOM}if(null==i)throw"Can't find DOM";e.exports=i},{react:"react","react-dom-factories":"react-dom-factories"}],45:[function(t,e,n){var i,r,o,a;i=t("../reactGUI/ReactDOMFactories-shim"),o=t("../reactGUI/createReactClass-shim"),a=t("../reactGUI/createSetStateOnEventMixin"),({classSet:r}=t("../core/util")),e.exports=o({displayName:"StrokeWidthPicker",getState:function(t=this.props.tool){return{strokeWidth:t.strokeWidth}},getInitialState:function(){return this.getState()},mixins:[a("toolDidUpdateOptions")],componentWillReceiveProps:function(t){return this.setState(this.getState(t.tool))},render:function(){var t,e,n,o,a,s;return({ul:s,li:n,svg:a,circle:t,div:e}=i),o=this.props.lc.opts.strokeWidths,e({},o.map(((n,i)=>{var o;return o=r({"square-toolbar-button":!0,selected:n===this.state.strokeWidth,"hidden-xs":i%4!=0}),34,e({key:n},e({className:o,onClick:()=>this.props.lc.trigger("setStrokeWidth",n)},a({width:32,height:32,viewport:`0 0 ${n} ${n}`,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},t({cx:Math.ceil(17),cy:Math.ceil(17),r:n/2}))))})))}})},{"../core/util":25,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"../reactGUI/createSetStateOnEventMixin":49}],46:[function(t,e,n){var i,r,o,a,s,c,l,h,u,p;r=t("./React-shim"),i=t("../reactGUI/ReactDOMFactories-shim"),h=t("../reactGUI/createReactClass-shim"),u=t("./createSetStateOnEventMixin"),({classSet:l}=t("../core/util")),({_:c}=t("../core/localization")),p=function(t){return h({displayName:"undo"===t?"UndoButton":"RedoButton",getState:function(){return{isEnabled:function(){switch(!1){case"undo"!==t:return this.props.lc.canUndo();case"redo"!==t:return this.props.lc.canRedo()}}.call(this)}},getInitialState:function(){return this.getState()},mixins:[u("drawingChange")],render:function(){var e,n,r,o,a;return({div:e,img:r}=i),({lc:o,imageURLPrefix:n}=this.props),a=c(a="undo"===t?"Undo":"Redo"),e({className:`lc-${t} `+l({"toolbar-button":!0,"thin-button":!0,disabled:!this.state.isEnabled,"hidden-xs":!0}),onClick:function(){switch(!1){case!!this.state.isEnabled:return function(){};case"undo"!==t:return function(){return o.undo()};case"redo"!==t:return function(){return o.redo()}}}.call(this),title:a,style:{backgroundImage:`url(${`${n}/${t}.png`})`}})}})},a=r.createFactory(p("undo")),o=r.createFactory(p("redo")),s=h({displayName:"UndoRedoButtons",render:function(){var t;return({div:t}=i),t({className:"lc-undo-redo"},a(this.props),o(this.props))}}),e.exports=s},{"../core/localization":11,"../core/util":25,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./React-shim":42,"./createSetStateOnEventMixin":49}],47:[function(t,e,n){var i,r,o,a,s,c,l,h,u,p;r=t("./React-shim"),i=t("../reactGUI/ReactDOMFactories-shim"),h=t("../reactGUI/createReactClass-shim"),u=t("./createSetStateOnEventMixin"),({classSet:l}=t("../core/util")),({_:c}=t("../core/localization")),p=function(t){return h({displayName:"in"===t?"ZoomInButton":"ZoomOutButton",getState:function(){return{isEnabled:function(){switch(!1){case"in"!==t:return this.props.lc.scale<this.props.lc.config.zoomMax;case"out"!==t:return this.props.lc.scale>this.props.lc.config.zoomMin}}.call(this)}},getInitialState:function(){return this.getState()},mixins:[u("zoom")],render:function(){var e,n,r,o,a;return({div:e,img:r}=i),({lc:o,imageURLPrefix:n}=this.props),a=c(a="in"===t?"Zoom in":"Zoom out"),e({className:`lc-zoom-${t} `+l({"toolbar-button":!0,"thin-button":!0,disabled:!this.state.isEnabled}),onClick:function(){switch(!1){case!!this.state.isEnabled:return function(){};case"in"!==t:return function(){return o.zoom(o.config.zoomStep)};case"out"!==t:return function(){return o.zoom(-o.config.zoomStep)}}}.call(this),title:a,style:{backgroundImage:`url(${`${n}/zoom-${t}.png`})`}})}})},s=r.createFactory(p("out")),a=r.createFactory(p("in")),o=h({displayName:"ZoomButtons",render:function(){var t;return({div:t}=i),t({className:"lc-zoom"},s(this.props),a(this.props))}}),e.exports=o},{"../core/localization":11,"../core/util":25,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./React-shim":42,"./createSetStateOnEventMixin":49}],48:[function(t,e,n){var i;try{i=t("create-react-class")}catch(t){i=window.createReactClass}if(null==i)try{i=t("react").createClass}catch(t){i=window.React.createClass}if(null==i)throw"Can't find createReactClass";e.exports=i},{"create-react-class":"create-react-class",react:"react"}],49:[function(t,e,n){t("./React-shim"),e.exports=function(t){return{componentDidMount:function(){return this.unsubscribe=this.props.lc.on(t,(()=>this.setState(this.getState())))},componentWillUnmount:function(){return this.unsubscribe()}}}},{"./React-shim":42}],50:[function(t,e,n){var i,r,o,a,s,c;r=t("./React-shim"),i=t("../reactGUI/ReactDOMFactories-shim"),s=t("../reactGUI/createReactClass-shim"),({classSet:a}=t("../core/util")),({_:o}=t("../core/localization")),c=function(t){var e,n;return e=t.name,n=t.iconName,r.createFactory(s({displayName:e,getDefaultProps:function(){return{isSelected:!1,lc:null}},componentWillMount:function(){if(this.props.isSelected)return this.props.lc.setTool(t)},render:function(){var r,s,c,l,h;return({div:r,img:c}=i),({imageURLPrefix:s,isSelected:l,onSelect:h}=this.props),r({className:a({"lc-pick-tool":!0,"toolbar-button":!0,"thin-button":!0,selected:l}),style:{backgroundImage:`url(${`${s}/${n}.png`})`},onClick:function(){return h(t)},title:o(e)})}}))},e.exports=c},{"../core/localization":11,"../core/util":25,"../reactGUI/ReactDOMFactories-shim":44,"../reactGUI/createReactClass-shim":48,"./React-shim":42}],51:[function(t,e,n){"use strict";var i=t("./React-shim"),r=t("./ReactDOM-shim"),o=t("../core/LiterallyCanvas").default,a=t("./LiterallyCanvas");e.exports=function(t,e){var n=t.className,s=new o(e);return r.render(i.createElement(a,{lc:s}),t),s.teardown=function(){s._teardown();for(var e=0;e<t.children.length;e++)t.removeChild(t.children[e]);t.className=n},s}},{"../core/LiterallyCanvas":3,"./LiterallyCanvas":39,"./React-shim":42,"./ReactDOM-shim":43}]},{},[26])(26)}));
//# sourceMappingURL=literallycanvas.min.js.map
