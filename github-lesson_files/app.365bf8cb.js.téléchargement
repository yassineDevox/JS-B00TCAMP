!function(){"use strict";angular.module("flagship-ui",["multi-transclude","ngLodash"])}(),function(){"use strict";angular.module("flagship-ui").service("alertService",["$rootScope","$timeout",function(e,o){var a=[],i=null;function r(e,t){"object"==typeof e?(e.data&&e.data.errors&&0<e.data.errors.length?this.message=e.data.errors[0]:this.message=e.data.error_description||e.data.exceptionMessage||e.data.message||e.exceptionMessage||"An unknown error occurred.",this.type="danger"):(this.message=e,this.type=t||"info",this.hasAnimated=!1),this.canMatch=!0,this.shown=!0}function t(){if(0===a.length)return null;var e=a.slice(-1).pop();return e.shown?e:null}function s(A){a.forEach(function(e,t){e===A&&(a.animateDestroy=!0,o(function(){a.splice(t,1)},200))})}return e.$on("$stateChangeSuccess",function(){var e=t();e&&(i!==e&&(e.timer&&o.cancel(e.timer),e.timer=o(function(){s(e)},5e3),e.shown=!1),e.canMatch=!1,i=null)}),{addMessage:function(e,t,A){a.forEach(function(e){e.shown=!1});var n=new r(e,t);a.push(n),n.timer=o(function(){s(n)},5e3),i=A?n:null,5<a.length&&(a=a.slice(-5))},hide:function(){var e=a[a.length-1];e&&(e.shown=!1,e.canMatch=!1)},get:function(){return a.slice(0)},current:t,timedDestroy:s}}])}(),function(){"use strict";angular.module("flagship-ui").directive("fsAlertViewer",["alertService",function(n){return{scope:!0,templateUrl:"components/flagship-ui/alertViewer.html",controller:["$scope","$element",function(e,t){e.currentAlert=function(){return n.current()},e.shownBefore=function(){var e=n.current(),t=n.get(),A=t[t.length-2];return!!(e&&A&&A.canMatch&&e.message===A.message)},e.clear=function(){return n.hide()},t.bind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.currentAlert().hasAnimated=!0})}]}}])}(),function(){"use strict";angular.module("flagship-ui").directive("fsConfirm",["$uibModal","$interpolate",function(i,r){return{restrict:"A",link:function(t,e,A){var n,o=r(A.fsConfirmTitle),a=r(A.fsConfirmPrompt);A.confirmButton&&(t.confirmButton=r(A.confirmButton)(t)),A.cancelButton&&(t.cancelButton=r(A.cancelButton)(t)),t.onConfirm=function(){n.hide(),n=null,t.$eval(A.confirmAction)},e.on("click",function(e){n=i.open({templateUrl:"components/flagship-ui/confirm.html",title:o(t),content:a(t),show:!0,scope:t}),e.stopPropagation()})}}}])}(),function(){"use strict";angular.module("seedApp",[])}(),function(){"use strict";angular.module("seedApp").directive("saPageTitle",["$transitions",function(t){return{restrict:"A",scope:!1,link:function(e,o){t.onSuccess({},function(t){var A="Notud";try{A=t.injector().get("pageTitle")+" - "+A}catch(e){var n=t.to();n.data&&n.data.pageTitle&&(A=n.data.pageTitle+" - "+A)}o.text(A)})}}}])}(),function(){"use strict";function e(e,t,A,n){return{setRoutingHandlers:function(){e.$on("$stateChangeStart",function(e,t){A.isLoggedIn()&&t.data&&t.data.authorizeRoles&&!n.isUserInAnyRole(t.data.authorizeRoles)&&e.preventDefault()}),e.$on("$stateChangeSuccess",function(e,t,A,n){var o=!1,a=[];t.data&&(o=t.data.preventScrollToTop||!1,a=t.data.preventScrollToTopFromStates||[]),-1!==a.indexOf(n.name)&&(o=!0),o||(document.body.scrollTop=document.documentElement.scrollTop=0)})}}}angular.module("seedApp").factory("routeProtector",e),e.$inject=["$rootScope","$urlRouter","AuthService","AppContext"]}(),function(){"use strict";angular.module("seedApp").directive("saAutoFocus",["$timeout",function(A){return{require:"ngModel",restrict:"A",scope:!1,link:function(e,t){A(function(){t[0].focus()},0)}}}])}(),function(){"use strict";function e(a){return{restrict:"A",require:"^form",link:function(e,A,t,n){var o=angular.element(A[0].querySelector("[name]"));o.ready(function(){var t=o.attr("name"),t=a(t)(e);e.$watch(function(){return!!n[t]&&n[t].$valid},function(e){n&&n[t]&&(n.$submitted||n[t].$touched)&&A.toggleClass("has-error",!e)}),e.$watch(function(){return!(!n||!n[t])&&(n[t].$touched||n.$submitted)},function(e){n&&n[t]&&e&&A.toggleClass("has-error",n[t].$invalid)})})}}}angular.module("seedApp").directive("saShowFeedback",e),e.$inject=["$interpolate"]}(),function(){"use strict";function e(e){this.model=e.model,this.yes=function(){e.close(!0)},this.no=function(){e.close(!1)}}angular.module("seedApp").controller("ConfirmModalController",e),e.$inject=["$uibModalInstance"]}(),function(){"use strict";angular.module("seedApp").filter("yesNo",function(){return function(e){return e?"Yes":"No"}})}(),function(){"use strict";angular.module("ui.bootstrap.dateparser",[]).service("uibDateParser",["$log","$locale","dateFilter","orderByFilter","filterFilter",function(m,h,A,f,t){var C,I,E=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;function n(e){return t(I,{key:e},!0)[0]}function o(e){for(var t,A,n=[],o=0;o<e.length;)if(angular.isNumber(A)){if("'"===e.charAt(o))(o+1>=e.length||"'"!==e.charAt(o+1))&&(n.push(function(e,t,A){return function(){return e.substr(t+1,A-t-1)}}(e,A,o)),A=null);else if(o===e.length)for(;A<e.length;)t=a(e,A),n.push(t),A=t.endIdx;o++}else"'"!==e.charAt(o)?(t=a(e,o),n.push(t.parser),o=t.endIdx):(A=o,o++);return n}function a(e,t){for(var A=e.substr(t),n=0;n<I.length;n++)if(new RegExp("^"+I[n].key).test(A)){var o=I[n];return{endIdx:t+o.key.length,parser:o.formatter}}return{endIdx:t+1,parser:function(){return A.charAt(0)}}}function i(e){return parseInt(e,10)}function r(e,t){e=e.replace(/:/g,"");var A=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(A)?t:A}function s(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}function c(e,t,A){A=A?-1:1;var n=e.getTimezoneOffset();return s(e,A*(r(t,n)-n))}this.init=function(){C=h.id,this.parsers={},this.formatters={},I=[{key:"yyyy",regex:"\\d{4}",apply:function(e){this.year=+e},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),A(t,"yyyy")}},{key:"yy",regex:"\\d{2}",apply:function(e){e=+e,this.year=e<69?e+2e3:e+1900},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),A(t,"yy")}},{key:"y",regex:"\\d{1,4}",apply:function(e){this.year=+e},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),A(t,"y")}},{key:"M!",regex:"0?[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){var t=e.getMonth();return/^[0-9]$/.test(t)?A(e,"MM"):A(e,"M")}},{key:"MMMM",regex:h.DATETIME_FORMATS.MONTH.join("|"),apply:function(e){this.month=h.DATETIME_FORMATS.MONTH.indexOf(e)},formatter:function(e){return A(e,"MMMM")}},{key:"MMM",regex:h.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(e){this.month=h.DATETIME_FORMATS.SHORTMONTH.indexOf(e)},formatter:function(e){return A(e,"MMM")}},{key:"MM",regex:"[0]?[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){return A(e,"MM")}},{key:"M",regex:"[0]?[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){return A(e,"M")}},{key:"d!",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){var t=e.getDate();return/^[1-9]$/.test(t)?A(e,"dd"):A(e,"d")}},{key:"dd",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){return A(e,"dd")}},{key:"d",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){return A(e,"d")}},{key:"EEEE",regex:h.DATETIME_FORMATS.DAY.join("|"),formatter:function(e){return A(e,"EEEE")}},{key:"EEE",regex:h.DATETIME_FORMATS.SHORTDAY.join("|"),formatter:function(e){return A(e,"EEE")}},{key:"HH",regex:"(?:0|1)[0-9]|2[0-3]",apply:function(e){this.hours=+e},formatter:function(e){return A(e,"HH")}},{key:"hh",regex:"[0]?[0-9]|1[0-2]",apply:function(e){this.hours=+e},formatter:function(e){return A(e,"hh")}},{key:"H",regex:"[01]?[0-9]|2[0-3]",apply:function(e){this.hours=+e},formatter:function(e){return A(e,"H")}},{key:"h",regex:"[0]?[0-9]|1[0-2]",apply:function(e){this.hours=+e},formatter:function(e){return A(e,"h")}},{key:"mm",regex:"[0-5]?[0-9]",apply:function(e){this.minutes=+e},formatter:function(e){return A(e,"mm")}},{key:"m",regex:"[0-5]?[0-9]",apply:function(e){this.minutes=+e},formatter:function(e){return A(e,"m")}},{key:"sss",regex:"[0-9][0-9][0-9]",apply:function(e){this.milliseconds=+e},formatter:function(e){return A(e,"sss")}},{key:"ss",regex:"[0-5]?[0-9]",apply:function(e){this.seconds=+e},formatter:function(e){return A(e,"ss")}},{key:"s",regex:"[0-5]?[0-9]",apply:function(e){this.seconds=+e},formatter:function(e){return A(e,"s")}},{key:"a",regex:h.DATETIME_FORMATS.AMPMS.join("|"),apply:function(e){12===this.hours&&(this.hours=0),"PM"===e&&(this.hours+=12)},formatter:function(e){return A(e,"a")}},{key:"Z",regex:"[+-]\\d{4}",apply:function(e){var t=e.match(/([+-])(\d{2})(\d{2})/),A=t[1],n=t[2],o=t[3];this.hours+=i(A+n),this.minutes+=i(A+o)},formatter:function(e){return A(e,"Z")}},{key:"ww",regex:"[0-4][0-9]|5[0-3]",formatter:function(e){return A(e,"ww")}},{key:"w",regex:"[0-9]|[1-4][0-9]|5[0-3]",formatter:function(e){return A(e,"w")}},{key:"GGGG",regex:h.DATETIME_FORMATS.ERANAMES.join("|").replace(/\s/g,"\\s"),formatter:function(e){return A(e,"GGGG")}},{key:"GGG",regex:h.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return A(e,"GGG")}},{key:"GG",regex:h.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return A(e,"GG")}},{key:"G",regex:h.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return A(e,"G")}}],1<=angular.version.major&&4<angular.version.minor&&I.push({key:"LLLL",regex:h.DATETIME_FORMATS.STANDALONEMONTH.join("|"),apply:function(e){this.month=h.DATETIME_FORMATS.STANDALONEMONTH.indexOf(e)},formatter:function(e){return A(e,"LLLL")}})},this.init(),this.getParser=function(e){var t=n(e);return t&&t.apply||null},this.overrideParser=function(e,t){var A=n(e);A&&angular.isFunction(t)&&(this.parsers={},A.apply=t)}.bind(this),this.filter=function(A,e){return angular.isDate(A)&&!isNaN(A)&&e?(e=h.DATETIME_FORMATS[e]||e,h.id!==C&&this.init(),this.formatters[e]||(this.formatters[e]=o(e)),this.formatters[e].reduce(function(e,t){return e+t(A)},"")):""},this.parse=function(e,t,A){if(!angular.isString(e)||!t)return e;t=(t=h.DATETIME_FORMATS[t]||t).replace(E,"\\$&"),h.id!==C&&this.init(),this.parsers[t]||(this.parsers[t]=function(o){var a=[],i=o.split(""),e=o.indexOf("'");if(-1<e){var t=!1;o=o.split("");for(var A=e;A<o.length;A++)t?("'"===o[A]&&(A+1<o.length&&"'"===o[A+1]?(o[A+1]="$",i[A+1]=""):(i[A]="",t=!1)),o[A]="$"):"'"===o[A]&&(o[A]="$",t=!(i[A]=""));o=o.join("")}return angular.forEach(I,function(e){var t=o.indexOf(e.key);if(-1<t){o=o.split(""),i[t]="("+e.regex+")",o[t]="$";for(var A=t+1,n=t+e.key.length;A<n;A++)i[A]="",o[A]="$";o=o.join(""),a.push({index:t,key:e.key,apply:e.apply,matcher:e.regex})}}),{regex:new RegExp("^"+i.join("")+"$"),map:f(a,"index")}}(t));var n=this.parsers[t],o=n.regex,a=n.map,i=e.match(o),r=!1;if(i&&i.length){for(var s,c=angular.isDate(A)&&!isNaN(A.getTime())?{year:A.getFullYear(),month:A.getMonth(),date:A.getDate(),hours:A.getHours(),minutes:A.getMinutes(),seconds:A.getSeconds(),milliseconds:A.getMilliseconds()}:(A&&m.warn("dateparser:","baseDate is not a valid date"),{year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0}),l=1,u=i.length;l<u;l++){var d=a[l-1];"Z"===d.matcher&&(r=!0),d.apply&&d.apply.call(c,i[l])}var p=r?Date.prototype.setUTCFullYear:Date.prototype.setFullYear,g=r?Date.prototype.setUTCHours:Date.prototype.setHours;return function(e,t,A){if(A<1)return!1;if(1===t&&28<A)return 29===A&&(e%4==0&&e%100!=0||e%400==0);return 3!==t&&5!==t&&8!==t&&10!==t||A<31}(c.year,c.month,c.date)&&(!angular.isDate(A)||isNaN(A.getTime())||r?(s=new Date(0),p.call(s,c.year,c.month,c.date),g.call(s,c.hours||0,c.minutes||0,c.seconds||0,c.milliseconds||0)):(s=new Date(A),p.call(s,c.year,c.month,c.date),g.call(s,c.hours,c.minutes,c.seconds,c.milliseconds))),s}},this.toTimezone=function(e,t){return e&&t?c(e,t):e},this.fromTimezone=function(e,t){return e&&t?c(e,t,!0):e},this.timezoneToOffset=r,this.addDateMinutes=s,this.convertTimezoneToLocal=c}])}(),function(){"use strict";angular.module("seedApp").provider("saColorPickerConfig",function(){var t=["#004b80","#4A90E2","#AFCC14","#FF8744","#e50f8a","#7346a4","#999999","#575366","#32292F","#223843"];this.setColors=function(e){t=e},this.$get=function(){return{defaultColors:t}}}).directive("saColorPicker",["saColorPickerConfig",function(e){return{restrict:"E",templateUrl:"components/seedApp/ColorPicker.html",scope:{selected:"=ngModel",colors:"=?instanceColors"},link:function(t){t.colors=t.instanceColors||e.defaultColors,t.selected=t.selected||t.colors[0],t.selectColor=function(e){t.selected=e}}}}])}(),function(){"use strict";angular.module("seedApp").directive("modalBody",function(){return{restrict:"C",link:function(e,t){t.on("touchend",function(e){e.stopPropagation()})}}}),angular.module("seedApp").directive("modalFooter",function(){return{restrict:"C",link:function(e,t){t.on("touchend",function(e){e.stopPropagation()})}}})}(),function(){"use strict";function e(A,e,t){return t.raw.device.ipad||t.raw.device.iphone?e.addEventListener("pagehide",function(){var e={allow:!0};return A.$broadcast("onPageHide",e),e.allow}):e.onbeforeunload=function(e){var t={};if(A.$broadcast("onBeforeUnload",t).defaultPrevented)return t.message},{}}function t(e){}angular.module("seedApp").factory("beforeUnload",e).run(t),e.$inject=["$rootScope","$window","deviceDetector"],t.$inject=["beforeUnload"]}(),function(){"use strict";angular.module("seedApp").directive("saCopyContent",function(){return{restrict:"A",link:function(e,t,A){var n=t[0].ownerDocument,o=n.querySelector(A.saCopyContent);t.on("click",function(e){e.stopPropagation(),o.select(),n.execCommand("copy")})}}})}(),function(){"use strict";angular.module("seedApp").directive("saSubmit",["$parse",function(a){return{restrict:"A",link:function(A,e,t){var n=a(t.saSubmit),o=e.find(":submit");o.addClass("saving"),o.append('<div class="spinner"><div></div><div></div><div></div><div></div></div>'),e.on("submit",function(){var t=e.find(":submit");t.addClass("saving-disabled"),t.attr("disabled",!0),A.$apply(function(){var e=n(A,{$event:event});e&&e.finally?e.finally(function(){t.attr("disabled",!1),t.removeClass("saving-disabled")}):(t.attr("disabled",!1),t.removeClass("saving-disabled"))})})}}}])}(),function(){"use strict";function e(e){var A=e.defer(),n=!1;function t(){var t=document.createElement("img");t.onload=function(){var e=2===t.width&&3===t.height;console.log(e?"Browser supports automatic image orientation.":"Browser does NOT support automatic image rotation."),n=!0,A.resolve(e)},t.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k="}return{isAutoOrientationSupported:function(){return n||t(),A.promise},init:t}}angular.module("seedApp").factory("ImageOrientationService",e),e.$inject=["$q"]}(),function(){"use strict";angular.module("app.common",[])}(),function(){"use strict";function e(e){var o=null,a=null,n=null;return function(){if(!e.libphonenumber)return console.error("libphonenumber does not exist on window, this library will not work.");o=e.libphonenumber.PhoneNumberUtil.getInstance(),a=e.libphonenumber.PhoneNumberType,n=e.libphonenumber.PhoneNumberFormat}(),{isValidMobileNumber:function(e,t){if(!e)return!1;try{var A=o.parseAndKeepRawInput(e,t);if(!o.isValidNumber(A))return!1;var n=o.getNumberType(A);return n===a.MOBILE||n===a.FIXED_LINE_OR_MOBILE}catch(e){return!1}},normalizeMobileNumber:function(e,t){if(e){var A=o.parseAndKeepRawInput(e,t);return o.format(A,n.E164)}}}}angular.module("app.common").service("libphonenumberService",e),e.$inject=["$window"]}(),function(){"use strict";function e(r){function s(e){var t="",A=e.$$state();do{if("root"===A.name)break;A.url&&(t=A.url+t),A=A.parent}while(A);return t=t.replace(/{(\w+):?[^/]+/g,"{$1}")}return{trackStateChanging:function(e){var t;r.appInsights&&r.appInsights.context&&(t=global.Microsoft.ApplicationInsights.Telemetry.Util.generateW3CId(),r.appInsights.context.telemetryTrace.traceID=t,r.appInsights.context.telemetryTrace.name=e.name)},trackStateChanged:function(e,t,A){if(r.appInsights){var n,o=s(e),a=s(t),i=JSON.parse(JSON.stringify(A));for(n in i)i.hasOwnProperty(n)&&null===i[n]&&delete i[n];delete i.patient,i.refUri=o,i.duration=0,r.appInsights.trackPageView({name:t.name,uri:a,properties:i,refUri:o}),r.appInsights.flush()}}}}angular.module("app.common").service("appInsightsService",e),e.$inject=["$window"]}(),function(){"use strict";function e(t,A){var n=this;return this.isUpdating=!1,{checkForUpdates:function(e){if(n.isUpdating)return!1;e!==t.appVersion&&(n.isUpdating=!0,console.log("Application requesting update: from",t.appVersion,"to",e),A.get("$uibModal").open({templateUrl:"common/ApplicationUpdateModal.html",controller:["$uibModalInstance",function(e){this.dismiss=function(){e.close()}}],controllerAs:"alertCtrl",backdrop:"static"}),$.ajax({url:window.location.href,headers:{Pragma:"no-cache",Expires:-1,"Cache-Control":"no-cache"}}))}}}e.$inject=["environmentConfig","$injector"],angular.module("app.common").factory("ApplicationUpdateService",e)}(),function(){"use strict";angular.module("app.common").filter("bytes",function(){return function(e,t){if(isNaN(parseFloat(e))||!isFinite(e))return"-";void 0===t&&(t=1);var A=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(A))).toFixed(t)+" "+["bytes","kB","MB","GB","TB","PB"][A]}})}(),function(){"use strict";function e(e,t){var A="https://ipinfo.io";return t.ipDataKey&&(A=A+"?token="+t.ipDataKey),e(A)}angular.module("app.common").service("IpCountryLookupService",e),e.$inject=["$resource","environmentConfig"]}(),function(){"use strict";angular.module("app.common").directive("isolateForm",function(){return{restrict:"A",require:"?form",link:function(e,t,A,n){var o;n&&(o=!0,A.isolateForm&&(o=e.$eval(A.isolateForm)),o&&t.parent().controller("form").$removeControl(n))}}})}(),function(){"use strict";function e(){return{restrict:"E",controller:t,template:"{{ currencyCtrl.currencySymbol }}",bindToController:!0,controllerAs:"currencyCtrl",scope:!0}}function t(e,t){var A=this;t.getSettings().then(function(e){A.currencySymbol=e.currencySymbol})}angular.module("app.common").directive("currencySymbol",e),e.$inject=[],t.$inject=["$locale","AppContext"]}(),function(){"use strict";angular.module("app.common").value("LiterallyCanvas",window.LC.LiterallyCanvasReactComponent)}(),function(){function e(a,i,A,o){function t(A){return new Promise(function(t,e){if(A.noteData)return t(A);A.noteDataUrl?$.getJSON(A.noteDataUrl,function(e){return A.noteData=e,t(A)}):e("noteDataUrl missing")}).then(function(n){if("string"==typeof n.noteData&&(n.noteData=JSON.parse(n.noteData)),!n.imagesLoaded){var e=o.filter(n.noteData.backgroundShapes,function(e){return"ImageWithRotate"===e.className||"Image"===e.className}),t=o.filter(n.noteData.shapes,function(e){return"ImageWithRotate"===e.className||"Image"===e.className}),A=e.concat(t);return P.map(A,function(A){return new P(function(e){var t=new Image;a.LC.util.addImageOnload(t,e),t.src=A.data.imageSrc,n.loadedImages||(n.loadedImages=[]),n.loadedImages.push(t)})}).then(function(){return n.imagesLoaded=!0,n})}})}function r(e){return P.mapSeries(e.pages,t)}return{printPages:function(e){var n=e.pageOrientation===A.landscape,o=e.paperSize,t={height:o.heightPoints,width:o.widthPoints};return n&&(t={height:o.widthPoints,width:o.heightPoints}),r(e).then(function(){return P.mapSeries(e.pages,function(e){var A=a.LC.renderSnapshotToImage(e.noteData,{includeWatermark:!1,scale:4,rect:{x:0,y:0,width:t.width,height:t.height}});return new Promise(function(e){var t=new Image;t.src=A.toDataURL(),t.style="height: 100%;",t.className="hidden-print-image",t.onload=function(){$("body").append(t),e(t)}})}).then(function(){var e,t,A;t=o,A='<style context="program">             @media print {                 * {                     display: none;                 }                 html, body, .hidden-print-image {                     display: block;                     text-align: center;                 }                 img {                     '+((e=n)?"max-width: "+t.heightMm+";":"max-width: "+t.widthMm+";")+"                    "+(e?"max-height:"+t.widthMm+";":"max-height: "+t.heightMm+";")+"                }             }             </style>",$("head").append(A),window.print(),i(function(){$("[context=program]").remove(),$(".hidden-print-image").remove()},2e3)})})},preloadPage:t,preloadPages:r}}angular.module("app.common").service("CanvasPrint",e),e.$inject=["$window","$timeout","PageOrientation","lodash"]}(),function(){"use strict";angular.module("app.common").constant("notationColors",{colorNameToHslaMap:{black:"hsla(0, 0%, 0%, 1.00)",gray:"hsla(0, 0%, 50%, 1.00)",silver:"hsla(0, 0%, 75%, 1.00)",red:"hsla(360, 100%, 50%, 1.00)",green:"hsla(125, 80%, 45%, 1.00)",blue:"hsla(230, 100%, 50%, 1.00)",yellow:"hsla(55, 100%, 50%, 1.00)",fuchsia:"hsla(300, 100%, 50%, 1.00)"},hslaToColorNameMap:{"hsla(0, 0%, 0%, 1.00)":"black","hsla(0, 0%, 50%, 1.00)":"gray","hsla(0, 0%, 75%, 1.00)":"silver","hsla(360, 100%, 50%, 1.00)":"red","hsla(125, 80%, 45%, 1.00)":"green","hsla(230, 100%, 50%, 1.00)":"blue","hsla(55, 100%, 50%, 1.00)":"yellow","hsla(300, 100%, 50%, 1.00)":"fuchsia"}})}(),function(){"use strict";angular.module("app.common").directive("cardList",function(){function e(){var t=this;t.removeItem=function(e){t.removeFunc({item:t.items[e]})}}return e.$inject=[],{restrict:"E",templateUrl:"common/CardListDirective.html",transclude:!0,scope:{items:"=items",itemAltText:"@itemAltText",removeFunc:"&removeFunc"},link:function(e,t,A,n,o){o(e,function(e){t.append(e)})},controller:e,controllerAs:"vm",bindToController:!0}}).directive("inject",function(){return{link:function(e,t,A,n,o){if(!o)throw Error("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found.");var a=e.$new();o(a,function(e){t.empty(),t.append(e),t.on("$destroy",function(){a.$destroy()})})}}})}(),function(){"use strict";function e(n,o,a){return{priority:-1,restrict:"A",scope:{},replace:!1,link:function(t,e){function A(e){this.myAccount=n.openidAuthority+"/teams",this.closeModal=function(){e.close()}}t.subscriptionReadOnly=o.settings.subscription.isReadOnly,e.on("click",function(e){t.subscriptionReadOnly&&(e.stopImmediatePropagation(),e.preventDefault(),a.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"common/RequireSubscriptionTemplate.html",size:"lg",controller:A,controllerAs:"vm"}))}),A.$inject=["$uibModalInstance"]}}}angular.module("app.common").directive("ncRequireSubscription",e),e.$inject=["environmentConfig","AppContext","$uibModal"]}(),function(){"use strict";angular.module("app.common").directive("appSubMenu",function(){return{restrict:"E",transclude:!0,templateUrl:"common/SubmenuDirective.html",link:function(e,t,A){var n=t.find(".dropdown-toggle");n.addClass(A.btnClass?A.btnClass:"btn btn-default"),n[0].title=A.title;var o=n.find(":first-child");o.addClass(A.iconClass?A.iconClass:"fa fa-ellipsis-h"),o[0].title=A.title}}})}(),function(){"use strict";function e(){return{restrict:"E",scope:{items:"=",selectedItems:"=",displayMember:"@",readonly:"=?"},controllerAs:"checkboxListCtrl",bindToController:!0,templateUrl:"common/CheckboxListDirective.html",controller:t}}function t(e){var A=this;this.$onInit=function(){A.internalItems=e.map(A.items,function(e){return{model:e,isSelected:-1!==A.selectedItems.indexOf(e)}}),A.readonly=!!A.readonly},this.onSelectionChanged=function(e){var t=A.selectedItems.indexOf(e.model);e.isSelected?-1===t&&A.selectedItems.push(e.model):-1!==t&&A.selectedItems.splice(t,1)}}angular.module("app.common").directive("ncCheckboxList",e),e.$inject=[],t.$inject=["lodash"]}(),function(){"use strict";function e(e){e.signout()}angular.module("app.common").controller("LogoutController",e),e.$inject=["AuthService"]}(),function(){"use strict";function e(a){var i={shapes:[],backgroundShapes:[],imageSize:{width:"infinite",height:"infinite"}},r=[{className:"ImageWithRotate",data:{x:9,y:-36,imageSrc:"data:image/png;base64,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",imageObject:{},scale:.48610451306413305,rotateAngle:0},id:"b12919d6-f7a7-c543-cd6d-585552719f67"}],s={shapes:[],backgroundShapes:[],imageSize:{width:"infinite",height:"infinite"}};return{createNewSnapshot:function(e,t,A,n){var o={};return(o="lined"===A?(n?s.shapes=r:s.backgroundShapes=r,a.cloneDeep(s)):a.cloneDeep(i)).imageSize.width=e,o.imageSize.height=t,o}}}angular.module("app.common").service("newNoteSnapshotService",e),e.$inject=["lodash"]}(),function(){"use strict";angular.module("app.common").directive("ncNewPageSelector",function(){function e(t){var A=this;A.$onInit=function(){A.defaultNewPage=t.getItem("DefaultNewPage")||A.items[0]},A.selectPage=function(e){t.setItem("DefaultNewPage",e),A.defaultNewPage=e,A.newPageSelected({page:e})}}return e.$inject=["UserSettings"],{restrict:"E",templateUrl:"common/notes/NewNotePageSelectorDirective.html",transclude:!0,scope:{items:"=",defaultItem:"=",newPageSelected:"&"},controller:e,controllerAs:"vm",bindToController:!0}})}(),function(){"use strict";angular.module("app.common").constant("pageTypes",[{id:"whiteLined",name:"Lined"},{id:"whiteBlank",name:"Blank (No Lines)"},{id:"yellowLined",name:"Yellow Lined"},{id:"bodyModel",name:"Body Model"},{id:"schoolNotebook",name:"School Notebook"},{id:"graphPage",name:"Graph Paper"},{id:"dotGridPage",name:"Dot Grid"}])}(),function(){"use strict";function e(e,t){if(!e.Intercom)return{show:n,hide:n,peek_left:n,left:n};var A=$(".intercom-launcher-frame");function n(){}return{show:function(){e.intercomSettings.hide_default_launcher=!1,e.Intercom("update",e.intercomSettings)},hide:function(){e.intercomSettings.hide_default_launcher=!0,e.Intercom("update",e.intercomSettings)},peek_left:function(){var e=t.onFinish({},function(){$(".intercom-launcher-frame").animate({left:20},100),A.unbind("mouseenter").unbind("mouseleave"),e()});A.css({left:-20}),A.mouseenter(function(){A.animate({left:-10},100)}).mouseleave(function(){A.animate({left:-20},100)})},left:function(){A.unbind("mouseenter").unbind("mouseleave"),$(".intercom-launcher-frame").animate({left:20},100)}}}angular.module("app.common").service("IntercomPositionService",e),e.$inject=["$window","$transitions"]}(),function(){"use strict";angular.module("app.common").constant("PageOrientation",{portriat:1,landscape:2})}(),function(){"use strict";function e(o){return{restrict:"A",scope:!1,link:function(e,t,A){var n=A.ncAuthorizeRoles;o.getSettings(!0).then(function(){o.isUserInAnyRole(n)||(t[0].style.display="none")})}}}function t(n){return{restrict:"A",scope:!1,link:function(e,t,A){n.getSettings(!0).then(function(){n.isUserInRole(A.ncHideRole)&&(t[0].style.display="none")})}}}function A(n){return{restrict:"A",scope:!1,link:function(e,t,A){n.getSettings(!0).then(function(){n.isUserInRole(A.ncEnableRole)||(t[0].disabled=!0)})}}}angular.module("app.common").directive("ncAuthorizeRoles",e).directive("ncHideRole",t).directive("ncEnableRole",A),e.$inject=["AppContext"],t.$inject=["AppContext"],A.$inject=["AppContext"]}(),function(){"use strict";angular.module("app.common").directive("clearUiSelect",function(){return{require:"uiSelect",link:function(e,t,A,n){e.clearFunc=function(){var e=n.items.indexOf(n.selected);-1<e&&n.items.splice(e,1),n.selected=void 0},e.getClear&&e.getClear({clearFunc:e.clearFunc})}}})}(),function(){"use strict";function e(A,n){var o=null,a=!1;function i(e,t){return A("currency")(e,t)}function e(e,t){return void 0!==t?i(e,t):null===o?(a||(a=!0,n.getSettings().then(function(e){o=e.currencySymbol})),"-"):i(e,o)}return e.$stateful=!0,e}angular.module("app.common").filter("orgCurrency",e),e.$inject=["$filter","AppContext"]}(),function(){"use strict";angular.module("app.common").component("creditCardComponent",{transclude:!0,controller:function(){var e=this;e.$onInit=function(){switch(e.brand){case"Mastercard":e.class="mastercard";break;case"Visa":e.class="card"}}},controllerAs:"vm",templateUrl:"common/CreditCardComponent.html",bindings:{last4:"<",expiryMonth:"<",expiryYear:"<",brand:"<",name:"<"}})}(),function(){"use strict";function e(t,A,e,n){function o(e){t.Intercom?(t.Intercom("startTour",e),i(e)):console.error("Intercom API was not available")}function a(t){return e.getSettings().then(function(e){return n.tourCompletion({id:e.user.id,intercomTourId:t}).$promise.then(function(e){return e.completed})})}function i(t){return e.getSettings().then(function(e){return n.completeTour({id:e.user.id,intercomTourId:t}).$promise})}function r(){}return t.Intercom?{launch:o,launchNoteTour:function(e){var t=parseInt(A.intercom.noteTourId);if(e)return o(t),i(parseInt(A.intercom.quickNoteTourId));a(t).then(function(e){e||(o(t),i(parseInt(A.intercom.quickNoteTourId)))})},launchQuickNoteTour:function(e){var t=parseInt(A.intercom.quickNoteTourId);if(e)return o(t),i(parseInt(A.intercom.noteTourId));a(t).then(function(e){e||(o(t),i(parseInt(A.intercom.noteTourId)))})}}:{launch:r,launchNoteTour:r,launchQuickNoteTour:r}}angular.module("app.common").service("IntercomTour",e),e.$inject=["$window","environmentConfig","AppContext","UsersApi"]}(),function(){"use strict";angular.module("app.common").filter("trustUrl",["$sce",function(t){return function(e){return t.trustAsResourceUrl(e)}}])}(),function(){"use strict";function e(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return{escapeHtml:function(e){return e.replace(/[&<>"'\/]/g,function(e){return t[e]})}}}function t(A){return function(e,t){return e=A.escapeHtml(e),(t=A.escapeHtml(t))?e.replace(new RegExp(t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),"<strong>$&</strong>"):e}}angular.module("app.common").factory("HtmlEscaper",e).filter("ncTypeaheadHighlight",t),e.$inject=[],t.$inject=["HtmlEscaper"]}(),function(){"use strict";function e(u,d,a,p,o,i,e,t,g,r,s,A,m){var h=this,c=this;h.vm=h;var n="|jpg|jfif|png|jpeg|bmp|gif|";function l(e){h.lc=e,function(){$(".lc-options.horz-toolbar").wrap('<div class="horz-toolbar-wrapper"></div>'),$('.lc-pick-tool.toolbar-button.thin-button[title="Pan"]:not(.selected)').on("click touchstart",function(){$(".lc-drawing.with-gui").addClass("move-cursor")}),$('.lc-pick-tool.toolbar-button.thin-button:not([title="Pan"])').on("click touchstart",function(){$(".lc-drawing.with-gui").removeClass("move-cursor")}),$(".lc-color-pickers").remove();var e=$('<div class="canvas-controls"></div>');$(".horz-toolbar-wrapper").append(e);var t=$(".lc-undo-redo").detach(),A=$(".lc-zoom").detach();$(".lc-clear").remove();var n=p('<div uib-popover popover-class="mobile-popover" uib-popover-template="\'fullscreenPopover.html\'" popover-title="Welcome to Notud!" popover-trigger="\'none\'" popover-is-open="vm.showFullscreenTooltip" popover-placement="bottom-right" class="full-screen toolbar-button thin-button"><span class="full-screen-button fa fa-expand"></span></div>')(u),o=p('<div uib-popover popover-class="mobile-popover" uib-popover-template="\'penModePopover.html\'" popover-title="Pen Mode" popover-trigger="\'none\'" popover-is-open="vm.showPenModeTooltip" popover-placement="bottom-right" class="checkbox switcher"><label for="pen-mode-switch"><input type="checkbox" id="pen-mode-switch" ng-model="vm.lc.opts.penMode" ng-change="vm.togglePenMode()"><span><small><span class="fa fa-pencil"><span></small></span><small></small></label></div>')(u);e.append(o),e.append(t),e.append(A),e.append(n),$(".full-screen").on("click",function(){d(function(){h.fullScreen?h.exitFullScreen():h.goFullScreen()},0)});var a=new MutationObserver(l),i=new MutationObserver(s),r=$('<div class="delete-tool toolbar-button thin-button"><span class="fa fa-trash" title="Delete"></span></div>');function s(){i.disconnect(),$(".lc-undo").each(function(){i.observe(this,{attributes:!0})}),$(".lc-redo").each(function(){i.observe(this,{attributes:!0})}),$(".lc-zoom-out").each(function(){i.observe(this,{attributes:!0})}),$(".lc-zoom-in").each(function(){i.observe(this,{attributes:!0})})}function c(e){$(".color-selector").removeClass("selected"),$(e.currentTarget).addClass("selected");var t=g.colorNameToHslaMap[e.data.color];h.lc.setColor("primary",t)}function l(){$(".lc-options.horz-toolbar").show();var e,t,A=$(".lc-options.horz-toolbar > div > .square-toolbar-button");A.removeAttr("style"),0<A.filter(".fa-reply").length||(0<A.length&&(e=$(".lc-options.horz-toolbar > div"),A.wrap("<div></div>"),t=$(".lc-options.horz-toolbar > div:last-child > div").detach(),e.append(t)),$(".lc-options.horz-toolbar > div")[0]||$(".lc-options.horz-toolbar").hide())}$(".canvas-controls").on("click",".delete-tool",function(){var e=new Event("keyup");e.code="Delete",document.dispatchEvent(e)}),$(".lc-pick-tool[title='Text'], .lc-pick-tool[title='SelectShape']").on("click",function(){$(".canvas-controls").prepend(r)}),$(".lc-pick-tool:not([title='Text']):not([title='SelectShape'])").on("click",function(){$(".delete-tool").detach()}),$(".lc-undo").removeAttr("style").append($("<span>").addClass("fa fa-reply")),$(".lc-redo").removeAttr("style").append($("<span>").addClass("fa fa-share")),$(".lc-zoom-out").removeAttr("style").append($("<span>").addClass("fa fa-search-minus")),$(".lc-zoom-in").removeAttr("style").append($("<span>").addClass("fa fa-search-plus")),h.lc.opts.penMode=null!==m.getGlobalItem("penMode")?m.getGlobalItem("penMode"):h.lc.opts.penMode,$('.lc-pick-tool[title="Eraser"]').removeAttr("style").append('<span class="fa fa-eraser"></span>'),$('.lc-pick-tool[title="Text"]').removeAttr("style").append('<span class="fa fa-font"></span>'),$('.lc-pick-tool[title="Pencil"]').removeAttr("style").append('<span class="fa fa-pencil"></span>'),$('.lc-pick-tool[title="Line"]').removeAttr("style").append("<span></span>"),$('.lc-pick-tool[title="Pan"]').removeAttr("style").append('<span class="fa fa-arrows"></span>'),$('.lc-pick-tool[title="SelectShape"]').removeAttr("style").append('<span class="fa fa-mouse-pointer"></span>'),s(),function(){var e,t,A='<div class="lc-pick-tool toolbar-button thin-button color-selector"><div></div></div>',n=$(A).addClass("black").on("click touchstart",{color:"black"},c),o=$(A).addClass("gray").on("click touchstart",{color:"gray"},c),a=$(A).addClass("silver").on("click touchstart",{color:"silver"},c),i=$(A).addClass("red").on("click touchstart",{color:"red"},c),r=$(A).addClass("green").on("click touchstart",{color:"green"},c),s=$(A).addClass("blue").on("click touchstart",{color:"blue"},c);n.attr("title","Black"),o.attr("title","Gray"),a.attr("title","Silver"),i.attr("title","Red"),r.attr("title","Green"),s.attr("title","Blue"),$(".lc-picker-contents").append(n),$(".lc-picker-contents").append(o),$(".lc-picker-contents").append(a),$(".lc-picker-contents").append(i),$(".lc-picker-contents").append(r),$(".lc-picker-contents").append(s),h.isMobile||(e=$(A).addClass("yellow").on("click touchstart",{color:"yellow"},c),t=$(A).addClass("fuchsia").on("click touchstart",{color:"fuchsia"},c),e.attr("title","Yellow"),t.attr("title","Fuchsia"),$(".lc-picker-contents").append(e),$(".lc-picker-contents").append(t))}(),function(){var e=$('<div class="lc-pick-tool toolbar-button thin-button" title="Image"><span class="fa fa-image"></span></div>');$(".lc-pick-tool[title='Text']").after(e),e.on("click",h.startSelectImage)}(),$(".horz-toolbar").each(function(){a.observe(this,{childList:!0})}),l()}(),a.addEventListener?(a.addEventListener("resize",S),a.addEventListener("orientationchange",S)):a.attachEvent&&a.attachEvent("resize",S),S(),b()}function f(e){var t=new FileReader;t.onload=function(){var o=new Image;o.onload=function(){var e,t,A=a.LC.createShape("ImageWithRotate",{x:10,y:10,image:o});A.image.height>A.image.width?A.image.height>h.canvasSize.height&&(e=.8*h.canvasSize.height,A.scale=e/A.image.height):A.image.width>h.canvasSize.width&&(t=.8*h.canvasSize.width,A.scale=t/A.image.width),h.lc.saveShape(A,!0),$(".select-image").val(null),$(".lc-pick-tool[title='SelectShape']").trigger("click");var n=new a.LC.tools.SelectShape(h.lc);h.lc.setTool(n),n.setCurrentShape(h.lc,A)},A.isAutoOrientationSupported().then(function(e){if(e)o.src=t.result;else try{o.src=a.piexif.remove(t.result)}catch(e){console.error(e),o.src=t.result}})},t.readAsDataURL(e)}function C(e){var t=(e.clipboardData||e.originalEvent.clipboardData).items,A=i.find(t,function(e){return e.type.includes("image")});A&&A.kind&&A.type&&I(A)&&f(A.getAsFile())}function I(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!==n.indexOf(t)}function E(){return h.lc.tool&&h.lc.tool.commit&&h.lc.tool.commit(h.lc),!(!h.isDirty&&!c._isDirty)}function b(){return!!h.snapshotLoaded&&(w(),B(),h.canvasReady=!0,$(".lc-pick-tool[title='Pencil']").trigger("click"),$(".lc-picker .toolbar-button.color-selector.black").trigger("click"),d(M,0),document.addEventListener("pointerover",v),!0)}function v(e){e.preventDefault(),!1===h.penDetected&&"pen"===e.pointerType&&(h.penDetected=!0,m.setGlobalItem("penDetected",!0),h.lc.opts.penMode=!0,d(T,0),h.showPenModeTooltip=!0,document.removeEventListener("pointerover",v))}function B(){h.unsubscribeClickTouchEvent&&h.unsubscribeClickTouchEvent(),h.lc&&(h.unsubscribeClickTouchEvent=h.lc.on("drawStart",Q))}function Q(){d(function(){h.onFocus()},0)}function w(){h.unsubscribeDrawEvent&&h.unsubscribeDrawEvent(),h.lc&&(h.unsubscribeDrawEvent=h.lc.on("drawingChange",function(){c._isDirty=!0,d(function(){h.isDirty=!0},0)}))}function y(){h.unsubscribeDrawEvent&&h.unsubscribeDrawEvent()}function N(){a.removeEventListener("resize",S),a.removeEventListener("orientationchange",S)}function S(){var e=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(e&&t)return d(A,100);function A(){var e,t=$(".lc-drawing > canvas")[1];t&&(e=t.width/h.lc.backingScale/h.canvasSize.width,h.lc.setZoom(e),h.lc.setPan(0,0),!h.showFullscreenTooltip&&h.shouldShowFullscreenTooltip&&(h.showFullscreenTooltip=h.shouldShowFullscreenTooltip,h.shouldShowFullscreenTooltip=!1))}A()}function T(){m.setGlobalItem("penMode",h.lc.opts.penMode)}function D(){return h.lc.getImage({includeWatermark:!1,scale:3,rect:{x:0,y:0,width:h.canvasSize.width,height:h.canvasSize.height}}).toDataURL()}function M(){var e;window.MSInputMethodContext&&document.documentMode?((e=window.document.createEvent("UIEvents")).initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)):window.dispatchEvent(new Event("resize"))}h._isDirty=!1,h.$onInit=function(){var A,n;h.snapshotLoaded=!1,h.canvasReady=!1,h.isMobile=s.isMobile()&&!s.isTablet(),h.shouldShowFullscreenTooltip=h.onboard||!1,h.showFullscreenTooltip=!1,h.showPenModeTooltip=!1,c._isDirty=h.isDirty,h.penDetected=null!==m.getGlobalItem("penDetected")&&m.getGlobalItem("penDetected"),u.$watch("vm.snapshotLoaded",b),A=u.$watch("vm.exports.loaded",function(e,t){t!==e&&h.exports.loaded&&h.lc&&(A(),n(),h.editorInitialized())},!0),n=u.$watch("vm.lc",function(e,t){t!==e&&h.exports.loaded&&h.lc&&(A(),n(),h.editorInitialized())},!0),u.$watch("vm.isDirty",function(e,t){t!==e&&(c._isDirty=e)},!0),h.props={imageURLPrefix:"images/notes",backgroundColor:"#fff",onInit:l,imageSize:{width:h.canvasSize.width,height:h.canvasSize.height},strokeWidths:[1,2,3,4,6,8,18],defaultStrokeWidth:1,tools:h.tools,penMode:!1},h.fullScreen?h.goFullScreen():h.exitFullScreen();h.exports.commit=function(){h.lc.tool&&h.lc.tool.commit&&h.lc.tool.commit(h.lc)}.bind(h),h.exports.forceSave=function(){h.lc.trigger("enf-force-save")}.bind(h),h.exports.hasUnsavedChanges=function(){if(E())return!0;return-1<i.findIndex(h.note.pages,"isDirty")}.bind(h),h.exports.hasUnsavedCurrentPageChanges=E.bind(h),h.exports.serializeCanvasSnapshot=function(){return JSON.stringify(h.lc.getSnapshot(["imageSize","backgroundShapes","shapes"]))}.bind(h),h.exports.getNoteDataUrl=D.bind(h),h.exports.loadSnapshot=function(e){h.snapshotLoaded=!1,h.lc.loadSnapshot(e),h.lc.undoStack=[],h.lc.setImageSize(e.imageSize.width,e.imageSize.height),h.preventEdit?r.preloadPage(h.note.pages[h.pageNumber-1]).then(function(e){h.noteDataUrl=D(),h.snapshotLoaded=!0}):h.snapshotLoaded=!0;h.hasResized||(d(M,100),h.hasResized=!0);w(),B()}.bind(h),h.exports.subscribeToDrawEvent=w.bind(h),h.exports.unsubscribeDrawEvent=y.bind(h),h.exports.subscribeToClickTouchEvent=B.bind(h),h.exports.unsubscribeClickTouchEvent=function(){h.unsubscribeClickTouchEvent&&h.unsubscribeClickTouchEvent()}.bind(h),h.exports.removeEventListeners=N.bind(h),h.exports.setImageSize=function(e,t){h.lc.setImageSize(e,t)}.bind(h),h.exports.updateNoteDataUrl=function(){h.noteDataUrl=D(),h.snapshotLoaded=!0}.bind(h),h.exports.loaded=!0,h.fileUploader=new e,h.fileUploader.filters.push({name:"imageType",fn:I}),h.fileUploader.onAfterAddingAll=function(e){f(e[0]._file)},h.fileUploader.onWhenAddingFileFailed=function(e,t){"imageType"===t.name&&o.addMessage("The file you selected is not a supported image type.","danger",!1)},document.addEventListener("paste",C)},h.$onDestroy=function(){y(),N(),document.removeEventListener("paste",C),document.removeEventListener("pointerover",v)},h.exitFullScreen=function(){t.show(),h.fullScreen=!1,$(".editor-wrapper").removeClass("fullscreen-container"),$(".full-screen-button").removeClass("fa-compress").addClass("fa-expand"),M()},h.goFullScreen=function(){t.hide(),h.fullScreen=!0,$(".editor-wrapper").addClass("fullscreen-container"),$(".full-screen-button").removeClass("fa-expand").addClass("fa-compress"),M()},h.togglePenMode=T,h.hasResized=!1,h.dismissFullScreenPopup=function(){h.shouldShowFullscreenTooltip=!1,h.showFullscreenTooltip=!1},h.dismissPenModePopup=function(){h.showPenModeTooltip=!1},this.startSelectImage=function(){h.lc.tool&&h.lc.tool.commit&&h.lc.tool.commit(h.lc),$(".select-image").trigger("click")}}angular.module("app.common").component("noteEditor",{bindings:{exports:"=",tools:"<",editorInitialized:"&",canvasSize:"=",isDirty:"=",loadingPage:"<",preventEdit:"<",pageNumber:"<",note:"<?",fullScreen:"=",onboard:"=?",onFocus:"&"},templateUrl:"common/notes/NoteEditorComponent.html",controller:e,controllerAs:"vm"}),e.$inject=["$scope","$timeout","$window","$compile","alertService","lodash","FileUploader","IntercomPositionService","notationColors","CanvasPrint","deviceDetector","ImageOrientationService","UserSettings"]}(),function(){"use strict";function e(o){var a=null;return{load:function(e,t,A,n){a&&a.abort(),a=$.getJSON(e,function(e){a=null,o(function(){t(e)},0)}).fail(function(){o(function(){A()},0)}).always(function(){o(function(){n()},0)})},cancelLoad:function(){a&&(a.abort(),a=null)}}}angular.module("app.common").service("SafeLoadNotePage",e),e.$inject=["$timeout"]}(),function(){"use strict";angular.module("app.common").factory("GuidGenerator",function(){for(var o=[],e=0;e<256;e++)o[e]=(e<16?"0":"")+e.toString(16);return{newGuid:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,A=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return o[255&e]+o[e>>8&255]+o[e>>16&255]+o[e>>24&255]+"-"+o[255&t]+o[t>>8&255]+"-"+o[t>>16&15|64]+o[t>>24&255]+"-"+o[63&A|128]+o[A>>8&255]+"-"+o[A>>16&255]+o[A>>24&255]+o[255&n]+o[n>>8&255]+o[n>>16&255]+o[n>>24&255]}}})}(),function(){"use strict";function e(e,t,n,A){var o=this;o.imageUrl=null,o.isAvailable=!1,o.errorOccured=!1,o.$onInit=function(){var A=o.notePageId||o.noteId;n.getSettings().then(function(e){var t;e.thumbnailsAvailable?(t=e.thumbnailUriFormat,o.imageUrl=t.replace("{thumbnailId}",A+".jpg")):o.imageUrl="/images/thumbnail-error.png"})},o.imgLoaded=function(){t(function(){o.isAvailable=!0},0)},o.imgLoadError=function(){if(o.imageUrl=null,o.isAvailable=!1,o.errorOccured=!1,1<o.loadErrorCount)return void(o.errorOccured=!0);o.loadErrorCount++;var e="/api";"quickNote"===o.noteType?e+="/quicknotes/"+o.noteId+"/thumbnail":e+="/contacts/"+o.contactId+"/notes/"+o.noteId+"/thumbnail";o.notePageId&&(e+="/pages/"+o.notePageId);A.enqueue(e).then(function(e){var t=URL.createObjectURL(e.data);o.imageUrl=t,o.isAvailable=!0}).catch(function(){o.imageUrl="/images/thumbnail-error.png"})},o.loadErrorCount=0}angular.module("app.common").component("noteThumbnail",{templateUrl:"common/ThumbnailComponent.html",controller:e,bindings:{contactId:"<?",noteType:"<",noteId:"<",notePageId:"<?"}}),e.$inject=["$http","$timeout","AppContext","thumbnailGenerator"]}(),function(){"use strict";function e(A,t,n){var o=0;function a(e){return o++,t.get(e,{responseType:"blob"}).finally(i)}function i(){o--,n.processNext()}return{enqueue:function(e){if(1<=o){var t=A.defer();return n.enqueue(t),t.promise.then(function(){return a(e)})}return a(e)}}}angular.module("app.common").factory("thumbnailGenerator",e).factory("thumbnailBuffer",function(){var t=[];return{enqueue:function(e){return t.push(e)},processNext:function(){0<t.length&&t.shift().resolve()}}}),e.$inject=["$q","$http","thumbnailBuffer"]}(),function(){"use strict";function e(e){e.state("onboardingTutorial",{url:"/onboarding-tutorial",parent:"root",controller:["$state","OnboardingTutorialApi",function(A,n){n.getSampleNote().then(function(e){var t={id:e.id,noteId:e.noteId,fullScreen:!1,onboarding:!0};A.go("app.contacts.view.notes.edit",t).then(function(){n.setTutorialComplete()})})}],templateUrl:"onboarding/TutorialLoading.html"}).state("syncContacts",{url:"/sync-contacts?force",params:{redirectStateName:null,force:null},parent:"root",controller:"SyncContactsController",templateUrl:"onboarding/SyncContacts.html"}).state("welcome",{url:"/welcome?id&fullScreen&onboard",params:{id:null,fullScreen:null,onboard:null,token:null,shareflag:null,redirectStateName:null},parent:"root",templateUrl:"onboarding/Onboarding.html",controller:"OnboardingController",controllerAs:"onboardCtrl",resolve:{onboardingData:["OnboardingApi",function(e){return e.get()}]}}).state("logosetup",{url:"/setup-logo?id&fullScreen&onboard&requiresContactSync",params:{id:null,fullScreen:null,onboard:null,token:null,shareflag:null,redirectStateName:null,requiresContactSync:null},parent:"root",templateUrl:"onboarding/OnboardingLogo.html",controller:"OnboardingLogoController",controllerAs:"onboardLogoCtrl",resolve:{onboardingData:["OnboardingApi",function(e){return e.get()}]}})}angular.module("app.onboarding",["ngResource","angularFileUpload"]).config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";function e(t){var A="/api/organization/onboarding";return{get:function(){return t.get(A).then(function(e){return e.data})},lightTouchSave:function(e){return t.post(A+"/light-touch",e).then(function(e){return e.data})},syncContacts:function(e){return t.post("/api/contacts/synchronize?forceResync="+e,null,{timeout:6e5}).then(function(e){return e.data})}}}angular.module("app.onboarding").service("OnboardingApi",e),e.$inject=["$http"]}(),function(){"use strict";function e(t,A,n,e,o,a,i,r,s,c,l,u){var d=this;d.showValidationMessage=!1,d.countryChanged=function(t){var A,e,n=u.find(function(e){return e["ISO3166-1-Alpha-2"]===t});n&&(A=n.Languages.split(",")[0].toLowerCase(),e=r.find(d.locales,function(e){return e.code===A}),d.locale=e||d.locales.find(function(e){return"en-001"===e.code}))},d.save=function(){if(!t.onboardForm.$invalid){d.organization.timeZoneId=d.timeZone.id;var e={countryCode:d.organization.countryCode,timeZoneId:d.timeZone.id,locale:d.locale.code};return o.lightTouchSave(e).then(function(e){return c.setLocale(),l.completeOnboarding(),A.go("logosetup",{fullScreen:!1,tour:!0,onboard:!0,requiresContactSync:e.requiresContactSync})})}d.showValidationMessage=!0},function(){d.organization=a.organization,d.timeZones=a.timeZones,d.locales=a.locales;var e=i.tz.guess();d.timeZone=r.find(d.timeZones,{ianaTimezone:e}),d.timeZone||(d.timeZone=r.find(d.timeZones,{id:d.organization.timeZoneId})),s.get().$promise.then(function(e){d.ipCountryCode=e.country,d.organization.countryCode=e.country;var t,A=u.find(function(e){return e["ISO3166-1-Alpha-2"]===d.organization.countryCode});A&&(t=A.Languages.split(",")[0].toLowerCase(),d.locale=r.find(d.locales,function(e){return e.code===t})),d.locale||(d.locale=r.find(d.locales,function(e){return e.code===navigator.language.toLowerCase()})),d.locale||(d.locale=r.find(d.locales,function(e){return"en-001"===e.code})),d.countryChanged(e.country)}),t.$watch("organization.countryCode",d.countryChanged,!0),d.countryChanged(d.organization.countryCode),n.gtag&&n.gtag("event","conversion",{send_to:"AW-635028636/NGaMCKuaxtoBEJyJ564C"})}()}angular.module("app.onboarding").controller("OnboardingController",e),e.$inject=["$scope","$state","$window","$stateParams","OnboardingApi","onboardingData","moment","lodash","IpCountryLookupService","AppContext","AppInitializer","iso3166"]}(),function(){"use strict";angular.module("app.onboarding").controller("OnboardingLogoController",e),e.$inject=["$scope","$state","$stateParams","onboardingData","AuthService","FileUploader"];var r="e3ad130361074e2b91db4850072fea3d.gif",s=new File([71,73,70,56,57,97,1,0,1,0,128,0,0,255,255,255,0,0,0,33,249,4,1,0,0,0,0,44,0,0,0,0,1,0,1,0,0,2,2,68,1,0,59],r,{type:"image/gif"});function e(e,t,A,n,o,a){var i=this;i.showValidationMessage=!1,i.pageNames=[{id:"whiteLined",name:"Lined"},{id:"whiteBlank",name:"Blank (No Lines)"},{id:"yellowLined",name:"Yellow Lined"},{id:"bodyModel",name:"Body Model"},{id:"schoolNotebook",name:"School Notebook"},{id:"graphPage",name:"Graph Paper"},{id:"dotGridPage",name:"Dot Grid"}],i.pageSelected="",i.pageSelectedThumbnail="",i.changePageSelection=function(){i.template.pageSelection=i.pageSelected.id,i.pageSelectedThumbnail="/images/examplethumbnail-"+i.pageSelected.id+".png"},i.filename=null,i.progress=0,i.uploadingStarted=!1,i.mimeTypeSupported=!0,i.template={pageSelection:""},i.validMimeTypes=["image/gif","image/png","image/jpeg","image/jpg"],i.isUploading=function(){return i.progress<100},i.isValidFile=function(e){return!e||(e.size<=0&&(i.zerobytefile=!0),0<e.size)},i.save=function(){e.logoSetupForm.$invalid?i.showValidationMessage=!0:(i.uploader.formData=[],i.uploader.onCompleteAll=function(){i.continue()},i.uploader.uploadAll())},i.continue=function(){return"true"===A.requiresContactSync?t.go("syncContacts"):A.redirectStateName?t.go(A.redirectStateName,A):t.go("app.quick-notes.createNote",{fullScreen:!1,tour:!0,onboard:!0})},i.organization=n.organization,i.pageSelected=i.pageNames[0],i.uploader=new a({url:"/api/note-templates/onboarding",headers:{Authorization:o.getAuthorizationHeaderValue(),"x-organization-id":o.getOrganizationId()},alias:"templateLogo",withCredentials:!0}),o.userContextChanged(e,function(){i.uploader.headers.Authorization=o.getAuthorizationHeaderValue()}),i.uploader.filters.push({name:"fileFilter",fn:function(e){return t=e.type,-1!==i.validMimeTypes.indexOf(t);var t}}),i.uploader.onWhenAddingFileFailed=function(){i.filename=null,i.uploader.addToQueue(s),i.mimeTypeSupported=!1},i.uploader.onBeforeUploadItem=function(e){e.formData.push(i.template),i.uploadingStarted=!0,i.progress=0},i.uploader.onSuccessItem=function(){},i.uploader.onProgressAll=function(e){i.progress=e},i.uploader.onErrorItem=function(e,t){console.error(t),i.uploadError=!0},i.uploader.onAfterAddingFile=function(e){i.template.file=e.file,e.file.name===r?i.filename="":i.filename=e.file.name,i.template.fileSizeBytes=e.file.size,i.mimeTypeSupported=!0;for(var t=i.uploader.queue.length-1;0<=t;t--){var A=i.uploader.queue[t];A!==e&&i.uploader.removeFromQueue(A)}},i.uploader.addToQueue(s),i.changePageSelection()}}(),function(){"use strict";function e(e){var t="/api/onboarding-tutorial";return{getSampleNote:function(){return e.post(t+"/get-sample-note").then(function(e){return e.data})},removeSampleData:function(){return e.delete(t+"/remove-data")},setTutorialComplete:function(){return e.put(t+"/complete")}}}angular.module("app.onboarding").service("OnboardingTutorialApi",e),e.$inject=["$http"]}(),function(){"use strict";function e(t,A,n,e,o,a){var i;n.isSyncingContacts||(n.isSyncingContacts=!0,i=A.force||!1,o.syncContacts(i).then(function(){e.completeContactSync(),n.getSettings(!1).then(function(){return a.addMessage("Contacts synchronized successfully","info",!0),n.isSyncingContacts=!1,A.redirectStateName?t.go(A.redirectStateName,A):i?t.go("app.contacts"):t.go("app.quick-notes.createNote",{fullScreen:!1,tour:!0,onboard:!0})})}).catch(function(e){return console.error(e),n.isSyncingContacts=!1,a.addMessage("An error occured while synchronizing Xero Contacts. Please contact support.","danger",!0),A.redirectStateName?t.go(A.redirectStateName,A):i?t.go("app.contacts"):t.go("app.quick-notes.createNote",{fullScreen:!1,tour:!0,onboard:!0})}))}angular.module("app.onboarding").controller("SyncContactsController",e),e.$inject=["$state","$stateParams","AppContext","AppInitializer","OnboardingApi","alertService"]}(),function(){"use strict";function e(e){var o,n=null,i=null,A=null,a=null,r=null,s=null,c=null,l=null;e.state("app.contacts",{url:"/contacts",views:{"content@app":{templateUrl:"contacts/ContactList.html",controller:"ContactListController",controllerAs:"listCtrl"}},data:{pageTitle:"Contacts"},resolve:{orgSettings:["AppContext",function(e){return e.getSettings()}],contactTypes:["ContactTypeApi",function(e){return e.getContactTypes(!0).then(function(e){return e.data})}]}}).state("app.contacts.openByImportId",{url:"/open?id",onEnter:["$state","$stateParams","ContactsApi",function(t,e,A){A.getContactIdByImportId({id:e.id}).$promise.then(function(e){return t.go("app.contacts.view.notes",{id:e.id})}).catch(function(){return t.go("app.contacts")})}]}).state("app.contacts.newNoteByImportId",{url:"/new?id",onEnter:["$state","$stateParams","ContactsApi",function(t,e,A){A.getContactIdByImportId({id:e.id}).$promise.then(function(e){return t.go("app.contacts.view.notes.add",{id:e.id})}).catch(function(){return t.go("app.contacts")})}]}).state("app.contacts.create",{url:"/create",onEnter:["$state","$uibModal","ContactTypeApi",function(e,t,A){(n=t.open({templateUrl:"contacts/CreateEditContact.html",controller:"CreateContactController",controllerAs:"editCtrl",size:"lg",backdrop:"static",resolve:{contactTypes:function(){return A.getContactTypes(!1).then(function(e){return e.data})}}})).result.then(function(){"app.contacts.create"===e.current.name&&e.go("^",null,{reload:!0})},function(){"app.contacts.create"===e.current.name&&e.go("^")})}],onExit:[function(){n&&n.dismiss()}]}).state("app.contacts.view",{url:"/{id:[0-9a-fA-F-]{36}}",views:{"content@app":{templateUrl:"contacts/ViewContact.html",controller:"ViewContactController",controllerAs:"contactCtrl"}},resolve:{orgSettings:["orgSettings",function(e){return e}],contact:["$stateParams","ContactsApi",function(e,t){return t.get({id:e.id}).$promise}],pageTitle:["contact",function(e){return e.name}]}}).state("app.contacts.view.edit",{url:"/edit",onEnter:["$stateParams","$state","$uibModal","ContactTypeApi","ContactsApi","orgSettings",function(e,t,A,n,o,a){(i=A.open({templateUrl:"contacts/CreateEditContact.html",controller:"EditContactController",controllerAs:"editCtrl",size:"lg",backdrop:"static",resolve:{contact:function(){return o.get({id:e.id}).$promise},organization:function(){return a},contactTypes:function(){return n.getContactTypes(!1).then(function(e){return e.data})}}})).result.then(function(){"app.contacts.view.edit"===t.current.name&&t.go("^",null,{reload:!0})},function(){"app.contacts.view.edit"===t.current.name&&t.go("^")})}],onExit:[function(){i&&i.dismiss()}]}).state("app.contacts.createNoteFromTemplate",{url:"/create-note/{noteTemplateId:[0-9a-fA-F-]{36}}",data:{pageTitle:"Create Note"},onEnter:["$window","$state","$stateParams","$uibModal","orgSettings",function(e,t,A,n,o){(l=n.open({templateUrl:"contacts/notes/SelectContact.html",controllerAs:"vm",controller:"SelectContactController",backdrop:"static",size:"lg",resolve:{organization:function(){return o},noteTemplateId:[function(){return A.noteTemplateId}]}})).result.then(function(e){"app.contacts.createNoteFromTemplate"===t.current.name&&t.go("app.contacts.view.notes.edit",{id:e.contactId,note:e.note,noteId:e.note.id})},function(){"app.contacts.createNoteFromTemplate"===t.current.name&&e.history.back()})}],onExit:[function(){l&&(l.dismiss(),l=null)}]}).state("app.contacts.createNote",{url:"/create-note",data:{pageTitle:"Create Note"},onEnter:["$window","$state","$transition$","$uibModal","orgSettings",function(e,t,A,n,o){(a=n.open({templateUrl:"contacts/notes/SelectContactAndNoteTemplate.html",controllerAs:"selectCtrl",controller:"SelectContactAndNoteTemplateController",backdrop:"static",size:"lg",resolve:{organization:function(){return o},noteTemplates:["NoteTemplatesApi",function(e){return e.getListWithDataUrls({pageNumber:1,pageSize:8,sortOrder:"name asc"}).$promise}],contactId:[function(){return t.includes("app.contacts.view")?A.router.globals.params.id:null}]}})).result.then(function(e){"app.contacts.createNote"===t.current.name&&t.go("app.contacts.view.notes.edit",{id:e.contactId,note:e.note,noteId:e.note.id})},function(){"app.contacts.createNote"===t.current.name&&e.history.back()})}],onExit:[function(){a&&(a.dismiss(),a=null)}]}).state("app.contacts.view.notes",{url:"/notes",views:{"content@app":{templateUrl:"contacts/notes/NotesList.html",controller:"NotesListController",controllerAs:"vm"}},resolve:{orgSettings:["orgSettings",function(e){return e}],contact:["$stateParams","ContactsApi",function(e,t){return t.get({id:e.id}).$promise}]}}).state("app.contacts.view.notes.add",{url:"/select-template",onEnter:["$window","$state","$stateParams","$uibModal",function(e,t,A,n){o="app.contacts.newNoteByImportId"===t.current.name,(c=n.open({templateUrl:"contacts/notes/SelectNoteTemplate.html",controllerAs:"selectCtrl",controller:"SelectNoteTemplateController",backdrop:"static",size:"lg",resolve:{contact:["ContactsApi",function(e){return e.get({id:A.id}).$promise}],noteTemplates:["NoteTemplatesApi",function(e){return e.getListWithDataUrls({pageNumber:1,pageSize:8,sortOrder:"name asc"}).$promise}]}})).result.then(function(e){"app.contacts.view.notes.add"===t.current.name&&t.go("^.edit",{note:e.note,noteId:e.note.id})},function(){"app.contacts.view.notes.add"===t.current.name&&(o?t.go("^"):e.history.back())})}],onExit:[function(){c&&c.dismiss()}]}).state("app.contacts.view.notes.edit",{url:"/{noteId:[0-9a-fA-F-]{36}}?onboarding",params:{note:null,fullScreen:null,onboarding:null},views:{"content@app":{templateUrl:"contacts/notes/EditNote.html",controller:"EditNoteController",controllerAs:"editCtrl"}},resolve:{note:["$stateParams","NotesApi","lodash",function(e,t,A){return e.note?(e.note.pages=A.sortBy(e.note.pages,"sequence"),e.note):t.get({contactId:e.id,id:e.noteId}).$promise.then(function(e){return e.pages=A.sortBy(e.pages,"sequence"),e})}]}}).state("app.contacts.view.attachments",{url:"/attachments",views:{"content@app":{templateUrl:"contacts/attachments/AttachmentsList.html",controller:"AttachmentsListController",controllerAs:"listCtrl"}},resolve:{orgSettings:["orgSettings",function(e){return e}],contact:["$stateParams","ContactsApi",function(e,t){return t.get({id:e.id}).$promise}]}}).state("app.contacts.view.attachments.add",{url:"/add",onEnter:["$state","$uibModal","contact",function(e,t,A){(r=t.open({controller:"AddAttachmentController",controllerAs:"modalCtrl",templateUrl:"contacts/attachments/AddAttachment.html",backdrop:"static",resolve:{contact:function(){return A}}})).result.then(function(){"app.contacts.view.attachments.add"===e.current.name&&e.go("^",null,{reload:!0})},function(){"app.contacts.view.attachments.add"===e.current.name&&e.go("^")})}],onExit:function(){r&&r.dismiss()},resolve:{contact:["$stateParams","ContactsApi",function(e,t){return t.get({id:e.id}).$promise}]}}).state("app.contacts.view.attachments.view",{url:"/{attachmentId:[0-9a-fA-F-]{36}}",onEnter:["$state","$uibModal","attachment","contact",function(A,e,t,n){(s=e.open({controller:"ViewAttachmentController",controllerAs:"modalCtrl",templateUrl:"contacts/attachments/ViewAttachment.html",backdrop:"static",resolve:{attachment:function(){return t},contact:function(){return n}}})).result.then(function(e){var t="refresh"===e?!0:!1;"app.contacts.view.attachments.view"===A.current.name&&A.go("^",null,{reload:t})},function(){"app.contacts.view.attachments.view"===A.current.name&&A.go("^")})}],onExit:function(){s&&s.dismiss()},resolve:{contact:["$stateParams","ContactsApi",function(e,t){return t.get({id:e.id}).$promise}],attachment:["$stateParams","AttachmentsApi",function(e,t){return t.get({contactId:e.id,id:e.attachmentId}).$promise}]}}).state("app.contacts.import",{url:"/import",data:{pageTitle:"Import Contacts",authorizeRoles:"Owners,Admins"},onEnter:["$state","$uibModal",function(e,t){(A=t.open({templateUrl:"contacts/ContactImport.html",controller:"ContactImportController",controllerAs:"modalCtrl",backdrop:"static"})).result.then(function(){"app.contacts.import"===e.current.name&&e.go("^",null,{reload:!0})},function(){"app.contacts.import"===e.current.name&&e.go("^",null,{reload:!0})})}],onExit:[function(){A&&A.dismiss()}]})}angular.module("app.contacts",[]).config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";angular.module("app.contacts").factory("ContactsApi",["$resource",function(e){return e("/api/contacts/:id",{id:"@id"},{query:{isArray:!1,cancellable:!0},get:{method:"GET"},add:{method:"POST"},save:{method:"PUT"},activate:{method:"PUT",url:"/api/contacts/:id/activate"},deactivate:{method:"DELETE",url:"/api/contacts/:id"},exportContactsCsv:{method:"GET",url:"/api/contacts/export"},getContactIdByImportId:{method:"GET",url:"/api/contacts/from-importid?id=:id"},syncContacts:{method:"POST",url:"/api/contacts/synchronize"}})}])}(),function(){"use strict";function e(e){var t=this;return t.contactTypeKeyExists=!1,t.selectedContactTypes=null,t.selectedContactTypeChanged=function(){e.setItem("contacts:selectedContactTypes",t.selectedContactTypes)},e.getItem("contacts:selectedContactTypes")&&(t.contactTypeKeyExists=!0),t.selectedContactTypes=e.getItem("contacts:selectedContactTypes")||[],t}angular.module("app.contacts").factory("ContactTypeView",e),e.$inject=["UserSettings"]}(),function(){"use strict";function e(n,t,A,o,a,l,u,i,r,s){var d=this;d.isInitialized=!1;var p=null;function g(e){return o.map(e,function(e){return e.id})}d.$onInit=function(){d.query="",d.includeInactive=!1,d.sortOrder=function(e){var t=e.split(" "),A={property:t[0],ascending:!0};"desc"===t[1]&&(A.ascending=!1);return A}("name asc"),d.orgSettings=i,d.contactTypes=s;var e=r.getItem("contacts:selectedContactTypes"),t=r.getItem("contacts:previousContactTypesList"),A=o.sortBy(g(d.contactTypes)).toString();t===A&&e&&0!==e.length||(d.values=g(d.contactTypes),r.setItem("contacts:selectedContactTypes",d.values),e=d.values),d.selectedContactTypes=o.map(e,function(t){return o.find(d.contactTypes,function(e){return e.id===t})}),r.setItem("contacts:previousContactTypesList",A),n.$watch(function(){return d.query},function(e,t){e!==t&&d.reloadData(1,50,d.sortOrder,e,d.selectedContactTypes,d.includeInactive)}),n.$watchCollection(function(){return d.selectedContactTypes},function(){var e;e=g(d.selectedContactTypes),r.setItem("contacts:selectedContactTypes",e),d.reloadData(1,50,d.sortOrder,d.query,d.selectedContactTypes,d.includeInactive)}),a.bindTo(n).add({combo:"esc",allowIn:["INPUT"],description:"Clears the search",callback:d.clearSearch,persistent:!1}),d.reloadData(1,50,d.sortOrder,"",d.selectedContactTypes,d.includeInactive)},d.getSelectedContactTypesOverview=function(){return d.selectedContactTypes.length===d.contactTypes.length||0===d.selectedContactTypes.length?"All":d.selectedContactTypes.length+"/"+d.contactTypes.length},d.newContact=function(){A.go(".create",{})},d.clearSearch=function(e){e.preventDefault(),d.query=""},d.exportContacts=function(){u.exportContactsCsv({},function(e){t.download("data:text/csv;base64,"+e.data,"Contacts.csv","text/csv")})},d.viewContact=function(e){A.go(".view.notes",{id:e.id})},d.addContactNote=function(e){A.go(".view.notes.add",{id:e.id})},d.reloadData=function(e,t,A,n,o,a){null!==p&&p.$cancelRequest(),d.isLoading=!0;var i,r,s=g(o),c={pageNumber:e,pageSize:t,sortOrder:(r=(i=A).ascending?"asc":"desc",i.property+" "+r),search:n,selectedContactTypes:s,includeInactive:a};p=u.query(c,function(e){d.pagedItems=e,d.isLoading=!1,d.isInitialized=!0},function(e){-1!==e.status&&(d.isLoading=!1,l.addMessage("An error occured with searching. Please try again.","danger",!1))})},d.includeInactiveChanged=function(){d.reloadData(1,50,d.sortOrder,d.query,d.selectedContactTypes,d.includeInactive)},d.pageChanged=function(){return d.reloadData(d.pagedItems.pageNumber,d.pagedItems.pageSize,d.sortOrder,d.query,d.selectedContactTypes,d.includeInactive)},d.orderBy=function(e){return d.sortOrder.property===e?d.sortOrder.ascending=!d.sortOrder.ascending:(d.sortOrder.property=e,d.sortOrder.ascending=!0),d.reloadData(1,d.pagedItems.pageSize,d.sortOrder,d.query,d.selectedContactTypes,d.includeInactive)},d.getHeaderClasses=function(e){var t="";return d.sortOrder.property===e&&(t="sorting ",t+=d.sortOrder.ascending?"sorting_asc":"sorting_desc"),t},d.search=function(){return d.reloadData(1,d.pagedItems.pageSize,d.sortOrder,d.query,d.selectedContactTypes,d.includeInactive)}}angular.module("app.contacts").controller("ContactListController",e),e.$inject=["$scope","$window","$state","lodash","hotkeys","alertService","ContactsApi","orgSettings","UserSettings","contactTypes"]}(),function(){"use strict";function e(t,A,n,o,e,a){var i=this;i.$onInit=function(){i.showValidationMessage=!1,i.showDuplicateMessage=!1,i.mode="create",i.title="Add Contact",i.phoneNumberTypes=["Mobile","Home","Work","Business - Fax","Home - Fax","Pager","Assistant","Reception"],i.contact={title:"",firstName:"",lastName:"",name:"",email:"",phoneNumber1:"",phoneNumber2:"",phoneNumber3:"",phoneNumber4:"",phoneNumberType1:"",phoneNumberType2:"",phoneNumberType3:"",phoneNumberType4:"",addressLine1:"",addressLine2:"",suburb:"",state:"",country:"",postCode:"",notes:"",contactTypeId:""},i.contactTypes=e,i.create=!0,i.internalContactTypes=a.filter(e,function(e){return"OTHER"===e.contactTypeCode}),i.isEditableField=i.isSaveSafe=0<i.internalContactTypes.length,1===e.length&&(i.contact.contactTypeId=e[0].id,i.contact.contactType=e[0])},this.save=function(){if(!t.addForm.$invalid){i.showValidationMessage=!1;var e={name:i.contact.name,title:i.contact.title,firstName:i.contact.firstName,lastName:i.contact.lastName,email:i.contact.email,phoneNumber1:i.contact.phoneNumber1,phoneNumber2:i.contact.phoneNumber2,phoneNumber3:i.contact.phoneNumber3,phoneNumber4:i.contact.phoneNumber4,phoneNumberType1:i.contact.phoneNumberType1,phoneNumberType2:i.contact.phoneNumberType2,phoneNumberType3:i.contact.phoneNumberType3,phoneNumberType4:i.contact.phoneNumberType4,addressLine1:i.contact.addressLine1,addressLine2:i.contact.addressLine2,suburb:i.contact.suburb,state:i.contact.state,country:i.contact.country,postCode:i.contact.postCode,notes:i.contact.notes,contactTypeId:i.contact.contactType.id};return o.add(e).$promise.then(function(e){n.addMessage("Contact added successfully.","success",!0),A.close(e.id)}).catch(function(e){409===e.status?i.showDuplicateMessage=!0:i.showDuplicateMessage=!1})}i.showValidationMessage=!0},this.close=function(){A.dismiss()}}angular.module("app.contacts").controller("CreateContactController",e),e.$inject=["$scope","$uibModalInstance","alertService","ContactsApi","contactTypes","lodash"]}(),function(){"use strict";function e(e,t,A,n,o){var a=this;function i(e,t,A){var n=e||"";return 0<n.length&&(n=t+o.escapeHtml(e)+A),n}this.$onInit=function(){var e,t;this.hasStripeAccount=n.hasStripeAccount,this.contactId=A.id,this.contact=A,this.orgSettings=n,this.isStandaloneOrganization=!n.isXeroOrganization,this.isEditable="OTHER"===A.contactType.contactTypeCode,a.model={contactAddress:"",contactPhones:""},e=A,a.model.contactAddress=i(e.addressLine1,"","")+i(e.addressLine2,",<br>","")+i(e.suburb,",<br>","")+i(e.state," ","")+i(e.postCode," ","")+i(e.country," ",""),t=A,a.model.contactPhones=i(t.phoneNumber1,"","")+i(t.phoneNumberType1," (",")")+i(t.phoneNumber2,"<br>","")+i(t.phoneNumberType2," (",")")+i(t.phoneNumber3,"<br>","")+i(t.phoneNumberType3," (",")")+i(t.phoneNumber4,"<br>","")+i(t.phoneNumberType4," (",")"),this.orgHasBillingInfo=n.subscription.hasBillingInfo},this.editContact=function(){e.go(".edit",{id:a.contact.id})},this.activate=function(){t.activate({id:a.contact.id},function(){a.contact.isActive=!0,e.go(".view.notes",{id:a.contact.id})})},this.deactivate=function(){t.deactivate({id:a.contact.id},function(){a.contact.isActive=!1})}}angular.module("app.contacts").controller("ViewContactController",e),e.$inject=["$state","ContactsApi","contact","orgSettings","HtmlEscaper"]}(),function(){"use strict";function e(t,A,n,o,e,a,i,r){var s=this;s.$onInit=function(){s.showValidationMessage=!1,s.showDuplicateMessage=!1,s.mode="edit",s.title="Edit Contact",s.phoneNumberTypes=["Mobile","Home","Work","Business - Fax","Home - Fax","Pager","Assistant","Reception"],s.contact=a,s.contact.contactTypeId=a.contactType.id,s.contactTypes=e,s.internalContactTypes=r.filter(e,function(e){return"OTHER"===e.contactTypeCode}),s.isIntegratedDisableElm=i.isXeroOrganization||!1,s.isEditableField="OTHER"===a.contactType.contactTypeCode,s.isSaveSafe=!0},this.save=function(){if(!t.addForm.$invalid){s.showValidationMessage=!1;var e={id:s.contact.id,name:s.contact.name,title:s.contact.title,firstName:s.contact.firstName,lastName:s.contact.lastName,email:s.contact.email,phoneNumber1:s.contact.phoneNumber1,phoneNumber2:s.contact.phoneNumber2,phoneNumber3:s.contact.phoneNumber3,phoneNumber4:s.contact.phoneNumber4,phoneNumberType1:s.contact.phoneNumberType1,phoneNumberType2:s.contact.phoneNumberType2,phoneNumberType3:s.contact.phoneNumberType3,phoneNumberType4:s.contact.phoneNumberType4,addressLine1:s.contact.addressLine1,addressLine2:s.contact.addressLine2,suburb:s.contact.suburb,state:s.contact.state,country:s.contact.country,postCode:s.contact.postCode,notes:s.contact.notes,contactTypeId:s.contact.contactType.id};return o.save(e).$promise.then(function(e){n.addMessage("Contact saved successfully.","success",!0),A.close(e.id)}).catch(function(e){409===e.status?s.showDuplicateMessage=!0:s.showDuplicateMessage=!1})}s.showValidationMessage=!0},this.close=function(){A.dismiss()}}angular.module("app.contacts").controller("EditContactController",e),e.$inject=["$scope","$uibModalInstance","alertService","ContactsApi","contactTypes","contact","organization","lodash"]}(),function(){"use strict";function e(e,t,A,n,o){var a=this;a.exampleCsv="data:text/csv;base64,"+btoa("ImportId,Name,ContactTypeName,Title,FirstName,LastName,AddressLine1,AddressLine2,Suburb,PostCode,State,Country,Email,HomePhone,MobilePhone,WorkPhone,Notes"),a.filename=null,a.progress=0,a.uploadingStarted=!1,a.mimeTypeSupported=!0,o.userContextChanged(e,function(){a.uploader.headers.Authorization=o.getAuthorizationHeaderValue(),a.uploader.headers["x-organization-id"]=o.getOrganizationId()}),a.uploader=new n({url:"/api/import/contacts",headers:{Authorization:o.getAuthorizationHeaderValue(),"x-organization-id":o.getOrganizationId()},formData:[],alias:"attachmentData",withCredentials:!0}),a.uploader.onAfterAddingFile=function(e){if(a.file=e.file,a.filename=e.file.name,/(.csv)$/.test(a.filename)){a.fileSizeBytes=e.file.size,a.mimeTypeSupported=!0,a.uploadError=!1,a.errorsCsvUrl=null,a.importMessage=null,a.totalImported=null,a.totalFailed=null;for(var t=a.uploader.queue.length-1;0<=t;t--){var A=a.uploader.queue[t];A!==e&&a.uploader.removeFromQueue(A)}}else a.mimeTypeSupported=!1},a.isValidFile=function(){return!0},a.uploader.onWhenAddingFileFailed=function(e){a.filename=e.name,a.mimeTypeSupported=!1,a.uploadError=!1,a.errorsCsvUrl=null,a.importMessage=null,a.totalImported=null,a.totalFailed=null},a.uploader.onBeforeUploadItem=function(){a.uploadingStarted=!0,a.progress=0},a.uploader.onSuccessItem=function(e,t){a.uploadingStarted=!1,a.importMessage=t.importMessage||null,a.totalImported=t.totalImported,a.totalFailed=t.totalFailed,0<t.totalFailed&&(a.errorsCsvUrl="data:text/csv;base64,"+t.errorCsvB64),a.file=null,a.filename=null},a.uploader.onProgressAll=function(e){a.progress=e},a.uploader.onErrorItem=function(e,t){console.error(t),t.Message&&(a.errorMessage=t.Message),a.uploadingStarted=!1,a.uploadError=!0},a.isUploading=function(){return a.progress<100},a.downloadTemplate=function(){t.download(a.exampleCsv,"Contacts.csv","text/csv")},a.downloadErrors=function(){t.download(a.errorsCsvUrl,"ImportErrors.csv","text/csv")},a.save=function(){e.addForm.$invalid||a.uploader.uploadAll()},a.close=function(){a.uploader.cancelAll(),A.dismiss()}}angular.module("app.contacts").controller("ContactImportController",e),e.$inject=["$scope","$window","$uibModalInstance","FileUploader","AuthService"]}(),function(){"use strict";function e(o){return{require:"?ngModel",templateUrl:"contacts/SelectContactDirective.html",scope:{onSelect:"&",excludedContacts:"=?",getClear:"&?"},link:function(A,e,t,n){n&&(A.placeholder=t.placeholder||"",A.itemSelected=function(e){n.$setViewValue(e),A.ngModel=e,A.onSelect&&A.onSelect({$item:e})},n.$render=function(){A.value=n.$modelValue},A.searchContacts=function(e){if(e){var t={pageNumber:1,pageSize:20,search:e};return A.excludedContacts&&(t.excludedContacts=A.excludedContacts),o.query(t,function(e){A.contacts=e.items}).$promise}})}}}angular.module("app.contacts").directive("ncContactSelector",e),e.$inject=["ContactsApi"]}(),function(){"use strict";function e(e,t){var A=this;A.editContact=function(){e.go("app.contacts.view.edit",{id:A.contact.id})},A.activateContact=function(){t.activate({id:A.contact.id},function(){A.contact.isActive=!0})},A.deactivateContact=function(){t.deactivate({id:A.contact.id},function(){A.contact.isActive=!1})}}angular.module("app.contacts").component("appContactMenu",{templateUrl:"contacts/ContactHeaderComponent.html",controller:e,bindings:{contact:"=",isEditable:"="}}),e.$inject=["$state","ContactsApi"]}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"contacts/notes/NoteTemplateSelectorDirective.html",controller:t,bindToController:!0,controllerAs:"selectorCtrl",scope:{templateSelected:"&",initialItems:"="}}}function t(r,A,s,a){var c=this;function i(){var t=[];return c.pagedItems.items.forEach(function(i){var e=A.when($.getJSON(i.pages[0].noteDataUrl).then(function(A){function n(){var e,t;0===--o&&(e=r.LC.renderSnapshotToImage(A),t=s.findIndex(c.pagedItems.items,{id:i.id}),c.pagedItems.items[t].dataUrl=e.toDataURL(),c.pagedItems.items[t].thumbnailLoaded=!0)}var e,t,o=0,a=!1;A.shapes.forEach(function(e){var t;"ImageWithRotate"===e.className&&(a=!0,o++,(t=new Image).addEventListener("load",n),t.src=e.data.imageSrc)}),a||(e=r.LC.renderSnapshotToImage(A),t=s.findIndex(c.pagedItems.items,{id:i.id}),c.pagedItems.items[t].dataUrl=e.toDataURL(),c.pagedItems.items[t].thumbnailLoaded=!0)}));t.push(e)}),A.all(t)}this.$onInit=function(){c.pagedItems=this.initialItems,s.each(c.pagedItems.items,function(e){e.thumbnailLoaded=!1}),c.sortOrder=function(e){var t=e.split(" "),A={property:t[0],ascending:!0};"desc"===t[1]&&(A.ascending=!1);return A}("name asc"),i().then(function(){c.templatesLoaded=!0})},this.selectTemplate=function(e){c.templateSelected({template:e})},this.reloadData=function(e,t,A){var n,o;c.isLoading=!0,a.getListWithDataUrls({pageNumber:e,pageSize:t,sortOrder:(o=(n=A).ascending?"asc":"desc",n.property+" "+o)},function(e){c.pagedItems=e,s.each(c.pagedItems.items,function(e){e.thumbnailLoaded=!1}),i(),c.isLoading=!1},function(){c.isLoading=!1})},this.pageChanged=function(){return c.reloadData(c.pagedItems.pageNumber,c.pagedItems.pageSize,c.sortOrder)}}angular.module("app.contacts").directive("ncNoteTemplateSelector",e),e.$inject=[],t.$inject=["$window","$q","lodash","NoteTemplatesApi"]}(),function(){"use strict";function e(e){return e("/api/contacts/:contactId/notes/:id",{contactId:"@contactId",id:"@id",pageId:"@pageId"},{query:{isArray:!1},add:{method:"POST"},save:{method:"PUT"},delete:{method:"DELETE"},addPage:{method:"POST",url:"/api/contacts/:contactId/notes/:id/pages"},editPage:{method:"PUT",url:"/api/contacts/:contactId/notes/:id/pages/:pageId"},deletePage:{method:"DELETE",url:"/api/contacts/:contactId/notes/:id/pages/:pageId"}})}angular.module("app.contacts").factory("NotesApi",e),e.$inject=["$resource"]}(),function(){"use strict";function e(a){return{editNotePage:function(e,t,A,n){var o="/api/contacts/"+e+"/notes/"+t+"/pages/"+A;return a.put(o,n,{headers:{"Content-type":void 0},timeout:3e5})}}}angular.module("app.contacts").service("NotePageApi",e),e.$inject=["$http"]}(),function(){"use strict";function e(t,i,e,r,A,n){var s=this;s.$onInit=function(){s.sortOrder=function(e){var t=e.split(" "),A={property:t[0],ascending:!0};"desc"===t[1]&&(A.ascending=!1);return A}("modifiedDate desc"),s.isStandaloneOrganization=!A.isXeroOrganization,s.isOrderedBy=c,s.reloadData(1,50,s.sortOrder,""),o&&""!==o||(o="grid");s.pageLayout=o,a(),s.thumbnailsUnavailable=!A.thumbnailsAvailable,s.thumbnailsUnavailable&&(s.pageLayout="list")},s.contact=e,s.updatePageLayout=a;var o=n.getItem("layout:contactNotes");function a(){n.setItem("layout:contactNotes",s.pageLayout)}function c(e,t){return s.sortOrder.property===e&&s.sortOrder.ascending===("asc"===t)}this.openNote=function(e){t.go(".edit",{noteId:e.id})},this.newNote=function(){t.go(".add")},this.reloadData=function(e,t,A){s.isLoading=!0;var n,o,a=r.query({contactId:s.contact.id,pageNumber:e,pageSize:t,sortOrder:(o=(n=A).ascending?"asc":"desc",n.property+" "+o),includeInactive:!0},function(){s.pagedItems=a,s.isLoading=!1},function(){s.isLoading=!1,i.addMessage("An error occured with searching. Please try again.","danger",!1)})},this.pageChanged=function(){return s.reloadData(s.pagedItems.pageNumber,s.pagedItems.pageSize,s.sortOrder)},this.orderBy=function(e,t){return t?(s.sortOrder.property=e,s.sortOrder.ascending="asc"===t):s.sortOrder.property===e?s.sortOrder.ascending=!s.sortOrder.ascending:(s.sortOrder.property=e,s.sortOrder.ascending=!0),s.reloadData(1,s.pagedItems.pageSize,s.sortOrder)},this.getHeaderClasses=function(e){var t="";return this.sortOrder.property===e&&(t="sorting ",t+=this.sortOrder.ascending?"sorting_asc":"sorting_desc"),t}}angular.module("app.contacts").controller("NotesListController",e),e.$inject=["$state","alertService","contact","NotesApi","orgSettings","UserSettings"]}(),function(){"use strict";angular.module("app.contacts").controller("EditNoteController",e),e.$inject=["$rootScope","$window","$scope","$stateParams","$uibModal","$q","deviceDetector","alertService","NotesApi","NotePageApi","contact","note","CanvasPrint","pageTypes","SafeLoadNotePage","AppContext"];var w=1;function e(e,A,t,n,o,i,a,r,s,c,l,u,d,p,g,m){var h,f,C=this;function I(){C.loadingPage=!1}function E(e){var t;C.noteEditor.loaded&&C.noteEditor.unsubscribeDrawEvent(),t=e,"[object String]"===Object.prototype.toString.call(t)&&(e=JSON.parse(e)),e.position=void 0,e.scale=void 0,(e.colors=void 0)!==C.note.pages[C.pageNumber-1].isDirty?C.isDirty=C.note.pages[C.pageNumber-1].isDirty:C.isDirty=!1,C.note.pages[C.pageNumber-1].noteData=e,C.note.pageOrientation===w?C.canvasSize={height:C.note.paperSize.heightPoints,width:C.note.paperSize.widthPoints}:C.canvasSize={height:C.note.paperSize.widthPoints,width:C.note.paperSize.heightPoints},C.noteEditor.loaded&&C.noteEditor.loadSnapshot(e)}function b(){C.note.pages[C.pageNumber-1].noteData?B(C.note.pages[C.pageNumber-1].noteData):(C.loadingPage=!0,g.load(C.note.pages[C.pageNumber-1].noteDataUrl,B,v,I))}function v(){C.pageNumber=C.previousPage,C.previousPage=C.pageNumber,r.addMessage("Unable to load page. Please ensure you are connected to the Internet or contact support for further assistance.","danger",!0)}function B(e){E(e),C.previousPage=C.pageNumber}function Q(){return C.noteEditor.serializeCanvasSnapshot()}C.note=u,C.pageNumber=1,C.previousPage=1,C.loadingPage=!1,C.contact=l,C.isSaving=!1,C.isMobile=!1,C.isIOSMobileDevice=!1,C.isDirty=!1,C.preventEdit=!1,null===n.fullScreen?C.fullScreen=!0:C.fullScreen=n.fullScreen,C.editorInitialized=function(){C.note.pages[C.pageNumber-1].noteData?E(C.note.pages[C.pageNumber-1].noteData):(C.loadingPage=!0,g.load(C.note.pages[C.pageNumber-1].noteDataUrl,E,v,I))},this.$onInit=function(){n.onboarding&&(C.onboarding=!0),C.noteEditor={loaded:!1},C.tools=[A.LC.tools.SelectShape,A.LC.tools.Pencil,A.LC.tools.Eraser,A.LC.tools.Text,A.LC.tools.Line,A.LC.tools.Pan],C.canvasSize={width:0,height:0},C.isMobile=a.isMobile()&&!a.isTablet(),C.isIOSMobileDevice=a.raw.device.ipad||a.raw.device.iphone,f=t.$on("onBeforeUnload",function(e,t){C.noteEditor.hasUnsavedChanges()&&(t.message="Any unsaved changes will be lost.",e.preventDefault())}),t.$on("onPageHide",function(e,t){var A;C.noteEditor.hasUnsavedChanges()&&(A=window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."),t.allow=A)}),h=e.$on("$stateChangeStart",function(e){if(C.noteEditor.hasUnsavedChanges()&&!window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."))return void e.preventDefault()}),t.$on("$destroy",function(){h(),f(),$(".hidden-print-image").remove(),C.noteEditor.unsubscribeDrawEvent&&C.noteEditor.unsubscribeDrawEvent()}),C.note.isOwner&&!C.note.isLocked&&!m.settings.subscription.isReadOnly||(C.preventEdit=!0),C.note.pages[C.pageNumber-1].noteData?E(C.note.pages[C.pageNumber-1].noteData):C.loadingPage=!0},t.$on("$destroy",function(){C.noteEditor.removeEventListeners()}),C.newPagesArray=p,C.selectedNewPageItem="",C.newPageSelected=function(e){C.addSelectedPage(e.id)},C.addSelectedPage=function(e){var A={contactId:C.contact.id,id:C.note.id,contactNoteId:C.note.id,sequence:C.note.pageCount+1,pageType:e};s.addPage({contactId:C.contact.id,id:C.note.id},A,function(e){var t={id:e.pageId,sequence:A.sequence};C.loadingPage=!0,g.load(e.noteDataUrl,function(e){t.noteData=e,C.note.pages.push(t),C.note.pageCount++,C.pageNumber=C.note.pageCount,C.pageChanged()},v,I)})},this.deletePage=function(){o.open({templateUrl:"common/DeleteNotePage.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"}).result.then(function(e){!0===e&&s.deletePage({id:C.note.id,contactId:C.contact.id,pageId:C.note.pages[C.pageNumber-1].id}).$promise.then(function(){C.note.pageCount--,C.note.pages.splice(C.pageNumber-1,1),C.pageNumber>C.note.pages.length&&(C.pageNumber=C.note.pages.length,C.previousPage=C.pageNumber),b()})})},this.pageChanged=function(){C.noteEditor.forceSave(),C.note.pages[C.previousPage-1].isDirty=C.noteEditor.hasUnsavedCurrentPageChanges(),C.note.pages[C.previousPage-1].noteData=Q(),b()},this.print=function(){C.noteEditor.commit(),C.note.pages[C.previousPage-1].isDirty=C.noteEditor.hasUnsavedCurrentPageChanges(),C.note.pages[C.previousPage-1].noteData=Q(),d.printPages(C.note)},this.save=function(){var o,a;C.noteEditor.commit(),0!==C.note.name.length?(C.isSaving=!0,C.note.pages[C.pageNumber-1].isDirty=C.noteEditor.hasUnsavedCurrentPageChanges(),C.note.pages[C.pageNumber-1].noteData=Q(),a=!(o=[]),C.note.pages.forEach(function(e){var t,A,n;e.isDirty&&(t=new FormData,A=new Blob([JSON.stringify(e.noteData,null,0)],{type:"application/json"}),t.append("sequence",e.sequence),t.append("userSaved",!0),t.append("noteData",A),n=c.editNotePage(C.contact.id,C.note.id,e.id,t),o.push(n),a=!0)}),i.all(o).then(function(){var e={id:C.note.id,name:C.note.name,contact:C.contact.id,isLocked:C.note.isLocked,hasDirtyPages:a};return s.save({contactId:C.contact.id,id:C.note.id},e,function(e){C.isDirty=!1,C.note.pages.forEach(function(e){e.isDirty=!1}),C.noteEditor.subscribeToDrawEvent(),C.note.modifiedDate=e.modifiedDate,r.addMessage("Note saved successfully.","success",!0),C.isSaving=!1}).$promise}).catch(function(e){console.error("There was an error saving the note",e),r.addMessage("There was an error saving the note.\n\nPlease ensure that you are online and retry.","danger",!0),C.isSaving=!1})):r.addMessage("You must provide a name.","danger",!0)},this.lockNote=function(){C.preventEdit||window.confirm("This will save and permanently lock this note from further edits. Are you sure you want to proceed?")&&(C.noteEditor.commit(),C.noteEditor.updateNoteDataUrl(),C.note.isLocked=!0,C.preventEdit=!0,this.save())},this.deleteNote=function(e){var t;C.preventEdit||((t=o.open({templateUrl:"common/DeleteNote.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"})).model=e,t.result.then(function(e){!0===e&&s.delete({id:C.note.id,contactId:C.contact.id}).$promise.then(function(){A.history.back()})}))}}}(),function(){"use strict";function e(A,e,n,o,t,a,i){this.pagedItems=t,this.selectTemplate=function(e){var t={name:A.moment().format("DD MMM YYYY h:mm a"),contactId:i.id,templateId:e.id};a.add(t).$promise.then(function(e){o.applyTemplate(i,e).then(function(){n.close({note:e})})})},this.cancel=function(){n.dismiss()}}angular.module("app.contacts").controller("SelectNoteTemplateController",e),e.$inject=["$window","$state","$uibModalInstance","contactNoteTemplateInitializer","noteTemplates","NotesApi","contact"]}(),function(){"use strict";function e(o,c,l,A){function u(e,t,A,n){var o="",a="";return A&&(o+=a+A,a=" "),n&&(o+=a+n,a=" "),e.replace(t,o)}function d(e,t){for(var A in e)if(e.hasOwnProperty(A)&&e[A]===t)return e[A.toString().replace("Type","")];return""}return{applyTemplate:function(t,n){n.pages=A.sortBy(n.pages,"sequence");var e=n.pages.map(function(e){return A=e,i=t,r=n,s=o.defer(),$.getJSON(A.noteDataUrl,function(e){A.noteData=e;var o,a,t=document.createElement("div");c.LC.init(t,{onInit:(o=A,a=e,function(e){!function(e,t,A,n){var o=t.shapes;t.backgroundShapes=[],t.shapes=[];var a={height:t.imageSize.height,width:t.imageSize.width};e.setImageSize(a.width,a.height);for(var i=0;i<o.length;i++){var r,s=c.LC.JSONToShape(o[i]);"Text"===s.className&&(r=u(r=s.text,/{Contact\.Name}/g,A.name),r=u(r,/{Contact\.PrimaryContact}/g,A.firstName,A.lastName),r=u(r,/{Contact\.FirstName}/g,A.firstName),r=u(r,/{Contact\.LastName}/g,A.lastName),r=u(r,/{Contact\.Email}/g,A.email),r=u(r,/{Contact\.AddressLine1}/g,A.addressLine1),r=u(r,/{Contact\.AddressLine2}/g,A.addressLine2),r=u(r,/{Contact\.Suburb}/g,A.suburb),r=u(r,/{Contact\.PostCode}/g,A.postCode),r=u(r,/{Contact\.State}/g,A.state),r=u(r,/{Contact\.Country}/g,A.country),r=u(r,/{Contact\.MobilePhone}/g,d(A,"Mobile")),r=u(r,/{Contact\.WorkPhone}/g,d(A,"Work")),r=u(r,/{Contact\.Fax}/g,d(A,"Business - Fax")),r=u(r,/{Contact\.Comments}/g,A.notes),r=u(r,/{Note\.CreatedDate}/g,moment(n.createdDate).format("DD MMM YYYY")),r=u(r,/{Note\.CreatedDateTime}/g,moment(n.createdDate).format("DD MMM YYYY h:mm a")),s.text=u(r,/&#10;/g,"\n")),t.backgroundShapes.push(s)}e.backgroundShapes=t.backgroundShapes,e.repaintLayer("background")}(e,a,i,r);var t=JSON.stringify(e.getSnapshot(["imageSize","backgroundShapes","shapes"]));o.noteData=t,e._teardown();var A=new FormData,n=new Blob([JSON.stringify(o.noteData,null,0)],{type:"application/json"});A.append("sequence",o.sequence),A.append("noteData",n),A.append("userSaved",!1),l.editNotePage(i.id,r.id,o.id,A).then(function(e){s.resolve(e)}).catch(function(e){s.reject(e)})})})}),s.promise;var A,i,r,s});return o.all(e)}}}angular.module("app.contacts").service("contactNoteTemplateInitializer",e),e.$inject=["$q","$window","NotePageApi","lodash"]}(),function(){"use strict";function e(e,n,t,o,a,i,r,s,A,c,l){var u=this;function d(){return e.moment().format("DD MMM YYYY h:mm a")}u.pagedItems=c,u.isAddingContact=!1,u.organization=A,u.contacts=[],u.existingContact=null,u.newContact={firstName:"",lastName:"",mobilePhone:"",email:""},null!==l&&s.get({id:l},function(e){u.existingContact=e}),u.selectTemplate=function(A){var e,t;n.newContactForm.$setSubmitted(),n.newContactForm.$invalid?u.showValidationMessage=!0:(u.showValidationMessage=!1,u.isAddingContact?(e={firstName:u.newContact.firstName,lastName:u.newContact.lastName,mobilePhone:u.newContact.mobilePhone,email:u.newContact.email},s.add(e,function(t){var e={name:d(),contactId:t.id,templateId:A.id};r.add(e).$promise.then(function(e){a.applyTemplate(t.contact,e).then(function(){o.close({contactId:t.id,note:e})})})},function(e){i.addMessage("An error occured while creating a new contact. Please try again.","danger",!1),console.error(e),o.dismiss()})):(t={name:d(),contactId:u.existingContact.id,templateId:A.id},r.add(t).$promise.then(function(e){a.applyTemplate(u.existingContact,e).then(function(){o.close({contactId:u.existingContact.id,note:e})})})))},u.addContact=function(){u.isAddingContact=!0,u.existingContact=null},u.cancelAddContact=function(){u.isAddingContact=!1},u.cancel=function(){o.dismiss()}}angular.module("app.contacts").controller("SelectContactAndNoteTemplateController",e),e.$inject=["$window","$scope","$state","$uibModalInstance","contactNoteTemplateInitializer","alertService","NotesApi","ContactsApi","organization","noteTemplates","contactId"]}(),function(){"use strict";function e(e,A,t,n,o,a,i,r,s,c){var l=this;function u(){return e.moment().format("DD MMM YYYY h:mm a")}l.noteTemplateId=c,l.isAddingContact=!1,l.organization=s,l.contacts=[],l.existingContact=null,l.newContact={firstName:"",lastName:"",mobilePhone:"",email:""},l.ok=function(){var e,t;A.newContactForm.$setSubmitted(),A.newContactForm.$invalid?l.showValidationMessage=!0:(l.showValidationMessage=!1,l.isAddingContact?(e={firstName:l.newContact.firstName,lastName:l.newContact.lastName,mobilePhone:l.newContact.mobilePhone,email:l.newContact.email},r.add(e,function(t){var e={name:u(),contactId:t.id,templateId:l.noteTemplateId};i.add(e).$promise.then(function(e){o.applyTemplate(t.contact,e).then(function(){n.close({contactId:t.id,note:e})})})},function(e){a.addMessage("An error occured while creating a new contact. Please try again.","danger",!1),console.error(e),n.dismiss()})):(t={name:u(),contactId:l.existingContact.id,templateId:l.noteTemplateId},i.add(t).$promise.then(function(e){o.applyTemplate(l.existingContact,e).then(function(){n.close({contactId:l.existingContact.id,note:e})})})))},l.addContact=function(){l.isAddingContact=!0,l.existingContact=null},l.cancelAddContact=function(){l.isAddingContact=!1},l.cancel=function(){n.dismiss()}}angular.module("app.contacts").controller("SelectContactController",e),e.$inject=["$window","$scope","$state","$uibModalInstance","contactNoteTemplateInitializer","alertService","NotesApi","ContactsApi","organization","noteTemplateId"]}(),function(){"use strict";function e(e,t,A,n,o){var a=this;a.filename=null,a.progress=0,a.uploadingStarted=!1,a.mimeTypeSupported=!0,a.attachment={name:"",notes:"",contactId:o.id},n.userContextChanged(e,function(){a.uploader.headers.Authorization=n.getAuthorizationHeaderValue(),a.uploader.headers["x-organization-id"]=n.getOrganizationId()}),a.uploader=A.getNewInstance(o.id),a.uploader.onAfterAddingFile=function(e){null!==a.attachment.name&&""!==a.attachment.name||(a.attachment.name=e.file.name),a.attachment.file=e.file,a.filename=e.file.name,a.attachment.fileSizeBytes=e.file.size,a.mimeTypeSupported=!0;for(var t=a.uploader.queue.length-1;0<=t;t--){var A=a.uploader.queue[t];A!==e&&a.uploader.removeFromQueue(A)}},a.isValidFile=function(e){return!!e&&(e.size<=0&&(a.zerobytefile=!0),0<e.size)},a.uploader.onWhenAddingFileFailed=function(e){a.filename=e.name,a.mimeTypeSupported=!1},a.uploader.onBeforeUploadItem=function(e){e.formData.push(a.attachment),a.uploadingStarted=!0,a.progress=0},a.uploader.onSuccessItem=function(){t.close("done")},a.uploader.onProgressAll=function(e){a.progress=e},a.uploader.onErrorItem=function(e,t){console.error(t),a.uploadError=!0},a.isUploading=function(){return a.progress<100},a.save=function(){e.addForm.$invalid||a.uploader.uploadAll()},a.close=function(){a.uploader.cancelAll(),t.dismiss()}}angular.module("app.contacts").controller("AddAttachmentController",e),e.$inject=["$scope","$uibModalInstance","AttachmentUploaderService","AuthService","contact"]}(),function(){"use strict";function e(e){return e("/api/contacts/:contactId/attachments/:id",{contactId:"@contactId",id:"@id"},{query:{isArray:!1},add:{method:"POST"},save:{method:"PUT"},get:{method:"GET"},delete:{method:"DELETE"},download:{url:"/api/contacts/:contactId/attachments/:id/download",method:"GET"}})}angular.module("app.contacts").factory("AttachmentsApi",e),e.$inject=["$resource"]}(),function(){"use strict";function e(t,A,i,n,r,e){var s=this;s.contact=n,this.useWebNotes="WEBN"===e.notationTypeCode,this.isStandaloneOrganization=!e.isXeroOrganization,s.sortOrder=function(e){var t=e.split(" "),A={property:t[0],ascending:!0};"desc"===t[1]&&(A.ascending=!1);return A}("uploadedDate desc"),this.openAttachment=function(e){A.go(".view",{id:n.id,attachmentId:e.id})},this.newAttachment=function(){A.go(".add",{id:n.id})},this.reloadData=function(e,t,A){s.isLoading=!0;var n,o,a=r.query({contactId:s.contact.id,pageNumber:e,pageSize:t,sortOrder:(o=(n=A).ascending?"asc":"desc",n.property+" "+o)},function(){s.pagedItems=a,s.isLoading=!1},function(){s.isLoading=!1,i.addMessage("An error occured with searching. Please try again.","danger",!1)})},this.pageChanged=function(){return s.reloadData(s.pagedItems.pageNumber,s.pagedItems.pageSize,s.sortOrder)},this.orderBy=function(e){return s.sortOrder.property===e?s.sortOrder.ascending=!s.sortOrder.ascending:(s.sortOrder.property=e,s.sortOrder.ascending=!0),s.reloadData(1,s.pagedItems.pageSize,s.sortOrder)},this.openFile=function(e){r.get({contactId:n.id,id:e.id,forOpen:!0},function(e){t.open(e.attachmentDataUrl)||(t.location.href=e.attachmentDataUrl)})},this.download=function(e){r.get({contactId:n.id,id:e.id},function(e){var t=document.createElement("a");t.setAttribute("href",e.attachmentDataUrl),t.setAttribute("download",e.originalFilename),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)})},this.delete=function(e){t.confirm("Are you sure you want to delete this attachment? This action is permanent.")&&r.delete({contactId:n.id,id:e.id},function(){i.addMessage("Attachment deleted successfully.","success",!1),s.reloadData(1,s.pagedItems.pageSize,s.sortOrder,"")},function(e){console.error(e),i.addMessage("An error occured while deleting the attachment. Please contact support.","danger",!1)})},this.getHeaderClasses=function(e){var t="";return this.sortOrder.property===e&&(t="sorting ",t+=this.sortOrder.ascending?"sorting_asc":"sorting_desc"),t},s.reloadData(1,50,s.sortOrder,"")}angular.module("app.contacts").controller("AttachmentsListController",e),e.$inject=["$window","$state","alertService","contact","AttachmentsApi","orgSettings"]}(),function(){"use strict";function e(n,o,e){var t=this;function a(e){return-1!==t.validMimeTypes.indexOf(e)}return t.validMimeTypes=[],e.getSettings().then(function(e){t.validMimeTypes=e.validAttachmentMimeTypes}),{isValidMimeType:a,getNewInstance:function(e){var t=new o({url:"/api/contacts/"+e+"/attachment-upload",headers:{Authorization:n.getAuthorizationHeaderValue(),"x-organization-id":n.getOrganizationId()},alias:"attachmentData",withCredentials:!0});return t.filters.push({name:"fileFilter",fn:function(e){return a(e.type)}}),t},getNewAttachmentUpdateInstance:function(e,t){var A=new o({url:"/api/contacts/"+e+"/attachment-upload/"+t,headers:{Authorization:n.getAuthorizationHeaderValue(),"x-organization-id":n.getOrganizationId()},method:"PUT",alias:"attachmentData",withCredentials:!0});return A.filters.push({name:"fileFilter",fn:function(e){return a(e.type)}}),A}}}angular.module("app.contacts").service("AttachmentUploaderService",e),e.$inject=["AuthService","FileUploader","AppContext"]}(),function(){"use strict";function e(e,t,A,n,o,a,i,r,s,c){var l=this,u=!1,d=/^image\//,p=/^video\//;l.attachment=i,l.downloadUrl=null,l.uploadingStarted=!1,l.mimeTypeSupported=!0,s.userContextChanged(e,function(){l.uploader.headers.Authorization=s.getAuthorizationHeaderValue(),l.uploader.headers["x-organization-id"]=s.getOrganizationId()}),l.uploader=r.getNewAttachmentUpdateInstance(a.id,i.id),l.downloadUrl=i.attachmentDataUrl,l.trustedSource=A.trustAsResourceUrl(i.attachmentDataUrl),l.uploader.onAfterAddingFile=function(e){null!==l.attachment.name&&""!==l.attachment.name||(l.attachment.name=e.file.name),l.attachment.file=e.file,l.filename=e.file.name,l.attachment.fileSizeBytes=e.file.size,l.mimeTypeSupported=!0;for(var t=l.uploader.queue.length-1;0<=t;t--){var A=l.uploader.queue[t];A!==e&&l.uploader.removeFromQueue(A)}},l.isValidFile=function(e){return!l.attachment.file||!!e&&(e.size<=0&&(l.zerobytefile=!0),0<e.size)},l.uploader.onWhenAddingFileFailed=function(e){l.filename=e.name,l.mimeTypeSupported=!1},l.uploader.onBeforeUploadItem=function(e){e.formData.push(l.attachment),l.uploadingStarted=!0,l.progress=0},l.uploader.onSuccessItem=function(){c.addMessage("Attachment saved successfully.","success",!0),u=!0,l.close()},l.uploader.onProgressAll=function(e){l.progress=e},l.uploader.onErrorItem=function(e,t){console.error(t),l.uploadError=!0},l.isUploading=function(){return l.progress<100},l.save=function(){e.form.$invalid||(u=!0,l.attachment.file?t.confirm("Uploading a new file will permanently overwrite the existing file. Are you sure you want to continue?")&&l.uploader.uploadAll():o.save({contactId:a.id,id:i.id},l.attachment,function(){c.addMessage("Attachment saved successfully.","success",!0),l.close()},function(e){console.error(e),l.uploadError=!0}))},l.isImage=function(){return d.test(i.mimeType)},l.isVideo=function(){return p.test(i.mimeType)},l.close=function(){if(l.uploader.cancelAll(),u)return n.close("refresh");n.close("close")}}angular.module("app.contacts").controller("ViewAttachmentController",e),e.$inject=["$scope","$window","$sce","$uibModalInstance","AttachmentsApi","contact","attachment","AttachmentUploaderService","AuthService","alertService"]}(),function(){"use strict";angular.module("express-app",[]).config(["$stateProvider",function(e){e.state("express-root",{abstract:!0}).state("express-app",{parent:"express-root",abstract:!0,views:{"@":{controller:"ExpressShellController",controllerAs:"shellCtrl",templateUrl:"express-note/ExpressShell.html"}},data:{allowAnonymous:!0}}).state("express-app.editNote",{url:"/",views:{"content@express-app":{templateUrl:"express-note/EditExpressNote.html",controller:"EditExpressNoteController",controllerAs:"vm"},resolve:{}},data:{allowAnonymous:!0,pageTitle:"New Note"}}).state("express-app.viewNote",{url:"/view",views:{"content@express-app":{templateUrl:"express-note/ViewExpressNote.html",controller:"ViewExpressNoteController",controllerAs:"vm"}},data:{allowAnonymous:!0,pageTitle:"View Note"},resolve:{note:["$stateParams","$location","lodash","ExpressNoteAPIService",function(e,t,A,n){if(e.note)return e.note.pages=A.sortBy(e.note.pages,"sequence"),e.note;var o={params:{token:t.search().token}};return n.get(o).then(function(e){return e.pages=A.sortBy(e.pages,"sequence"),e})}]}}).state("express-app.404",{url:"/not-found",views:{"content@express-app":{templateUrl:"express-note/NotFound.html",controller:"NotFoundNoteController",controllerAs:"vm"}},data:{allowAnonymous:!0,pageTitle:"Note not found"},resolve:{note:["$stateParams",function(){return{id:"00000000-0000-0000-0000-000000000000",name:"Notud X - 404 Error",pages:[{id:"00000000-0000-0000-0000-000000000000",noteDataUrl:"/static/expressNote404.json",sequence:1}],pageCount:1,createdDate:"0001-01-01T00:00:00",modifiedDate:"0001-01-01T00:00:00",isActive:!1,userSaved:!1}}]}})}])}(),function(){"use strict";function e(t,A){var n="/api/expressnotes";return{get:function(e){return A.get(n,e).then(function(e){return e.data}).catch(function(){t.go("express-app.404")})},share:function(e){return A.post(n,e,{headers:{"Content-type":void 0},timeout:3e5}).then(function(e){return e.data})},validate:function(e){return A.post(n+"/validate",e).then(function(e){return e.data}).catch(function(){})},getLink:function(e){return A.post(n+"/getlink",e,{headers:{"Content-type":void 0},timeout:3e5}).then(function(e){return e.data})},saveToAccount:function(e){return A.post(n+"/savetoaccount",e,{headers:{"Content-type":void 0},timeout:3e5}).then(function(e){return e.data})}}}angular.module("express-app").service("ExpressNoteAPIService",e),e.$inject=["$state","$http"]}(),function(){"use strict";function e(a){var i={shapes:[],backgroundShapes:[],imageSize:{width:"infinite",height:"infinite"}},r=[{className:"ImageWithRotate",data:{x:0,y:0,imageSrc:"data:image/png;base64,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",imageObject:{},scale:.25,rotateAngle:0},id:"b12919d6-f7a7-c543-cd6d-585552719f67"}],s={shapes:[],backgroundShapes:[],imageSize:{width:"infinite",height:"infinite"}};return{createNewSnapshot:function(e,t,A,n){var o={};return(o="lined"===A?(n?s.shapes=r:s.backgroundShapes=r,a.cloneDeep(s)):a.cloneDeep(i)).imageSize.width=e,o.imageSize.height=t,o}}}angular.module("express-app").service("newExpressNoteSnapshotService",e),e.$inject=["lodash"]}(),function(){"use strict";function e(e){var t=this;t.isLoaded=!1,t.isMobile=!1,t.isMobile=e.isMobile()&&!e.isTablet(),t.isLoaded=!0}angular.module("express-app").controller("ExpressShellController",e),e.$inject=["deviceDetector"]}(),function(){"use strict";angular.module("express-app").controller("EditExpressNoteController",e),e.$inject=["$rootScope","$window","$scope","$stateParams","$uibModal","$timeout","ExpressNoteAPIService","deviceDetector","alertService","CanvasPrint","newExpressNoteSnapshotService","SafeLoadNotePage"];var y=1;function e(o,i,a,r,e,s,c,l,t,A,u,n){var d,p,g=this;function m(e,n){var o=this;o.viewState="initial";var a={id:"",shareType:"privatenote",callBackUrl:"",shareWithTeam:g.shareWithTeam};o.model=a,o.saveToAccount=function(){g.noteEditor.forceSave(),g.isSaving=!0,g.note.pages[g.pageNumber-1].isDirty=g.noteEditor.hasUnsavedCurrentPageChanges(),g.note.pages[g.pageNumber-1].noteData=w();var e=new FormData;e.append("name",i.moment().format("DD MMM YYYY h:mm a")),e.append("shareType",o.model.shareType);for(var t=0;t<g.note.pages.length;t++){var A=new Blob([JSON.stringify(g.note.pages[t].noteData,null,0)],{type:"application/json"});e.append("pageSequence",t+1),e.append("notePage"+t,A)}return c.saveToAccount(e).then(function(e){return e?(C(),g.isSaving=!1,g.importNote={token:e.token,shareFlag:a.shareWithTeam},g.importItems=n.getExpressItem("ImportNotes")||[],null===g.importItems||0===g.importItems.length?g.importItems[0]=g.importNote:g.importItems.push(g.importNote),n.setExpressItem("ImportNotes",g.importItems),void s(function(){i.location=e.callBackUrl+"&shareFlag="+a.shareWithTeam},0)):(o.viewState="error",void(g.isSaving=!1))}).catch(function(e){console.log(e),g.isSaving=!1})},o.cancelShare=function(){e.close()}}function h(e){var n=this;n.isMobile=l.isMobile()&&!l.isTablet(),n.viewState="",n.validateState="";var o={id:n.callBackUrl="",email:"",recipient:"",message:"",shareType:"link",oneTimeCode:""};n.$onInit=function(){n.model=o,n.viewState="success",g.noteEditor.forceSave(),g.isSaving=!0,g.note.pages[g.pageNumber-1].isDirty=g.noteEditor.hasUnsavedCurrentPageChanges(),g.note.pages[g.pageNumber-1].noteData=w();var e=new FormData;e.append("name",i.moment().format("DD MMM YYYY h:mm a"));for(var t=0;t<g.note.pages.length;t++){var A=new Blob([JSON.stringify(g.note.pages[t].noteData,null,0)],{type:"application/json"});e.append("pageSequence",t+1),e.append("notePage"+t,A)}c.getLink(e).then(function(e){e?(n.model.id=e.id,n.callBackUrl=e.callBackUrl,n.viewState="success",C()):n.viewState="error"}).catch(function(e){console.log(e),n.viewState="error"}),g.isSaving=!1},n.copier=function(e){document.getElementById(e).select(),document.execCommand("copy")},n.cancelShare=function(){e.close()}}function f(e){var n=this;n.isMobile=l.isMobile()&&!l.isTablet(),n.viewState="",n.validateState="";var t={id:n.callBackUrl="",email:"",recipient:"",message:"",shareType:"link",oneTimeCode:""};n.$onInit=function(){n.model=t,n.viewState="initial"},n.validateUser=function(){c.validate(t).then(function(e){e||(n.validateState="validateError"),n.callBackUrl=e.callBackUrl,g.noteEditor.updateNoteDataUrl(),g.preventEdit=!1,g.isDirty=!1,n.viewState="success",C()}).catch(function(e){n.validateState="validateError",g.preventEdit=!1,console.log(e)})},n.shareNote=function(){g.noteEditor.forceSave(),g.isSaving=!0,g.note.pages[g.pageNumber-1].isDirty=g.noteEditor.hasUnsavedCurrentPageChanges(),g.note.pages[g.pageNumber-1].noteData=w();var e=new FormData;e.append("name",i.moment().format("DD MMM YYYY h:mm a")),e.append("senderEmail",n.model.email),e.append("recipientEmail",n.model.recipient),e.append("message",n.model.message),e.append("shareType",n.model.shareType);for(var t=0;t<g.note.pages.length;t++){var A=new Blob([JSON.stringify(g.note.pages[t].noteData,null,0)],{type:"application/json"});e.append("pageSequence",t+1),e.append("notePage"+t,A)}c.share(e).then(function(e){e?(n.model.id=e,n.viewState="validate"):n.viewState="error"}).catch(function(e){console.log(e)}),g.isSaving=!1},n.cancelShare=function(){e.close()}}function C(){g.isDirty=!1,g.note.pages.forEach(function(e){e.isDirty=!1})}function I(e,t,A,n,o,a){var i=u.createNewSnapshot(e,t,A,n);return{id:o,noteData:JSON.stringify(i),sequence:a}}function E(){g.loadingPage=!1}function b(e){var t;g.noteEditor.loaded&&g.noteEditor.unsubscribeDrawEvent(),t=e,"[object String]"===Object.prototype.toString.call(t)&&(e=JSON.parse(e)),e.position=void 0,e.scale=void 0,(e.colors=void 0)!==g.note.pages[g.pageNumber-1].isDirty?g.isDirty=g.note.pages[g.pageNumber-1].isDirty:g.isDirty=!1,g.note.pages[g.pageNumber-1].noteData=e,g.note.pageOrientation===y?g.canvasSize={height:g.note.paperSize.heightPoints,width:g.note.paperSize.widthPoints}:g.canvasSize={height:g.note.paperSize.widthPoints,width:g.note.paperSize.heightPoints},g.noteEditor.loaded&&g.noteEditor.loadSnapshot(e)}function v(){g.note.pages[g.pageNumber-1].noteData?Q(g.note.pages[g.pageNumber-1].noteData):(g.loadingPage=!0,n.load(g.note.pages[g.pageNumber-1].noteDataUrl,Q,B,E))}function B(){g.pageNumber=g.previousPage,g.previousPage=g.pageNumber,t.addMessage("Unable to load page. Please ensure you are connected to the Internet or contact support for further assistance.","danger",!0)}function Q(e){b(e),g.previousPage=g.pageNumber}function w(){return g.noteEditor.serializeCanvasSnapshot()}g.pageNumber=1,g.previousPage=1,g.loadingPage=!1,g.isSaving=!1,g.isMobile=!1,g.isIOSMobileDevice=!1,g.isDirty=!1,g.preventEdit=!1,g.menuDropdownIsOpen=!1,g.callBackUrl="",g.shareWithTeam=!1,g.editorInitialized=function(){g.note.pages[g.pageNumber-1].noteData?b(g.note.pages[g.pageNumber-1].noteData):(g.loadingPage=!0,n.load(g.note.pages[g.pageNumber-1].noteDataUrl,b,B,E))},g.onFocus=function(){g.menuDropdownIsOpen=!1},this.$onInit=function(){var e,t,A;null===r.fullScreen||r.fullScreen?g.fullScreen=!0:g.fullScreen=!1,null!==r.onboard&&r.onboard?g.onboard=!0:g.onboard=!1,r.tour&&(g.tour=!0),g.noteEditor={loaded:!1},g.tools=[i.LC.tools.SelectShape,i.LC.tools.Pencil,i.LC.tools.Eraser,i.LC.tools.Text,i.LC.tools.Line,i.LC.tools.Pan],g.canvasSize={width:0,height:0},g.isMobile=l.isMobile()&&!l.isTablet(),g.isIOSMobileDevice=l.raw.device.ipad||l.raw.device.iphone,p=a.$on("onBeforeUnload",function(e,t){g.noteEditor.hasUnsavedChanges()&&(t.message="Any unsaved changes will be lost.",e.preventDefault())}),a.$on("onPageHide",function(e,t){var A;g.noteEditor.hasUnsavedChanges()&&(A=window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."),t.allow=A)}),d=o.$on("$stateChangeStart",function(e){if(g.noteEditor.hasUnsavedChanges()&&!window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."))return void e.preventDefault()}),a.$on("$destroy",function(){d(),p(),$(".hidden-print-image").remove(),g.noteEditor.unsubscribeDrawEvent&&g.noteEditor.unsubscribeDrawEvent()}),g.note={},g.pageNumber=1,g.note=(t=e="",A=i.moment().format("DD MMM YYYY h:mm a"),{id:e,name:t,pageCount:1,pages:[],paperSize:{name:"A4",heightMm:297,widthMm:210,heightPoints:842,widthPoints:595,displaySequence:1,id:"23a93b49-4865-438b-be74-38e503e258da"},pageOrientation:1,createdDate:A,modifiedDate:A,isLocked:!1,isActive:!0,isPrivate:!0,userSaved:!1,isOwner:!0});var n=I(g.note.paperSize.widthPoints,g.note.paperSize.heightPoints,"lined",!1,"",1);g.note.pages.push(n),g.preventEdit=!1,g.note.pages[g.pageNumber-1].noteData?b(g.note.pages[g.pageNumber-1].noteData):g.loadingPage=!0},g.saveAndShare=function(e){g.shareWithTeam=e,g.showAccountSaveModal()},g.saveWithShare=function(){g.shareWithTeam=!0,g.showAccountSaveModal()},g.showAccountSaveModal=function(){e.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"express-note/ExpressAccountSaveModal.html",size:"md",controller:m,bindToController:!0,controllerAs:"vm"})},m.$inject=["$uibModalInstance","UserSettings"],g.showGetLinkModal=function(){e.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"express-note/ExpressGetLinkModal.html",size:"md",controller:h,bindToController:!0,controllerAs:"vm"})},h.$inject=["$uibModalInstance"],g.showShareModal=function(){e.open({animation:!0,ariaLabelledBy:"share-title",ariaDescribedBy:"share-body",templateUrl:"express-note/ExpressShareModal.html",size:"md",controller:f,bindToController:!0,controllerAs:"vm"})},f.$inject=["$uibModalInstance"],a.$on("$destroy",function(){g.noteEditor.removeEventListeners()}),g.addPage=function(e){var t=I(g.note.paperSize.widthPoints,g.note.paperSize.heightPoints,e,!1,"page-id",g.note.pageCount+1);g.note.pages.push(t),g.note.pageCount++,g.pageNumber=g.note.pageCount,g.pageChanged()},this.deletePage=function(){e.open({templateUrl:"common/DeleteNotePage.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"}).result.then(function(e){!0===e&&(g.note.pageCount--,g.note.pages.splice(g.pageNumber-1,1),g.pageNumber>g.note.pages.length&&(g.pageNumber=g.note.pages.length,g.previousPage=g.pageNumber),v())})},this.pageChanged=function(){g.noteEditor.forceSave(),g.note.pages[g.previousPage-1].isDirty=g.noteEditor.hasUnsavedCurrentPageChanges(),g.note.pages[g.previousPage-1].noteData=w(),v(),g.previousPage=g.pageNumber},this.print=function(){g.noteEditor.commit(),g.note.pages[g.previousPage-1].isDirty=g.noteEditor.hasUnsavedCurrentPageChanges(),g.note.pages[g.previousPage-1].noteData=w(),A.printPages(g.note)}}}(),function(){"use strict";angular.module("express-app").controller("ViewExpressNoteController",e),e.$inject=["$rootScope","$window","$scope","$stateParams","deviceDetector","note","CanvasPrint","SafeLoadNotePage","alertService"];var m=1;function e(e,t,A,n,o,a,i,r,s){var c=this;function l(){c.loadingPage=!1}function u(e){var t;c.noteEditor.loaded&&c.noteEditor.unsubscribeDrawEvent(),t=e,"[object String]"===Object.prototype.toString.call(t)&&(e=JSON.parse(e)),e.position=void 0,e.scale=void 0,(e.colors=void 0)!==c.note.pages[c.pageNumber-1].isDirty?c.isDirty=c.note.pages[c.pageNumber-1].isDirty:c.isDirty=!1,c.note.pages[c.pageNumber-1].noteData=e,c.note.pageOrientation===m?c.canvasSize={height:595,width:842}:c.canvasSize={height:842,width:595},c.noteEditor.loaded&&c.noteEditor.loadSnapshot(e)}function d(){c.pageNumber=c.previousPage,c.previousPage=c.pageNumber,s.addMessage("Unable to load page. Please ensure you are connected to the Internet or contact support for further assistance.","danger",!0)}function p(e){u(e),c.previousPage=c.pageNumber}function g(){return c.noteEditor.serializeCanvasSnapshot()}c.pageNumber=1,c.previousPage=1,c.loadingPage=!1,c.isSaving=!1,c.isMobile=!1,c.isIOSMobileDevice=!1,c.isDirty=!1,c.preventEdit=!1,c.note=a,c.editorInitialized=function(){c.note.pages[c.pageNumber-1].noteData?u(c.note.pages[c.pageNumber-1].noteData):(c.loadingPage=!0,r.load(c.note.pages[c.pageNumber-1].noteDataUrl,u,d,l))},this.$onInit=function(){null===n.fullScreen||n.fullScreen?c.fullScreen=!0:c.fullScreen=!1,null!==n.onboard&&n.onboard?c.onboard=!0:c.onboard=!1,n.tour&&(c.tour=!0),c.noteEditor={loaded:!1},c.tools=[t.LC.tools.SelectShape,t.LC.tools.Pencil,t.LC.tools.Eraser,t.LC.tools.Text,t.LC.tools.Line,t.LC.tools.Pan],c.canvasSize={width:0,height:0},c.isMobile=o.isMobile()&&!o.isTablet(),c.isIOSMobileDevice=o.raw.device.ipad||o.raw.device.iphone,A.$on("$destroy",function(){$(".hidden-print-image").remove(),c.noteEditor.unsubscribeDrawEvent&&c.noteEditor.unsubscribeDrawEvent()}),c.pageNumber=1,c.note.pages[c.pageNumber-1].noteData?u(c.note.pages[c.pageNumber-1].noteData):c.loadingPage=!0,c.preventEdit=!0},A.$on("$destroy",function(){c.noteEditor.removeEventListeners()}),this.pageChanged=function(){c.noteEditor.forceSave(),c.note.pages[c.previousPage-1].isDirty=c.noteEditor.hasUnsavedCurrentPageChanges(),c.note.pages[c.previousPage-1].noteData=g(),c.note.pages[c.pageNumber-1].noteData?p(c.note.pages[c.pageNumber-1].noteData):(c.loadingPage=!0,r.load(c.note.pages[c.pageNumber-1].noteDataUrl,p,d,l)),c.previousPage=c.pageNumber},this.print=function(){c.noteEditor.commit(),c.note.pages[c.previousPage-1].isDirty=c.noteEditor.hasUnsavedCurrentPageChanges(),c.note.pages[c.previousPage-1].noteData=g(),c.note.paperSize={name:"A4",heightMm:297,widthMm:210,heightPoints:842,widthPoints:595,displaySequence:1,id:"23a93b49-4865-438b-be74-38e503e258da"},c.note.pageOrientation=1,i.printPages(c.note)}}}(),function(){"use strict";angular.module("express-app").controller("NotFoundNoteController",e),e.$inject=["$rootScope","$window","$scope","$stateParams","deviceDetector","note","CanvasPrint","SafeLoadNotePage","alertService"];var m=1;function e(e,t,A,n,o,a,i,r,s){var c=this;function l(){c.loadingPage=!1}function u(e){var t;c.noteEditor.loaded&&c.noteEditor.unsubscribeDrawEvent(),t=e,"[object String]"===Object.prototype.toString.call(t)&&(e=JSON.parse(e)),e.position=void 0,e.scale=void 0,(e.colors=void 0)!==c.note.pages[c.pageNumber-1].isDirty?c.isDirty=c.note.pages[c.pageNumber-1].isDirty:c.isDirty=!1,c.note.pages[c.pageNumber-1].noteData=e,c.note.pageOrientation===m?c.canvasSize={height:595,width:842}:c.canvasSize={height:842,width:595},c.noteEditor.loaded&&c.noteEditor.loadSnapshot(e)}function d(){c.pageNumber=c.previousPage,c.previousPage=c.pageNumber,s.addMessage("Unable to load page. Please ensure you are connected to the Internet or contact support for further assistance.","danger",!0)}function p(e){u(e),c.previousPage=c.pageNumber}function g(){return c.noteEditor.serializeCanvasSnapshot()}c.pageNumber=1,c.previousPage=1,c.loadingPage=!1,c.isSaving=!1,c.isMobile=!1,c.isIOSMobileDevice=!1,c.isDirty=!1,c.preventEdit=!1,c.note=a,c.editorInitialized=function(){c.note.pages[c.pageNumber-1].noteData?u(c.note.pages[c.pageNumber-1].noteData):(c.loadingPage=!0,r.load(c.note.pages[c.pageNumber-1].noteDataUrl,u,d,l))},this.$onInit=function(){null===n.fullScreen||n.fullScreen?c.fullScreen=!0:c.fullScreen=!1,null!==n.onboard&&n.onboard?c.onboard=!0:c.onboard=!1,n.tour&&(c.tour=!0),c.noteEditor={loaded:!1},c.tools=[t.LC.tools.SelectShape,t.LC.tools.Pencil,t.LC.tools.Eraser,t.LC.tools.Text,t.LC.tools.Line,t.LC.tools.Pan],c.canvasSize={width:0,height:0},c.isMobile=o.isMobile()&&!o.isTablet(),c.isIOSMobileDevice=o.raw.device.ipad||o.raw.device.iphone,A.$on("$destroy",function(){(void 0)(),(void 0)(),$(".hidden-print-image").remove(),c.noteEditor.unsubscribeDrawEvent&&c.noteEditor.unsubscribeDrawEvent()}),c.pageNumber=1,c.note.pages[c.pageNumber-1].noteData?u(c.note.pages[c.pageNumber-1].noteData):c.loadingPage=!0,c.preventEdit=!0},A.$on("$destroy",function(){c.noteEditor.removeEventListeners()}),this.pageChanged=function(){c.noteEditor.forceSave(),c.note.pages[c.previousPage-1].isDirty=c.noteEditor.hasUnsavedCurrentPageChanges(),c.note.pages[c.previousPage-1].noteData=g(),c.note.pages[c.pageNumber-1].noteData?p(c.note.pages[c.pageNumber-1].noteData):(c.loadingPage=!0,r.load(c.note.pages[c.pageNumber-1].noteDataUrl,p,d,l)),c.previousPage=c.pageNumber},this.print=function(){c.noteEditor.commit(),c.note.pages[c.previousPage-1].isDirty=c.noteEditor.hasUnsavedCurrentPageChanges(),c.note.pages[c.previousPage-1].noteData=g(),c.note.paperSize={name:"A4",heightMm:297,widthMm:210,heightPoints:842,widthPoints:595,displaySequence:1,id:"23a93b49-4865-438b-be74-38e503e258da"},c.note.pageOrientation=1,i.printPages(c.note)}}}(),function(){"use strict";function e(e,t,A,n,o){var a=this;a.$onInit=function(){$(document).on("click",".navbar-collapse.in",function(e){$(e.target).parents(".navbar-search").length?e.stopPropagation():$(this).collapse("hide")}),$(document).on("click",function(){var e=$(".navbar-collapse.in");0<e.length&&e.collapse("hide")}),a.isMobile=n.isMobile()&&!n.isTablet(),a.acceptedTerms=o.getExpressItem("ExpressNotes:AcceptedTerms"),a.acceptedTerms||a.showTermsModal()},a.createAccount=function(){e.open(A.openidAuthority+"/sign-up?utm_source=notudx&utm_medium=headersignup","_blank")},a.signIn=function(){e.open(A.openidAuthority+"/","_blank")},a.showTermsModal=function(){t.open({animation:!0,ariaLabelledBy:"terms-title",ariaDescribedBy:"terms-body",templateUrl:"express-note/ExpressTerms.html",size:"md",backdrop:"static",controller:i,controllerAs:"vm"})},a.showWelcomeModal=function(){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"WelcomeModalTemplate.html",size:"lg",controller:r,controllerAs:"vm"})}}function i(e,t,A,n){this.videos=e.welcomeVideo,this.isMobile=t.isMobile()&&!t.isTablet(),this.acceptTerms=function(){n.setExpressItem("ExpressNotes:AcceptedTerms",new Date),A.close()}}function r(e,t,A){this.videos=e.welcomeVideo,this.isMobile=t.isMobile()&&!t.isTablet(),this.closeModal=function(){A.close()}}angular.module("express-app").component("ncExpressHeader",{templateUrl:"express-note/ExpressPageHeaderComponent.html",controller:e,controllerAs:"pageHeaderCtrl"}),e.$inject=["$window","$uibModal","environmentConfig","deviceDetector","UserSettings"],i.$inject=["environmentConfig","deviceDetector","$uibModalInstance","UserSettings"],r.$inject=["environmentConfig","deviceDetector","$uibModalInstance"]}(),function(){"use strict";function d(A,e,n,t,o,a){var i,r=!1,s=0;function c(){r||((i=(new signalR.HubConnectionBuilder).withUrl("/hub/notifications?organizationId="+t.getOrganizationId(),{accessTokenFactory:function(){return t.getAccessToken()}}).build()).on("onNotificationReceived",function(e,t){A.$apply(function(){o.add(e,t)})}),i.onclose(function(){r&&u(i)}),r=!0,s=0,u(i))}function l(){r&&(r=!1,i.stop())}function u(t){return t.start().then(function(){0,s=0}).catch(function(e){console.error(e),0,++s<3?n(function(){u(t)},1e4):(s=0,a.add("Connection lost...","warning"))})}return d.enable=c,d.disable=l,t.userContextChanged(A,function(){t.isLoggedIn()?r||c():l()}),t.isLoggedIn()&&c(),d}angular.module("app.common").factory("ServerNotificationService",d),d.$inject=["$rootScope","$q","$timeout","AuthService","NotificationService","alertService"]}(),function(){"use strict";function e(A){var n=[],o=!1;function a(e,t){this.id=A.newGuid(),this.type=e,this.data=t,this.isNew=!0,this.created=new Date}function e(){return n.filter(function(e){return e.isNew}).length||0}return{notifications:n,add:function(e,t){var A=new a(e,t);n.unshift(A),o=!0},hasNew:function(){return 0<e()},markAsRead:function(){n.forEach(function(e){e.isNew=!1})},dismiss:function(e){for(var t=0;t<n.length;t++)n[t]===e&&(n.splice(t,1),t--)},clear:function(){for(;0<n.length;)n.pop()},getNewCount:e,viewerIsOpen:o}}angular.module("app.common").factory("NotificationService",e),e.$inject=["GuidGenerator"]}(),function(){"use strict";function e(e,t){this.getAnimationClass=function(){return t.hasNew()?"is-animating":""},this.getNewCount=function(){return t.getNewCount()},this.hasNew=function(){return t.hasNew()}}angular.module("app.common").component("appNotificationBellButton",{templateUrl:"notifications/NotificationBellButton.html",controller:e}),e.$inject=["$scope","NotificationService"]}(),function(){"use strict";function e(t){var e=this;function A(){return 0!==t.notifications.length}e.$onInit=function(){e.notifications=t.notifications},e.getNewCount=function(){return t.getNewCount()},e.hasAny=A,e.hasNew=function(){return t.hasNew()},e.dismiss=function(e){t.dismiss(e),A()||(t.viewerIsOpen=!1)},e.dismissAll=function(){t.clear(),t.viewerIsOpen=!1}}angular.module("app.common").component("appNotificationViewer",{templateUrl:"notifications/NotificationViewer.html",controller:e,bindings:{menuSize:"@"}}),e.$inject=["NotificationService"]}(),function(){"use strict";function e(a){return{scope:{type:"=",data:"=",mode:"@"},link:function(e,t){var A="app"+e.type.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),n=e.$new(!0);n.data=e.data,n.mode=e.mode;var o=a("<"+A+' notification="data" mode="mode"></'+A+">")(n);t.append(o)},restrict:"E"}}angular.module("app.common").directive("appNotificationSelector",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){var t=this;t.dismiss=function(){e.dismiss(t.notification)}}angular.module("app.common").controller("NotificationItemController",e),e.$inject=["NotificationService"]}(),function(){"use strict";angular.module("app.common").component("appExpressNoteImported",{templateUrl:"notifications/Templates/ExpressNoteImported.html",controller:"NotificationItemController",bindings:{notification:"<",mode:"<"}})}(),function(){"use strict";angular.module("app.common").component("appTemplateImportCompleted",{templateUrl:"notifications/Templates/TemplateImportCompleted.html",controller:"NotificationItemController",bindings:{notification:"<",mode:"<"}})}(),function(){"use strict";angular.module("app.quick-notes",[]).config(["$stateProvider",function(e){var n=null;e.state("app.quick-notes",{url:"/notes",views:{"content@app":{templateUrl:"quick-note/QuickNoteList.html",controller:"QuickNotesListController",controllerAs:"vm"}},data:{pageTitle:"Private Notes"},resolve:{orgSettings:["AppContext",function(e){return e.getSettings()}]}}).state("app.quick-notes.editNote",{url:"/{id:[0-9a-fA-F-]{36}}",data:{pageTitle:"Edit Quick Note"},params:{note:null,fullScreen:null,onboard:null},views:{"content@app":{templateUrl:"quick-note/EditQuickNote.html",controller:"EditQuickNoteController",controllerAs:"vm"}},resolve:{note:["$stateParams","lodash","QuickNoteAPIService",function(e,t,A){return e.note?(e.note.pages=t.sortBy(e.note.pages,"sequence"),e.note):A.get(e.id).then(function(e){return e.pages=t.sortBy(e.pages,"sequence"),e})}]}}).state("app.quick-notes.createNote",{url:"/create-note",params:{fullScreen:null,onboard:null},onEnter:["$window","$state","$stateParams","QuickNoteAPIService","QuickNoteTemplateInitializer",function(e,t,A,n,o){var a={name:e.moment().format("DD MMM YYYY h:mm a")};n.add(a).then(function(e){o.applyTemplate(e).then(function(){t.go("app.quick-notes.editNote",{id:e.id,note:e,fullScreen:A.fullScreen,onboard:A.onboard})})})}]}).state("app.quick-notes.editNote.assignToContact",{url:"/assign",data:{pageTitle:"Assign to Contact"},onEnter:["$state","$stateParams","$uibModal",function(t,e,A){(n=A.open({templateUrl:"quick-note/AssignToContact.html",controller:"AssignToContactController",controllerAs:"vm",backdrop:"static",resolve:{noteId:function(){return e.id}}})).result.then(function(e){t.go("app.contacts.view.notes",{id:e.contactId})},function(){"app.quick-notes.editNote.assignToContact"===t.current.name&&t.go("^",null,{reload:!0})})}],onExit:[function(){n&&n.dismiss()}]}).state("app.import-expressnote",{url:"/notes/import?token&shareflag",params:{token:null,shareflag:null},resolve:{test:["$state","$stateParams","QuickNoteAPIService","UserSettings","NotificationService",function(o,a,e,i,r){e.importNote(a.token,a.shareflag).then(function(e){r.add("ExpressNoteImported",{id:e.noteId});var t=i.getExpressItem("ImportNotes")||[];if(null!==t||0<t.length){for(var A=-1,n=0;n<t.length;n++)t[n].token===a.token&&(A=n);0<=A&&(t.splice(A,1),i.setExpressItem("ImportNotes",t))}return o.go("app.quick-notes.editNote",{id:e.noteId,fullScreen:a.fullScreen,onboard:a.onboard})})}]}})}])}(),function(){"use strict";angular.module("app.quick-notes").controller("EditQuickNoteController",e),e.$inject=["$rootScope","$window","$timeout","$scope","$state","$stateParams","$uibModal","$q","deviceDetector","alertService","QuickNoteAPIService","QuickNotePageAPIService","note","CanvasPrint","pageTypes","SafeLoadNotePage","AppContext"];var y=1;function e(e,t,A,n,o,a,i,r,s,c,l,u,d,p,g,m,h){var f,C,I=this;function E(){A(function(){I.loadingPage=!1},0)}function b(e){var t;I.noteEditor.loaded&&I.noteEditor.unsubscribeDrawEvent(),t=e,"[object String]"===Object.prototype.toString.call(t)&&(e=JSON.parse(e)),e.position=void 0,e.scale=void 0,(e.colors=void 0)!==I.note.pages[I.pageNumber-1].isDirty?I.isDirty=I.note.pages[I.pageNumber-1].isDirty:I.isDirty=!1,I.note.pages[I.pageNumber-1].noteData=e,I.note.pageOrientation===y?I.canvasSize={height:I.note.paperSize.heightPoints,width:I.note.paperSize.widthPoints}:I.canvasSize={height:I.note.paperSize.widthPoints,width:I.note.paperSize.heightPoints},I.noteEditor.loaded&&I.noteEditor.loadSnapshot(e)}function v(){I.note.pages[I.pageNumber-1].noteData?Q(I.note.pages[I.pageNumber-1].noteData):(I.loadingPage=!0,m.load(I.note.pages[I.pageNumber-1].noteDataUrl,Q,B,E))}function B(){I.pageNumber=I.previousPage,I.previousPage=I.pageNumber,c.addMessage("Unable to load page. Please ensure you are connected to the Internet or contact support for further assistance.","danger",!0)}function Q(e){b(e),I.previousPage=I.pageNumber}function w(){return I.noteEditor.serializeCanvasSnapshot()}I.note=d,I.pageNumber=1,I.previousPage=1,I.loadingPage=!1,I.isSaving=!1,I.isMobile=!1,I.isIOSMobileDevice=!1,I.isDirty=!1,I.preventEdit=!1,I.editorInitialized=function(){I.note.pages[I.pageNumber-1].noteData?b(I.note.pages[I.pageNumber-1].noteData):(I.loadingPage=!0,m.load(I.note.pages[I.pageNumber-1].noteDataUrl,b,B,E))},this.$onInit=function(){null===a.fullScreen||a.fullScreen?I.fullScreen=!0:I.fullScreen=!1,null!==a.onboard&&a.onboard?I.onboard=!0:I.onboard=!1,a.tour&&(I.tour=!0),I.noteEditor={loaded:!1},I.tools=[t.LC.tools.SelectShape,t.LC.tools.Pencil,t.LC.tools.Eraser,t.LC.tools.Text,t.LC.tools.Line,t.LC.tools.Pan],I.canvasSize={width:0,height:0},I.isMobile=s.isMobile()&&!s.isTablet(),I.isIOSMobileDevice=s.raw.device.ipad||s.raw.device.iphone,C=n.$on("onBeforeUnload",function(e,t){I.noteEditor.hasUnsavedChanges()&&(t.message="Any unsaved changes will be lost.",e.preventDefault())}),n.$on("onPageHide",function(e,t){var A;I.noteEditor.hasUnsavedChanges()&&(A=window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."),t.allow=A)}),f=e.$on("$stateChangeStart",function(e){if(I.noteEditor.hasUnsavedChanges()&&!window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."))return void e.preventDefault()}),n.$on("$destroy",function(){f(),C(),$(".hidden-print-image").remove(),I.noteEditor.unsubscribeDrawEvent&&I.noteEditor.unsubscribeDrawEvent()}),I.note.isOwner&&!I.note.isLocked&&!h.settings.subscription.isReadOnly||(I.preventEdit=!0),I.note.pages[I.pageNumber-1].noteData?b(I.note.pages[I.pageNumber-1].noteData):I.loadingPage=!0},n.$on("$destroy",function(){I.noteEditor.removeEventListeners()}),I.newPagesArray=g,I.selectedNewPageItem="",I.newPageSelected=function(e){I.addSelectedPage(e.id)},I.addSelectedPage=function(e){var A={id:I.note.id,quickNoteId:I.note.id,sequence:I.note.pageCount+1,pageType:e};return l.addPage(A).then(function(e){var t={id:e.pageId,sequence:A.sequence};I.loadingPage=!0,m.load(e.noteDataUrl,function(e){t.noteData=e,I.note.pages.push(t),I.note.pageCount++,I.pageNumber=I.note.pageCount,I.pageChanged()},B,E)})},this.deletePage=function(){i.open({templateUrl:"common/DeleteNotePage.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"}).result.then(function(e){!0===e&&l.deletePage({id:I.note.id,pageId:I.note.pages[I.pageNumber-1].id}).then(function(){I.note.pageCount--,I.note.pages.splice(I.pageNumber-1,1),I.pageNumber>I.note.pages.length&&(I.pageNumber=I.note.pages.length,I.previousPage=I.pageNumber),v()})})},this.pageChanged=function(){I.noteEditor.forceSave(),I.note.pages[I.previousPage-1].isDirty=I.noteEditor.hasUnsavedCurrentPageChanges(),I.note.pages[I.previousPage-1].noteData=w(),v()},this.print=function(){I.noteEditor.commit(),I.note.pages[I.previousPage-1].isDirty=I.noteEditor.hasUnsavedCurrentPageChanges(),I.note.pages[I.previousPage-1].noteData=w(),p.printPages(I.note)},this.makePublic=function(){l.makePublic(I.note.id).then(function(){I.note.isPrivate=!1,c.addMessage("Note is now shared with your organization.","success",!0)})},this.makePrivate=function(){l.makePrivate(I.note.id).then(function(){I.note.isPrivate=!0,c.addMessage("Note is no longer shared with your organization.","success",!0)})},this.deleteNote=function(){var e=i.open({templateUrl:"quick-note/DeleteQuickNote.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"});e.model=d,e.result.then(function(e){!0===e&&l.deleteNote(I.note.id).then(function(){c.addMessage("Note deleted successfully.","success",!0),o.go("^")})})},this.assignToContact=function(){I.noteEditor.forceSave(),o.go(".assignToContact",{id:I.note.id})},this.save=function(){var o;I.noteEditor.forceSave(),0!==I.note.name.length?(I.isSaving=!0,I.note.pages[I.pageNumber-1].isDirty=I.noteEditor.hasUnsavedCurrentPageChanges(),I.note.pages[I.pageNumber-1].noteData=w(),o=[],I.note.pages.forEach(function(e){var t,A,n;e.isDirty&&(t=new FormData,A=new Blob([JSON.stringify(e.noteData,null,0)],{type:"application/json"}),t.append("sequence",e.sequence),t.append("userSaved",!0),t.append("noteData",A),n=u.editNotePage(I.note.id,e.id,t),o.push(n))}),r.all(o).then(function(){var e={id:I.note.id,name:I.note.name,isLocked:I.note.isLocked};return l.save(e).then(function(e){I.isDirty=!1,I.note.pages.forEach(function(e){e.isDirty=!1}),I.noteEditor.subscribeToDrawEvent(),I.note.modifiedDate=e.modifiedDate,c.addMessage("Note saved successfully.","success",!0),I.isSaving=!1})}).catch(function(e){console.error("There was an error saving the note",e),c.addMessage("There was an error saving the note.\n\nPlease ensure that you are online and retry.","danger",!0),I.isSaving=!1})):c.addMessage("You must provide a name.","danger",!0)},this.lockNote=function(){I.preventEdit||window.confirm("This will save and permanently lock this note from further edits. Are you sure you want to proceed?")&&(I.noteEditor.commit(),I.noteEditor.updateNoteDataUrl(),I.note.isLocked=!0,I.preventEdit=!0,this.save())}}}(),function(){"use strict";function e(A){var n="/api/quicknotes";return{list:function(e){return A.get(n,{params:e}).then(function(e){return e.data})},add:function(e){return A.post(n,e).then(function(e){return e.data})},get:function(e){return A.get(n+"/"+e).then(function(e){return e.data})},addPage:function(e){return A.post(n+"/"+e.id+"/pages",e).then(function(e){return e.data})},deletePage:function(e){return A.delete(n+"/"+e.id+"/pages/"+e.pageId).then(function(e){return e.data})},deleteNote:function(e){return A.delete(n+"/"+e).then(function(e){return e.data})},makePublic:function(e){return A.put(n+"/"+e+"/make-public").then(function(e){return e.data})},makePrivate:function(e){return A.put(n+"/"+e+"/make-private").then(function(e){return e.data})},save:function(e){return A.put(n+"/"+e.id,e).then(function(e){return e.data})},assignToContact:function(e,t){return A.put(n+"/"+e+"/assign-contact/"+t).then(function(e){return e.data})},importNote:function(e,t){return A.get(n+"/import?token="+e+"&shareflag="+t).then(function(e){return e.data})}}}angular.module("app.quick-notes").service("QuickNoteAPIService",e),e.$inject=["$http"]}(),function(){"use strict";function e(o){return{editNotePage:function(e,t,A){var n="/api/quicknotes/"+e+"/pages/"+t;return o.put(n,A,{headers:{"Content-type":void 0},timeout:3e5})}}}angular.module("app.quick-notes").service("QuickNotePageAPIService",e),e.$inject=["$http"]}(),function(){"use strict";function e(t,n,e,o,A,a){var i=this;i.$onInit=function(){i.sortOrder=function(e){var t=e.split(" "),A={property:t[0],ascending:!0};"desc"===t[1]&&(A.ascending=!1);return A}("modifiedDate desc"),i.reloadData(1,50,i.sortOrder,""),r&&""!==r||(r="grid");i.pageLayout=r,s(),i.thumbnailsUnavailable=!e.thumbnailsAvailable,i.thumbnailsUnavailable&&(i.pageLayout="list")},i.openNote=function(e){t.go(".editNote",{id:e.id})},i.deleteNote=function(t){var e=A.open({templateUrl:"quick-note/DeleteQuickNote.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"});e.model=t,e.result.then(function(e){!0===e&&o.deleteNote(t.id).then(function(){i.reloadData(i.pagedItems.pageNumber,i.pagedItems.pageSize,i.sortOrder)})})},i.newNote=function(){t.go(".createNote")},i.assignToContact=function(e){t.go(".editNote.assignToContact",{id:e.id})},i.reloadData=function(e,t,A){i.isLoading=!0,o.list({pageNumber:e,pageSize:t,sortOrder:function(e){var t=e.ascending?"asc":"desc";return e.property+" "+t}(A),includeInactive:!0}).then(function(e){i.pagedItems=e,i.isLoading=!1}).catch(function(){i.isLoading=!1,n.addMessage("An error occured with searching. Please try again.","danger",!1)})},i.pageChanged=function(){return i.reloadData(i.pagedItems.pageNumber,i.pagedItems.pageSize,i.sortOrder)},i.orderBy=function(e,t){t?(i.sortOrder.property=e,i.sortOrder.ascending="asc"===t):i.sortOrder.property===e?i.sortOrder.ascending=!i.sortOrder.ascending:(i.sortOrder.property=e,i.sortOrder.ascending=!0);return i.reloadData(1,i.pagedItems.pageSize,i.sortOrder)},i.makePrivate=function(e){o.makePrivate(e.id).then(function(){e.isPrivate=!0})},i.makePublic=function(e){o.makePublic(e.id).then(function(){e.isPrivate=!1})},i.getHeaderClasses=function(e){var t="";i.sortOrder.property===e&&(t="sorting ",t+=i.sortOrder.ascending?"sorting_asc":"sorting_desc");return t},i.isOrderedBy=function(e,t){return i.sortOrder.property===e&&i.sortOrder.ascending===("asc"===t)},i.updatePageLayout=s;var r=a.getItem("layout:privateNotes");function s(){a.setItem("layout:privateNotes",i.pageLayout)}}angular.module("app.quick-notes").controller("QuickNotesListController",e),e.$inject=["$state","alertService","orgSettings","QuickNoteAPIService","$uibModal","UserSettings"]}(),function(){"use strict";function e(t,e,A){var n=this;n.$onInit=function(){n.selectedContact=null},n.close=function(){t.dismiss()},n.move=function(){return e.assignToContact(A,n.selectedContact.id).then(function(e){t.close(e)})}}angular.module("app.quick-notes").controller("AssignToContactController",e),e.$inject=["$uibModalInstance","QuickNoteAPIService","noteId"]}(),function(){"use strict";function e(n,s,c,A){return{applyTemplate:function(t){t.pages=A.sortBy(t.pages,"sequence");var e=t.pages.map(function(e){return A=e,i=t,r=n.defer(),$.getJSON(A.noteDataUrl,function(e){A.noteData=e;var o,a,t=document.createElement("div");s.LC.init(t,{onInit:(o=A,a=e,function(e){!function(e,t,A){var n=t.shapes;t.backgroundShapes=[],t.shapes=[];var o={height:t.imageSize.height,width:t.imageSize.width};e.setImageSize(o.width,o.height);for(var a=0;a<n.length;a++){var i,r=s.LC.JSONToShape(n[a]);"Text"===r.className&&(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=r.text).replace(/{Contact\.Name}/g,"")).replace(/{Contact\.PrimaryContact}/g,"")).replace(/{Contact\.FirstName}/g,"")).replace(/{Contact\.LastName}/g,"")).replace(/{Contact\.Email}/g,"")).replace(/{Contact\.AddressLine1}/g,"")).replace(/{Contact\.AddressLine2}/g,"")).replace(/{Contact\.Suburb}/g,"")).replace(/{Contact\.PostCode}/g,"")).replace(/{Contact\.State}/g,"")).replace(/{Contact\.Country}/g,"")).replace(/{Contact\.MobilePhone}/g,"")).replace(/{Contact\.WorkPhone}/g,"")).replace(/{Contact\.Fax}/g,"")).replace(/{Contact\.Comments}/g,"")).replace(/{Note\.CreatedDate}/g,moment(A.createdDate).format("DD MMM YYYY"))).replace(/{Note\.CreatedDateTime}/g,moment(A.createdDate).format("DD MMM YYYY h:mm a")),r.text=i.replace(/&#10;/g,"\n")),t.backgroundShapes.push(r)}e.backgroundShapes=t.backgroundShapes,e.repaintLayer("background")}(e,a,i);var t=JSON.stringify(e.getSnapshot(["imageSize","backgroundShapes","shapes"]));o.noteData=t,e._teardown();var A=new FormData,n=new Blob([JSON.stringify(o.noteData,null,0)],{type:"application/json"});A.append("sequence",o.sequence),A.append("noteData",n),A.append("userSaved",!1),c.editNotePage(i.id,o.id,A).then(function(e){r.resolve(e)}).catch(function(e){r.reject(e)})})})}),r.promise;var A,i,r});return n.all(e)}}}angular.module("app.quick-notes").service("QuickNoteTemplateInitializer",e),e.$inject=["$q","$window","QuickNotePageAPIService","lodash"]}(),function(){"use strict";function e(e){var A,n,o,a,i;e.state("app.settings",{url:"/settings",data:{pageTitle:"Settings",authorizeRoles:"Owners,Admins"},views:{"content@app":{templateUrl:"settings/Settings.html",controller:"SettingsController",controllerAs:"settingsCtrl"}},resolve:{orgSettings:["AppContext",function(e){return e.getSettings()}]}}).state("app.settings.noteTemplates",{url:"/note-templates",data:{pageTitle:"Note Templates",authorizeRoles:"Owners,Admins"},views:{"content@app":{templateUrl:"settings/note-templates/NoteTemplateList.html",controller:"NoteTemplateListController",controllerAs:"listCtrl"}},resolve:{noteTemplates:["NoteTemplatesApi",function(e){return e.query({pageNumber:1,pageSize:50,sortOrder:"name asc"}).$promise}]}}).state("app.settings.noteTemplates.importPdf",{url:"/upload-pdf",onEnter:["$state","$uibModal",function(e,t){(A=t.open({templateUrl:"settings/note-templates/ImportPdf.html",controller:"ImportPdfController",controllerAs:"editCtrl",size:"lg",backdrop:"static"})).result.then(function(){"app.settings.noteTemplates.importPdf"===e.current.name&&e.go("^",null,{reload:!0})},function(){"app.settings.noteTemplates.importPdf"===e.current.name&&e.go("^")})}],onExit:[function(){A&&A.dismiss()}]}).state("app.settings.noteTemplates.create",{url:"/create",data:{title:"Create Note Template",mode:"edit"},views:{"content@app":{templateUrl:"settings/note-templates/EditNoteTemplate.html",controller:"EditNoteTemplateController",controllerAs:"editCtrl"}},resolve:{template:["$window","$state","NoteTemplatesApi","newNoteSnapshotService","NoteTemplateSettings","lodash",function(e,o,a,i,t,r){var s={id:"",pageOrientation:1,name:"",paperSizeId:"23A93B49-4865-438B-BE74-38E503E258DA"};return a.add({},s).$promise.then(function(n){return t.getPaperSizes().then(function(e){var t=r.find(e,function(e){return e.id===s.paperSizeId.toLowerCase()}),A={noteTemplateId:n.id,sequence:1,noteData:JSON.stringify(i.createNewSnapshot(t.widthPoints,t.heightPoints))};return a.createPage({id:n.id},A).$promise.then(function(){o.go(".edit",{noteTemplateId:n.id.toLowerCase()})})})})}],paperSizes:["NoteTemplateSettings",function(e){return e.getPaperSizes()}]}}).state("app.settings.noteTemplates.edit",{url:"/{noteTemplateId:[0-9a-fA-F-]{36}}",data:{pageTitle:"Edit Note Template",mode:"edit"},views:{"content@app":{templateUrl:"settings/note-templates/EditNoteTemplate.html",controller:"EditNoteTemplateController",controllerAs:"editCtrl"}},resolve:{noteTemplate:["$stateParams","NoteTemplatesApi","lodash",function(e,t,A){return e.noteTemplate?(e.noteTemplate.pages=A.sortBy(e.noteTemplate.pages,"sequence"),e.noteTemplate):t.get({id:e.noteTemplateId}).$promise.then(function(e){return e.pages=A.sortBy(e.pages,"sequence"),e})}],paperSizes:["NoteTemplateSettings",function(e){return e.getPaperSizes()}]}}).state("app.settings.contactTypes",{url:"/contact-types",data:{pageTitle:"Manage Contact Types",authorizeRoles:"Owners,Admins"},views:{"content@app":{templateUrl:"settings/contact-types/ContactTypeList.html",controller:"ContactTypeListController",controllerAs:"listCtrl"}},resolve:{contactTypes:["ContactTypeApi",function(e){return e.getContactTypes(!0).then(function(e){return e.data})}]}}).state("app.settings.contactTypes.create",{url:"/create",onEnter:["$state","$uibModal",function(e,t){(n=t.open({templateUrl:"settings/contact-types/CreateEditContactType.html",controller:"CreateContactTypeController",controllerAs:"editCtrl",size:"lg",backdrop:"static"})).result.then(function(){"app.settings.contactTypes.create"===e.current.name&&e.go("^",null,{reload:!0})},function(){"app.settings.contactTypes.create"===e.current.name&&e.go("^")})}],onExit:[function(){n&&n.dismiss()}]}).state("app.settings.contactTypes.edit",{url:"/edit/{id}",onEnter:["$state","$stateParams","$uibModal","ContactTypeApi",function(e,t,A,n){(o=A.open({templateUrl:"settings/contact-types/CreateEditContactType.html",controller:"EditContactTypeController",controllerAs:"editCtrl",size:"lg",backdrop:"static",resolve:{contactType:function(){return n.getContactType({id:t.id}).then(function(e){return e.data})}}})).result.then(function(){"app.settings.contactTypes.edit"===e.current.name&&e.go("^",null,{reload:!0})},function(){"app.settings.contactTypes.edit"===e.current.name&&e.go("^")})}],onExit:[function(){o&&o.dismiss()}]}).state("app.settings.bulk-export",{url:"/bulk-export",data:{pageTitle:"Bulk Export",authorizeRoles:"Owners"},onEnter:["$state","$stateParams","$uibModal",function(e,t,A){function n(){"app.settings.bulk-export"===e.current.name&&e.go("^")}(a=A.open({templateUrl:"settings/export/BulkExport.html",controller:"BulkExportController",controllerAs:"vm",backdrop:"static",size:"md"})).result.then(n,n)}],onExit:[function(){a&&a.dismiss()}]}).state("app.settings.bulk-export-download",{url:"/bulk-export/download?:e&:s&:o",data:{pageTitle:"Bulk Export",authorizeRoles:"Owners"},onEnter:["$state","$stateParams","$uibModal",function(e,t,A){function n(){"app.settings.bulk-export-download"===e.current.name&&e.go("^")}(i=A.open({templateUrl:"settings/export/DownloadBulkExport.html",controller:"DownloadBulkExportController",controllerAs:"vm",backdrop:"static",size:"md",resolve:{params:function(){return t}}})).result.then(n,n)}],onExit:[function(){i&&i.dismiss()}]})}angular.module("app.settings",["ngResource","app.common","ngLodash"]).config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";function e(e,t){var A=this;this.orgSettings=e,A.isXeroOrganization=e.isXeroOrganization,A.orgName=e.name,A.manageNotudTeamsUrl=t.openidAuthority+"/teams",A.manageCurrentTeamUsersUrl=t.openidAuthority+"/teams/team-members/"+e.id,A.xeroCustomLinksSetupUrl=t.openidAuthority+"/teams/xero-setup/"+e.id}angular.module("app.settings").controller("SettingsController",e),e.$inject=["orgSettings","environmentConfig"]}(),function(){"use strict";angular.module("app.settings").factory("OrganizationApi",["$resource","CacheFactory",function(e,t){var A=t.createCache("settingsCache",{deleteOnExpire:"aggressive",maxAge:6e4,recycleFreq:5e3});return e("/api/organization",null,{save:{method:"PUT"},getTimeZones:{method:"GET",url:"/api/organization/timezones",cache:A},getLocales:{method:"GET",url:"/api/organization/locales",cache:A}})}])}(),function(){"use strict";function e(e,t,A,n,o,a,i,r,s){var c=this;this.$onInit=function(){var t;c.model=i,c.timeZones=o.items,c.locales=a.items,c.locale=(t=i.locale,c.locales.find(function(e){return e.code===t})),c.originalLocale=c.locale,c.showValidationMessage=!1,c.model.timeZone=function(e){for(var t=0;t<c.timeZones.length;t++){var A=c.timeZones[t];if(A.id===e)return A}return null}(i.timeZoneId),c.ipCountry=r},this.save=function(){if(!e.editForm.$invalid)return c.showValidationMessage=!1,c.model.timeZoneId=c.model.timeZone.id,c.model.locale=c.locale.code,n.save(c.model,function(){A.addMessage("Organization Details updated successfully.","success",!0),s.getSettings(),t.close()}).$promise;this.showValidationMessage=!0},this.close=function(){t.dismiss()}}angular.module("app.settings").controller("EditOrganizationController",e),e.$inject=["$scope","$uibModalInstance","alertService","OrganizationApi","timeZones","locales","organization","ipCountry","AppContext"]}(),function(){"use strict";function e(){return{rotateImages:function(e,t,n){return P.map(e,function(A){return new P(function(t){A.noteData?("string"==typeof A.noteData&&t(JSON.parse(A.noteData)),t(A.noteData)):$.getJSON(A.noteDataUrl,function(e){t(e)})}).then(function(e){return A.noteData=e,1===n?(A.noteData.imageSize.width=t.widthPoints,A.noteData.imageSize.height=t.heightPoints):(A.noteData.imageSize.width=t.heightPoints,A.noteData.imageSize.height=t.widthPoints),A.isDirty=!0,A})})}}}angular.module("app.settings").service("LCRotateService",e),e.$inject=[]}(),function(){"use strict";function e(t,e){var A=this;function n(e){var t=e.split(" "),A={property:t[0],ascending:!0};return"desc"===t[1]&&(A.ascending=!1),A}A.$onInit=function(){A.sortOrder=n("name asc"),A.items=e},A.getHeaderClasses=function(e){var t="";A.sortOrder.property===e&&(t="sorting ",t+=A.sortOrder.ascending?"sorting_asc":"sorting_desc");return t},A.getSortOrder=n,A.getSortOrderString=function(e){var t=e.ascending?"asc":"desc";return e.property+" "+t},A.newContactType=function(){t.go(".create")},A.editContactType=function(e){t.go(".edit",{id:e.id})},A.orderBy=function(e){A.sortOrder.property===e?A.sortOrder.ascending=!A.sortOrder.ascending:(A.sortOrder.property=e,A.sortOrder.ascending=!0)}}angular.module("app.settings").controller("ContactTypeListController",e),e.$inject=["$state","contactTypes"]}(),function(){"use strict";function e(e,t,A){var n=this;n.$onInit=function(){n.title="Create Contact Type",n.mode="create",n.model={name:"",isActive:!0,function:"create"}},n.save=function(){if(e.addForm.$invalid)return void(n.showValidationMessage=!0);return A.createContactType({name:n.model.name,isActive:n.model.isActive}).then(function(){t.close()}).catch(function(e){409===e.status?n.showDuplicateMessage=!0:n.showDuplicateMessage=!1})},n.close=function(){t.dismiss()}}angular.module("app.settings").controller("CreateContactTypeController",e),e.$inject=["$scope","$uibModalInstance","ContactTypeApi"]}(),function(){"use strict";function e(e,t,A,n){var o=this;o.$onInit=function(){o.title="Edit Contact Type",o.mode="edit",o.model=n},o.save=function(){if(t.addForm.$invalid)return void(o.showValidationMessage=!0);return A.editContactType({id:o.model.id,name:o.model.name,isActive:o.model.isActive}).then(function(){e.close()}).catch(function(e){409===e.status?o.showDuplicateMessage=!0:o.showDuplicateMessage=!1})},o.close=function(){e.dismiss()}}angular.module("app.settings").controller("EditContactTypeController",e),e.$inject=["$uibModalInstance","$scope","ContactTypeApi","contactType"]}(),function(){"use strict";function e(t){var A="/api/contact-types";return{getContactTypes:function(e){return t.get(A,{params:{includeInactive:e}})},getContactType:function(e){return t.get(A+"/"+e.id)},createContactType:function(e){return t.post(A,e)},editContactType:function(e){return t.put(A+"/"+e.id,e)}}}angular.module("app.settings").service("ContactTypeApi",e),e.$inject=["$http"]}(),function(){"use strict";function e(n){var o="/api/bulk-export";return{requestBulkExport:function(){return n.post(o+"/")},getDownloadUrl:function(e,t,A){return n.post(o+"/download",{exportId:e,password:t,passwordSequence:A})}}}angular.module("app.settings").factory("BulkExportApi",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t){var A=this;A.showError=!1,A.exportRequested=!1,A.exportPassword="",A.requestPending=!1,A.requestBulkExport=function(){return A.showError=!1,A.requestPending=!0,t.requestBulkExport().then(function(e){A.requestPending=!1,A.exportPassword=e.data,A.exportRequested=!0}).catch(function(e){A.requestPending=!1,A.showError=!0})},A.close=function(){e.dismiss()}}angular.module("app.settings").controller("BulkExportController",e),e.$inject=["$uibModalInstance","BulkExportApi"]}(),function(){"use strict";function e(t,e,A,n,o,a){var i=this;function r(){n.dismiss()}function s(){i.isLoading=!0,i.incorrectPassword=!1,i.showValidationMessage=!1,i.organizationMismatch=!1,i.showError=!1}i.$onInit=function(){s();var t=A.o;o.getSettings().then(function(e){i.isLoading=!1,e.id!==t&&(i.organizationMismatch=!0)})},i.download=function(){return s(),e.exportForm.$valid?a.getDownloadUrl(A.e,i.password,A.s).then(function(e){return t.location.href=e.data,r(),e}).catch(function(e){return 401===e.status?i.incorrectPassword=!0:i.showError=!0,e}):void(i.showValidationMessage=!0)},i.close=r}angular.module("app.settings").controller("DownloadBulkExportController",e),e.$inject=["$window","$scope","params","$uibModalInstance","AppContext","BulkExportApi"]}(),function(){"use strict";function e(t,i,e){var A,n,r=this;this.newNoteTemplate=function(){return t.go(".create")},this.editNoteTemplate=function(e){return t.go(".edit",{noteTemplateId:e.id})},this.importPdf=function(){return t.go(".importPdf")},this.sortOrder=(A="name asc".split(" "),n={property:A[0],ascending:!0},"desc"===A[1]&&(n.ascending=!1),n),this.reloadData=function(e,t,A){r.isLoading=!0;var n,o,a=i.query({pageNumber:e,pageSize:t,sortOrder:(o=(n=A).ascending?"asc":"desc",n.property+" "+o)},function(){r.pagedItems=a,r.isLoading=!1},function(){r.isLoading=!1})},this.pageChanged=function(){return r.reloadData(r.pagedItems.pageNumber,r.pagedItems.pageSize,r.sortOrder)},this.orderBy=function(e){return r.sortOrder.property===e?r.sortOrder.ascending=!r.sortOrder.ascending:(r.sortOrder.property=e,r.sortOrder.ascending=!0),r.reloadData(1,r.pagedItems.pageSize,r.sortOrder)},this.getHeaderClasses=function(e){var t="";return this.sortOrder.property===e&&(t="sorting ",t+=this.sortOrder.ascending?"sorting_asc":"sorting_desc"),t},r.pagedItems=e}angular.module("app.settings").controller("NoteTemplateListController",e),e.$inject=["$state","NoteTemplatesApi","noteTemplates"]}(),function(){"use strict";angular.module("app.settings").controller("EditNoteTemplateController",e),e.$inject=["$q","$rootScope","$window","$scope","$uibModal","lodash","alertService","NoteTemplatesApi","noteTemplate","paperSizes","newNoteSnapshotService","LCRotateService","SafeLoadNotePage"];var Q=1,w=2;function e(e,t,A,n,o,a,i,r,s,c,l,u,d){var p,g,m=this;function h(){m.loadingPage=!1}function f(e){var t;m.unsubscribeDrawEvent&&m.unsubscribeDrawEvent(),t=e,"[object String]"===Object.prototype.toString.call(t)&&(e=JSON.parse(e)),e.position=void 0,e.scale=void 0,e.colors=void 0,m.paperSize=v(a.find(m.paperSizes,function(e){return e.id===m.noteTemplate.paperSizeId})),void 0!==m.noteTemplate.pages[m.pageNumber-1].isDirty?m.isDirty=m.noteTemplate.pages[m.pageNumber-1].isDirty:m.isDirty=!1,m.noteTemplate.pages[m.pageNumber-1].noteData=e,m.noteEditor.loadSnapshot(e)}function C(){m.noteTemplate.pages[m.pageNumber-1].noteData?E(m.noteTemplate.pages[m.pageNumber-1].noteData):(m.loadingPage=!0,d.load(m.noteTemplate.pages[m.pageNumber-1].noteDataUrl,E,I,h))}function I(){m.pageNumber=m.previousPage,m.previousPage=m.pageNumber,i.addMessage("Unable to load page. Please ensure you are connected to the Internet or contact support for further assistance.","danger",!0)}function E(e){f(e),m.previousPage=m.pageNumber}function b(){return m.noteEditor.subscribeToDrawEvent&&m.noteEditor.subscribeToDrawEvent(),!0}function v(e){return e.width=e.widthPoints,e.height=e.heightPoints,e}function B(){return m.noteEditor.serializeCanvasSnapshot()}m.fullscreen=!1,m.noteTemplate=s,m.paperSizes=a.filter(c,function(e){return e.id}),m.paperSizes=m.paperSizes.map(v),m.paperSize=a.find(m.paperSizes,function(e){return"A4"===e.name}),m.pageNumber=1,m.previousPage=1,m.isDirty=!1,m.canvasReady=!1,m.snapshotLoaded=!1,m.isSaving=!1,m.editorInitialized=function(){m.isInitialized=!0,C()},m.$onInit=function(){m.noteEditor={loaded:!1};A.LC.tools.CustomTextWithFields.fieldOptions={Client:{Name:{key:"Contact.Name",displayName:"Name"},PrimaryContact:{key:"Contact.PrimaryContact",displayName:"Primary Contact"},FirstName:{key:"Contact.FirstName",displayName:"First Name"},LastName:{key:"Contact.LastName",displayName:"Last Name"},Email:{key:"Contact.Email",displayName:"Email"},AddressLine1:{key:"Contact.AddressLine1",displayName:"Address Line 1"},AddressLine2:{key:"Contact.AddressLine2",displayName:"Address Line 2"},Suburb:{key:"Contact.Suburb",displayName:"Suburb"},PostCode:{key:"Contact.PostCode",displayName:"Post Code"},State:{key:"Contact.State",displayName:"State"},Country:{key:"Contact.Country",displayName:"Country"},MobilePhone:{key:"Contact.MobilePhone",displayName:"Mobile Phone"},WorkPhone:{key:"Contact.WorkPhone",displayName:"Work Phone"},Fax:{key:"Contact.Fax",displayName:"Fax"},Comments:{key:"Contact.Comments",displayName:"Comments"}},Note:{CreatedDate:{key:"Note.CreatedDate",displayName:"Created Date"},CreatedDateTime:{key:"Note.CreatedDateTime",displayName:"Created Date & Time"}}},m.tools=[A.LC.tools.SelectShape,A.LC.tools.CustomTextWithFields,A.LC.tools.Line,A.LC.tools.Pan],n.$watch("editCtrl.snapshotLoaded",b),n.$watch("editCtrl.paperSize",function(e){m.isInitialized&&e&&(m.noteTemplate.paperSizeId=m.paperSize.id,m.noteTemplate.pageOrientation===Q?m.noteEditor.setImageSize(m.paperSize.width,m.paperSize.height):m.noteEditor.setImageSize(m.paperSize.height,m.paperSize.width))}),g=n.$on("onBeforeUnload",function(e,t){m.noteEditor.hasUnsavedChanges()&&(t.message="Any unsaved changes will be lost.",e.preventDefault())}),p=t.$on("$stateChangeStart",function(e){if(m.noteEditor.hasUnsavedChanges()&&!window.confirm("Are you sure you wish to leave this page? \n\nAny unsaved changes will be lost."))return void e.preventDefault()}),n.$on("$destroy",function(){p(),g(),m.noteEditor.unsubscribeDrawEvent&&m.noteEditor.unsubscribeDrawEvent()}),m.noteTemplate.pages[m.pageNumber-1].noteData?f(m.noteTemplate.pages[m.pageNumber-1].noteData):m.loadingPage=!0},this.addPage=function(e){m.isSaving=!0;var t=l.createNewSnapshot(m.paperSize.width,m.paperSize.height,e,!0),A={noteTemplateId:m.noteTemplate.id,sequence:m.noteTemplate.pageCount+1,noteData:JSON.stringify(t)};r.createPage({id:m.noteTemplate.id},A).$promise.then(function(e){m.noteData=t,e.noteData=t,m.noteTemplate.pages.push(e),m.noteTemplate.pageCount++,m.pageNumber=m.noteTemplate.pageCount,m.pageChanged(),m.isSaving=!1})},this.deletePage=function(e){o.open({templateUrl:"common/DeleteNotePage.html",controller:"ConfirmModalController",controllerAs:"vm",bindToController:!0,backdrop:"static"}).result.then(function(e){!0===e&&r.deletePage({id:m.noteTemplate.id,pageId:m.noteTemplate.pages[m.pageNumber-1].id}).$promise.then(function(){m.noteTemplate.pageCount--,m.noteTemplate.pages.splice(m.pageNumber-1,1),m.pageNumber>m.noteTemplate.pages.length&&(m.pageNumber=m.noteTemplate.pages.length,m.previousPage=m.pageNumber),C()})})},this.pageChanged=function(){m.noteEditor.forceSave(),m.noteTemplate.pages[m.previousPage-1].isDirty=m.noteEditor.hasUnsavedCurrentPageChanges(),m.noteTemplate.pages[m.previousPage-1].noteData=B(),C()},this.togglePageOrientation=function(){m.isDirty=!0,m.noteTemplate.pageOrientation===Q?(m.noteTemplate.pageOrientation=w,m.noteEditor.setImageSize(m.paperSize.height,m.paperSize.width)):(m.noteTemplate.pageOrientation=Q,m.noteEditor.setImageSize(m.paperSize.width,m.paperSize.height)),u.rotateImages(m.noteTemplate.pages,m.paperSize,m.noteTemplate.pageOrientation)},this.save=function(){var n;m.noteEditor.commit(),0!==m.noteTemplate.name.length?(m.isSaving=!0,m.noteTemplate.pages[m.pageNumber-1].isDirty=m.noteEditor.hasUnsavedCurrentPageChanges(),m.noteTemplate.pages[m.pageNumber-1].noteData=B(),n=[],m.noteTemplate.pages.forEach(function(e){var t,A;e.isDirty&&(t={id:e.id,noteTemplateId:m.noteTemplate.id,sequence:e.sequence,noteData:"string"==typeof e.noteData?e.noteData:JSON.stringify(e.noteData)},A=r.updatePage({pageId:e.id,id:m.noteTemplate.id},t).$promise,n.push(A))}),e.all(n).then(function(){var e={id:m.noteTemplate.id,name:m.noteTemplate.name,paperSizeId:m.paperSize.id,pageOrientation:m.noteTemplate.pageOrientation};return r.save({id:m.noteTemplate.id},e,function(e){m.noteTemplate.pages.map(function(e){e.isDirty=!1}),m.isDirty=!1,m.noteEditor.subscribeToDrawEvent(),m.noteTemplate.modifiedDate=e.modifiedDate,i.addMessage("Note template saved successfully.","success",!0),m.isSaving=!1}).$promise}).catch(function(e){console.error("There was an error saving the note template",e),i.addMessage("There was an error saving the note template.\n\nPlease ensure that you are online and retry.","danger",!0),m.isSaving=!1})):i.addMessage("You must provide a template name.","danger",!0)},this.activate=function(){r.activate({id:m.noteTemplate.id},function(){m.noteTemplate.isActive=!0})},this.deactivate=function(){r.deactivate({id:m.noteTemplate.id},function(){m.noteTemplate.isActive=!1})},this.startSelectImage=function(){m.noteEditor.commit(),$(".select-image").trigger("click")}}}(),function(){"use strict";angular.module("app.settings").factory("NoteTemplatesApi",["$resource",function(e){return e("/api/note-templates/:id",{id:"@id"},{getListWithDataUrls:{method:"GET",isArray:!1,url:"/api/note-templates/with-data-url"},query:{isArray:!1},add:{method:"POST"},save:{method:"PUT"},activate:{method:"PUT",url:"/api/note-templates/:id/activate"},deactivate:{method:"DELETE"},getPaperSizes:{method:"GET",url:"/api/note-templates/paper-sizes"},createPage:{method:"POST",url:"/api/note-templates/:id/page"},updatePage:{method:"PUT",url:"/api/note-templates/:id/page/:pageId"},deletePage:{method:"DELETE",url:"/api/note-templates/:id/page/:pageId"}})}])}(),function(){"use strict";function e(e,t,A,n){var o=this;o.showValidationMessage=!1,o.filename=null,o.progress=0,o.uploadingStarted=!1,o.uploadingSucceeded=!1,o.uploadingError=!1,o.mimeTypeSupported=!0,o.template={documentStyleSelected:""},o.documentStyleChanged=function(){o.template.documentStyleSelected=o.documentStyleSelected},o.validMimeTypes=["application/pdf"],o.isUploading=function(){return o.progress<100},o.isValidFile=function(e){return!e||(e.size<=0&&(o.zerobytefile=!0),0<e.size)},o.upload=function(){e.uploadTemplateFileForm.$invalid?o.showValidationMessage=!0:o.uploader.uploadAll()},o.close=function(){A.dismiss()},o.uploader=new n({url:"/api/note-templates/import",headers:{Authorization:t.getAuthorizationHeaderValue(),"x-organization-id":t.getOrganizationId()},alias:"uploadTemplateFile",withCredentials:!0}),t.userContextChanged(e,function(){o.uploader.headers.Authorization=t.getAuthorizationHeaderValue()}),o.uploader.filters.push({name:"fileFilter",fn:function(e){return t=e.type,-1!==o.validMimeTypes.indexOf(t);var t}}),o.uploader.onWhenAddingFileFailed=function(){o.filename=null,o.mimeTypeSupported=!1},o.uploader.onBeforeUploadItem=function(e){e.formData.push(o.template),o.uploadingStarted=!0,o.progress=0},o.uploader.onSuccessItem=function(){o.uploadingSucceeded=!0},o.uploader.onProgressAll=function(e){o.progress=e},o.uploader.onErrorItem=function(e,t){console.error(t),o.uploadingError=!0,o.uploadError=!0},o.uploader.onAfterAddingFile=function(e){o.template.file=e.file,o.filename=e.file.name,o.template.fileSizeBytes=e.file.size,o.mimeTypeSupported=!0;for(var t=o.uploader.queue.length-1;0<=t;t--){var A=o.uploader.queue[t];A!==e&&o.uploader.removeFromQueue(A)}},o.documentStyleSelected="Document",o.documentStyleChanged()}angular.module("app.settings").controller("ImportPdfController",e),e.$inject=["$scope","AuthService","$uibModalInstance","FileUploader"]}(),function(){"use strict";function e(e,t){var n=[];return{getPaperSizes:function(){var A=e.defer();return 0!==n.length?A.resolve(n):t.getPaperSizes({},function(e){for(var t in n.splice(0),e.paperSizes)n.push(e.paperSizes[t]);A.resolve(n)},function(e){A.reject(e)}),A.promise}}}angular.module("app.settings").factory("NoteTemplateSettings",e),e.$inject=["$q","NoteTemplatesApi"]}(),function(){"use strict";function e(t,A,n,o,a,e,i,r){var s=this;s.subscription=e.subscription,s.isFreemiumModel=e.subscription.isFreemiumModel,s.isExpired=i,s.indicateTrial=e.subscription.isTrial&&!e.subscription.hasBillingInfo,s.canSubscriptionBeManaged=e.subscription.isSelfService,s.changePlan=function(){s.subscription.hasBillingInfo?t.go("change-plan"):t.go("subscribe")},s.openBillingPortal=function(){r.openPortal()},s.openCheckout=function(){r.openCheckout({hostedPage:function(){return o.getSettings().then(function(e){return a.generateCheckOutUrl(e.subscription.planCode)})},success:function(e){a.updateSubscription(e).then(function(){o.getSettings(!1).then(function(){t.reload()})})}})},s.cancelSubscription=function(){var e=A.open({templateUrl:"settings/subscription/CancelSubscriptionModal.html",controller:"ConfirmModalController",controllerAs:"confirmCtrl",bindToController:!0,backdrop:"static"});e.model=s.subscription,e.result.then(function(e){!0===e&&a.cancelSubscription({},function(e){n.addMessage("Subscription cancelled.","success",!0)})})}}angular.module("app.settings").controller("SubscriptionDetailsController",e),e.$inject=["$state","$uibModal","alertService","AppContext","BillingApi","organization","isExpired","ChargebeeService"]}(),function(){"use strict";angular.module("app",["ui.router","ui.router.state.events","ngResource","ngAnimate","ngCookies","ngSanitize","ngTouch","angularLoad","tmh.dynamicLocale","angular-cache","ui.bootstrap","ui.select","ui.validate","angular-loading-bar","angularMoment","ngLodash","cfp.hotkeys","LocalStorageModule","ng.deviceDetector","angularFileUpload","countrySelect","react","puigcerber.countryPicker","dbaq.emoji","app.templates","flagship-ui","seedApp","app.common","app.contacts","app.settings","app.onboarding","app.quick-notes","express-app"]),Array.prototype.isEqual=function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0,A=this.length;t<A;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e})}(),function(){"use strict";function e(e,t,A){A.html5Mode(!0),t.otherwise("/teams"),e.state("root",{url:"/{shortCode}",abstract:!0}).state("app",{parent:"root",abstract:!0,views:{"@":{controller:"ShellController",controllerAs:"shellCtrl",templateUrl:"_shell/Shell.html"}},resolve:{appInitializationResult:["AppInitializer",function(e){return e.ensureInitialized(!1)}]}}).state("teams",{url:"/teams",onEnter:["$window",function(e){e.location.href=environmentConfig.openidAuthority+"/teams"}],data:{allowAnonymous:!0}}).state("404",{url:"/{shortCode}/not-found",templateUrl:"_shell/404.html",data:{pageTitle:"Not found",allowAnonymous:!0}}).state("403",{url:"/{shortCode}/unauthorized",controller:"403Controller",controllerAs:"ctrl",templateUrl:"_shell/403.html",data:{pageTitle:"Unauthorized",allowAnonymous:!0}})}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"];var t=["$provide","$httpProvider",function(e,t){e.factory("AuthorizationHttpInterceptor",["$q","AuthService",function(e,n){return{request:function(t){if(-1===t.url.indexOf("/api/")||0===t.url.indexOf("/api/expressnotes"))return t;var A=e.defer();return n.ensureSignedIn().then(function(){var e;n.isLoggedIn()?(t.headers.Authorization=n.getAuthorizationHeaderValue(),(e=n.getOrganizationId())&&(t.headers["x-organization-id"]=e),A.resolve(t)):A.reject({err:{message:"Not logged in"},config:t})},function(){A.reject({err:{message:"Not logged in"},config:t})}),A.promise}}}]),t.interceptors.push("AuthorizationHttpInterceptor")}],A=["$rootScope","uibDatepickerPopupConfig",function(e,o){e.$on("$localeChangeSuccess",function(e,t,A){var n;console.info("Locale set to "+t),o.datepickerPopup=(n=(n=(n=(n=(n="/"+(n=A.DATETIME_FORMATS.shortDate)+"/").replace("/d/","/dd/")).replace("/M/","/MM/")).replace("/y/","/yyyy/")).replace("/yy/","/yyyy/")).substring(1,n.length-1)})}];function n(e){e.decorator("nvFileOverDirective",["$delegate",function(e){var t=e[0],o=t.link;return t.compile=function(){return function(e,t,A){var n=A.overClass||"nv-file-over";o.apply(this,arguments),t.on("dragleave",function(){t.removeClass(n)})}},e}])}n.$inject=["$provide"],angular.module("app").constant("environmentConfig",environmentConfig).constant("iso3166",iso3166).config(e).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|mailto):/)}]).config(t).config(["$provide","$httpProvider",function(e,t){e.factory("UIReloadHttpInterceptor",["ApplicationUpdateService",function(A){return{response:function(e){if("/api"!==e.config.url.substring(0,4))return e;var t=e.headers("x-spa-version");return t&&A.checkForUpdates(t),e}}}]),t.interceptors.push("UIReloadHttpInterceptor")}]).config(["cfpLoadingBarProvider",function(e){e.includeSpinner=!1}]).config(["tmhDynamicLocaleProvider",function(e){e.localeLocationPattern("/node_modules/angular-i18n/angular-locale_{{locale}}.js")}]).config(["uiSelectConfig","uibDatepickerConfig","$uibModalProvider",function(e,t,A){e.theme="bootstrap",t.showWeeks=!1,A.options.animation=!1}]).config(n).run(["moment",function(e){e.defineLocale("en-us",{parentLocale:"en"}),e.updateLocale("en",{longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"}}),e.locale("en")}]).run(["$window","$rootScope","$location","appInsightsService",function(e,t,A,o){t.$on("$stateChangeStart",function(e,t){o.trackStateChanging(t)}),t.$on("$stateChangeSuccess",function(e,t,A,n){o.trackStateChanged(n,t,A)}),t.$on("$locationChangeSuccess",function(){e.Appcues&&e.Appcues.page(),e.dataLayer&&e.dataLayer.push({event:"routeChangeSuccess",attributes:{route:A.path()}})})}]).run(["routeProtector",function(e){e.setRoutingHandlers()}]).run(["$window","$rootScope","environmentConfig","AuthService","AppContext",function(A,e,n,t,o){t.userContextChanged(e,function(e,t){t.isDifferentUser&&o.getSettings(!1).then(function(e){e.subscription&&A.appInsights&&(A.appInsights.addTelemetryInitializer(function(e){var t=e.ext;t.app.ver=n.appVersion,t&&t.user.authId&&(t.user.id=t.user.authId)}),A.appInsights.setAuthenticatedUserContext(e.user.userAccountId,e.id,!0))})})}]).run(A).run(["RouteProtector",function(e){e.setRouteHandlers()}]).run(["ImageOrientationService",function(e){e.init()}]),jQuery.migrateTrace=!1}(),function(){"use strict";function e(o,a,i){return{importNotes:function(){var e=o.getExpressItem("ImportNotes")||[];if(null===e||0===e.length)return 0;var n=[];e.forEach(function(e,A){var t=a.importNote(e.token,e.shareFlag).then(function(e){var t=o.getExpressItem("ImportNotes")||[];return(null!==t||0<t.length)&&(t.splice(A,1),o.setExpressItem("ImportNotes",t)),i.add("ExpressNoteImported",{id:e.noteId}),e}).catch(console.error);n.push(t)})}}}angular.module("app").factory("SilentExpressNoteImportService",e),e.$inject=["UserSettings","QuickNoteAPIService","NotificationService"]}(),function(){"use strict";function e(t,e,A,n,o,a,i,r,s,c,l,u,d,p){var g=this;g.$onInit=function(){$(document).on("click",".navbar-collapse.in",function(e){$(e.target).parents(".navbar-search").length?e.stopPropagation():$(this).collapse("hide")}),$(document).on("click",function(){var e=$(".navbar-collapse.in");0<e.length&&e.collapse("hide")}),g.isTrial=!1,g.sampleDataVisible=!1,g.canManageSubscription=!1,g.myAccountUrl=r.openidAuthority+"/my-account",g.teamsUrl=r.openidAuthority+"/teams",g.userName="",g.name="",g.notificationService=p,g.isMobile=c.isMobile()&&!c.isTablet(),g.welcomeFlowId=r.appCues.welcomeFlowId,o(function(){u.importNotes()},1e4),e.$on("$stateChangeSuccess",function(){p.viewerIsOpen&&(p.viewerIsOpen=!1,p.markAsRead())})},g.notificationViewerOpen=function(){return p.viewerIsOpen},g.toggleNotificationViewer=function(){p.viewerIsOpen=!p.viewerIsOpen,p.viewerIsOpen||p.markAsRead()},g.showAppCuesContent=function(e){t.Appcues&&t.Appcues.show(e)},g.logout=function(){d.disable(),a.signout()},g.removeSampleData=function(){return l.removeSampleData().then(function(){return i.getSettings(!1).then(function(){A.reload(),g.sampleDataVisible=!1})})},g.teamFilter=function(e){return e.name!==g.name},e.$watch(function(){return i.settings},function(e){e.isInitialized&&(g.name=e.name,g.userName=e.user.firstName,g.daysRemaining=s().to(e.subscription.expiryDate,!0),g.isExpired=e.subscription.isExpired,g.sampleDataVisible=e.sampleDataVisible,g.showTrialAlert=e.subscription.isTrial&&!e.subscription.hasPaymentMethod||e.subscription.isExpired||e.subscription.isFreemiumModel,e.subscription.isvmService&&(g.canManageSubscription=i.isUserInRole("Owners")))})}angular.module("app").component("ncPageHeader",{templateUrl:"_shell/PageHeaderComponent.html",bindings:{teams:"<"},controller:e,controllerAs:"pageHeaderCtrl"}),e.$inject=["$window","$scope","$state","$stateParams","$timeout","AuthService","AppContext","environmentConfig","moment","deviceDetector","OnboardingTutorialApi","SilentExpressNoteImportService","ServerNotificationService","NotificationService"]}(),function(){"use strict";function e(e,t,o,a,i,r,s,A){var c=this;c.isLoaded=!1,c.teams=[],c.isMobile=!1,e.$watch(A.isLoaded,function(){c.isLoaded=!0}),function(){{var e,t,A,n;a.getUserTeams().then(function(e){c.teams=e}),c.isMobile=r.isMobile()&&!r.isTablet(),document.getElementById("appcues")||(e=a.getShortCode(),t=i.user,A=s.unix(t.createdAt),(n=document.createElement("script")).type="text/javascript",n.src="//fast.appcues.com/94535.js",n.id="appcues",n.onload=function(){o.Appcues&&o.Appcues.identify(t.userAccountId,{orgShortCode:e,userCreated:A.toISOString()})},document.body.appendChild(n))}}(),c.createNote=function(){t.go("app.contacts.createNote")},c.createQuickNote=function(){t.go("app.quick-notes.createNote",{tour:!1,fullScreen:!0})}}angular.module("app").controller("ShellController",e),e.$inject=["$scope","$state","$window","AuthService","AppContext","deviceDetector","moment","appInitializationResult"]}(),function(){"use strict";function e(n,o,t,a,A,i){var r,s,c={user:null,isAuthenticated:!1,isAuthenticating:!0,shortCode:null,organizationId:null,teams:[]},l=!1,u=!1,d=null,p=!0;function g(e,t){var A=!0;c&&c.user&&c.user.profile&&e&&e.profile&&(A=c.user.profile.sub!==e.profile.sub),t&&(c.organizationId=t),c.user=e,c.isAuthenticated=null!==e,c.isAuthenticating=!1,p=!1,m(A)}var m=function(e){o.$emit("ng-oidcclient-usercontext-changed-event",{isDifferentUser:e})};function h(){return c.user&&!c.user.expired}function f(e){if(l||!e&&h())return s;var t,A=n.defer();return s=A.promise,c.isAuthenticating=!0,l=!0,p?(t=A,p?r.signinSilent().then(function(e){t.resolve(e)}).catch(function(e){console.log("auth: Initial login required - ",e.message),t.reject(e),s=r.signinRedirect({data:i.location.href,extraQueryParams:{message:"Your session has expired, please login again to continue using Notud.",ref:document.referrer}})}):C(t)):C(A),s.then(function(e){return u=p=l=!1,null!==d&&(d.close(),d=null),r.clearStaleState(),e}).finally(function(){c.isAuthenticating=!1})}function C(A){r.signinSilent().then(function(e){console.log("auth: Success."),A.resolve(e)}).catch(function(e){if(!e.message||"Frame window timed out"!==e.message&&"Network Error"!==e.message)if(e.message&&"login_required"===e.message){if(console.log("auth: Login required"),u)return;u=!0;var t=a.get("$uibModal");d=t.open({templateUrl:"_shell/LoginModal.html",backdrop:"static",controller:"LoginModalController",bindToController:!0,controllerAs:"vm",resolve:{signinDeferred:A}})}else console.error("auth: ",e.message),A.reject(e),g(null),r.signinRedirect({data:i.location.href,extraQueryParams:{message:"Your session has expired, please login again to continue using Notud.",ref:document.referrer}});else console.log("auth: Potential loss of network connectivity. Retrying..."),i.setTimeout(function(){C(A)},5e3)})}return{init:function(){var e={client_id:"notud-app-spa",redirect_uri:window.location.origin+"/SigninCallback.html",response_type:"id_token token",scope:"openid profile notud-app subscription",authority:A.openidAuthority,filterProtocolClaims:!0,silent_redirect_uri:i.location.origin+"/SilentCallback.html",automaticSilentRenew:!0,revokeAccessTokenOnSignout:!0,accessTokenExpiringNotificationTime:60,post_logout_redirect_uri:i.location.origin};"dev"!==A.stage&&"QA"!==A.stage||(e.accessTokenExpiringNotificationTime=30),(r=new Oidc.UserManager(e)).events.addUserLoaded(function(e){console.log("auth: User loaded"),g(e)}),r.events.addUserUnloaded(function(){console.log("auth: User unloaded"),g(null)}),r.events.addAccessTokenExpiring(function(){console.log("auth: Access token expiring...")}),r.events.addAccessTokenExpired(function(){var e=a.get("$state");e.$current.data&&e.$current.data.public?console.log("auth: Access token expired. Ignoring for public route."):(console.log("auth: Access token expired."),f(!0))}),r.events.addSilentRenewError(function(){var e=a.get("$state");e.$current.data&&e.$current.data.public?console.log("auth: Silent renew error. Ignoring for public route."):(console.log("auth: Silent renew error."),f(!0))}),r.getUser().then(function(e){if(null!==e&&!e.expired){if(!e.profile.organizationId)return void t.path("/unauthorized");g(e)}})},isLoggedIn:h,getAuthorizationHeaderValue:function(){return c.user.token_type+" "+c.user.access_token},ensureSignedIn:f,signout:function(e){return g(null),r.signoutRedirect({extraQueryParams:{message:e}})},userContextChanged:function(e,t){var A=o.$on("ng-oidcclient-usercontext-changed-event",t);e.$on("$destroy",A)},getAccessToken:function(){return c.user.access_token},getShortCode:function(){return c.shortCode},getOrganizationId:function(){return c.organizationId},setOrganization:function(e,t){c.shortCode=e,c.organizationId=t,m()},retrySignin:C,getUserTeams:function(){return a.get("$http").get("/api/organization/by-team-member").then(function(e){return c.teams=e.data,c.teams})},forceTokenRefresh:function(){return r.removeUser().then(function(){r.revokeAccessToken().then(function(){return g(null),C()})})}}}angular.module("app").factory("AuthService",e),e.$inject=["$q","$rootScope","$location","$injector","environmentConfig","$window"]}(),function(){"use strict";function e(e,t){var A=t.createCache("OrganizationConfigApiCache",{deleteOnExpire:"aggressive",maxAge:6e4,recycleFreq:5e3});return{getConfig:function(){return e.get("/api/organization/settings",{cache:A})},ensureInitialized:function(){return e.get("/api/organization/ensure-initialized",{cache:A})},purgeCache:function(){A.removeAll()}}}angular.module("app").factory("OrganizationConfigApi",e),e.$inject=["$http","CacheFactory"]}(),function(){"use strict";function e(e,t,A,n,o,a,i,r,s,c){var l=document.createElement("a"),u=this,d=t.defer(),p={organizationId:"",error:null,isLoggedIn:!1,isOnboarded:!1,subscription:null,requiresContactSync:!1},g=!1;function m(){return A.get("/api/organization/short-code?shortCode="+encodeURI(u.shortCode)).then(function(e){return i.setOrganization(u.shortCode,e.data),p.organizationId=e.data,p.isLoggedIn=!0,r.ensureInitialized().catch(function(e){return 403===e.status?a.get("authRetries")?(a.remove("authRetries"),void(o.location.href=c.openidAuthority+"/teams?message="+encodeURI("Error: The account you are signed in with does not have access to the specified team. Please sign-out and sign-in with an account that has access."))):i.forceTokenRefresh().then(function(){a.set("authRetries","1"),o.location.reload()}):void d.reject(e)})})}return u.isLoaded=!1,u.stateChangeSuccessUnregister=e.$on("$stateChangeSuccess",function(){p.isLoaded=!0,u.stateChangeSuccessUnregister()}),{ensureInitialized:function(e){var t=function(){l.href=window.location.href;var e=l.pathname;return e.substring(1,e.indexOf("/",1))}();return u.shortCode&&t!==u.shortCode?(o.location.reload(),d.resolve()):g&&!e||(s.clearAll(),u.shortCode=t,i.init(),i.ensureSignedIn().then(m).catch(function(e){console.log(e)}).then(function(e){p.isOnboarded=e.data.isOnboarded,p.subscription=e.data.subscription,p.requiresContactSync=e.data.requiresContactSync,g=!0,d.resolve(p)}).catch(function(e){p.success=!1,p.error=e,p.isLoaded=!1,d.reject(p)})),d.promise},promise:d.promise,isLoaded:u.isLoaded,completeOnboarding:function(){p.isOnboarded=!0},completeContactSync:function(){p.requiresContactSync=!1},organizationShortCode:u.shortCode}}angular.module("app").factory("AppInitializer",e),e.$inject=["$rootScope","$q","$http","$state","$window","localStorageService","AuthService","OrganizationConfigApi","CacheFactory","environmentConfig","alertService"]}(),function(){"use strict";function e(e,A){var t=e.user.organizationId;function n(e){return t+":"+e}function o(e){return"ExpressNote:"+e}function a(e){return"Global:"+e}return{getItem:function(e){return A.get(n(e))},setItem:function(e,t){A.set(n(e),t)},getExpressItem:function(e){return A.get(o(e))},setExpressItem:function(e,t){A.set(o(e),t)},getGlobalItem:function(e){return A.get(a(e))},setGlobalItem:function(e,t){A.set(a(e),t)}}}angular.module("app").factory("UserSettings",e),e.$inject=["AppContext","localStorageService"]}(),function(){"use strict";var g=["ar-ma","ar-sa","ar-tn","de-at","en-us","en-au","en-ca","en-gb","fr-ca","hy-am","ms-my","pt-br","sr-cyrl","tl-ph","tzm-latn","zh-cn","zh-tw"];function e(A,e,t,n,o,a,i,r,s){var c=this;c.getSettings=p,c.setLocale=function(){p(!1).then(function(e){!function(e){var t;s.set(e.locale.toLowerCase()),t=-1!==g.indexOf(e.locale.toLowerCase())?e.locale.toLowerCase():e.locale.toLowerCase().slice(0,2);"en"!==t&&"en-us"!==t?r.loadScript(u+t+".js").finally(function(){i.locale(t),A.$broadcast("localeSettings:Updated")}):(i.locale(t),A.$broadcast("localeSettings:Updated"))}(e)})},c.purgeCache=function(){l=!0},c.isUserInRole=d,c.isUserInAnyRole=d,c.restartApp=function(){t.path("/"),e.location.href="/"},c.settings={isInitialized:!1};var l=!(c.user={}),u="/node_modules/moment/locale/";function d(e){if(!c.settings.isInitialized)return!1;var t=e.split(",");return 0<a.intersection(c.user.roles,t).length}function p(e){return void 0===e&&(e=!0),e&&!l||(o.purgeCache(),l=!1),n.promise.then(function(){return o.getConfig().then(function(e){var t=e.data;return t.isInitialized=!0,c.settings=t,c.user=e.data.user,t})})}return c}angular.module("app").factory("AppContext",e),e.$inject=["$rootScope","$window","$location","AppInitializer","OrganizationConfigApi","lodash","moment","angularLoad","tmhDynamicLocale"]}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"_shell/search/GlobalSearchDirective.html",controller:t,controllerAs:"globalSearchCtrl"}}function t(t,A){var n=this;n.openContact=function(e){n.contact=null,t.go("app.contacts.view",{id:e.id})},n.searchContacts=function(e){if(e)return A.get("/api/contacts?pageNumber=1&pageSize=25&search="+e).then(function(e){return e.data.items})}}angular.module("app").directive("pmGlobalSearch",e),e.$inject=[],t.$inject=["$state","$http"]}(),function(){"use strict";function e(e){this.logout=function(){e.signout()}}angular.module("app.common").controller("403Controller",e),e.$inject=["AuthService"]}(),function(){"use strict";function e(e,t,A){return{setRouteHandlers:function(){e.onBefore({},function(n){var o=n.router.stateService,a=n.to();return!!(a.data||{}).allowAnonymous||A.ensureInitialized(!1).then(function(e){if(!e.subscription)return o.target("403");if(!e.isOnboarded&&"welcome"!==a.name){var t=Object.assign({},n.params());return o.target("welcome",t)}if(e.requiresContactSync&&"syncContacts"!==a.name&&"welcome"!==a.name&&"logosetup"!==a.name){var A=Object.assign({},n.params());return A.redirectStateName=a.name,o.target("syncContacts",A)}}).catch(function(e){return console.dir(e),!1})})}}}angular.module("app").factory("RouteProtector",e),e.$inject=["$transitions","$rootScope","AppInitializer"]}(),function(){"use strict";function e(e,t,A){this.loginUrl=e.openidAuthority,this.retry=function(){return t.retrySignin(A)}}angular.module("app").controller("LoginModalController",e),e.$inject=["environmentConfig","AuthService","signinDeferred"]}();